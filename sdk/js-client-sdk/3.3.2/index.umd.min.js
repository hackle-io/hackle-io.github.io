!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Hackle={})}(this,function(e){"use strict";var t,n,i,o,s,a,l,u,c,p,h,d,f,v,m,w,r,y,g,E,T,b,_,R,N,A,O,I,k,x,M,S,C,P,L,D,U,F,V,H,G,B,K,q,z,j,X,Y,W=function(){return(W=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Z={exports:{}};function $(){}function Q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function J(e,t,r){this.id=e,this.key=t,this.isDropped=r}function ee(e,t,r){this.seed=e,this.slotSize=t,this.slots=r}function te(e,t){this.id=e,this.key=t}function re(e){this.conditions=e}function ne(e,t){this.key=e,this.match=t}function ie(e,t){this.type=e,this.name=t}function oe(e,t,r,n){this.type=e,this.operator=t,this.valueType=r,this.values=n}function se(e,t,r){this.type=e,this.variationId=t,this.bucketId=r}function ae(e,t){this.target=e,this.action=t}function ue(e,t,r,n){this.id=e,this.key=t,this.type=r,this.targets=n}function ce(e,t,r){this.startInclusive=e,this.endExclusive=t,this.variationId=r}function le(e,t,r,n,i,o,s,a,u,c,l){this.id=e,this.key=t,this.type=r,this.status=n,this.variations=i,this.userOverrides=o,this.segmentOverrides=s,this.targetAudiences=a,this.targetRules=u,this.defaultRule=c,this._winnerVariationId=l}function pe(){}function he(e,t){this.isOn=e,this.reason=t}function de(e,t){this.variation=e,this.reason=t}function fe(e,t,r){void 0===t&&(t=1e3),void 0===r&&(r=fe.DEFAULT_FLUSH_INTERVAL),this.flushInterval=fe.DEFAULT_FLUSH_INTERVAL,this.eventDispatcher=e,this.flushInterval=r,this.queue=new X(this.drainQueue.bind(this),lt,t,r)}function ve(e,t,r,n){void 0===r&&(r=1e3),void 0===n&&(n=1e4),this.buffer=[],this.sink=e,this.maxQueueSize=r,this.batchComparator=t,this.timer=new j({callback:this.flush.bind(this),timeout:n}),this.started=!1}function me(e){var t=e.timeout,e=e.callback;this.timeout=Math.max(t,0),this.callback=e}function we(e,t,r){this.evaluator=new A(new q),this.workspaceFetcher=e,this.eventProcessor=t,this.eventEmitter=r,this.workspaceFetcher.start(),this.eventProcessor.start(),this.readyPromise=this.workspaceFetcher.onReady().then(function(){return{success:!0}},function(){return{success:!1}})}function ye(){var e=new O(new I),t=new k(new M),r=new K(e,t);this.abTestFlow=S.of(new C(r),new U(new G(e)),new P,new L,new D,new F(t)),this.featureFlagFlow=S.of(new P,new L,new D,new C(r),new V(new B(e),t),new H(t))}function ge(e,t){this.targetMatcher=e,this.actionResolver=t}function Ee(e){this.targetMatcher=e}function Te(e){this.targetMatcher=e}function be(e){this.actionResolver=e}function _e(e,t){this.targetRuleDeterminer=e,this.actionResolver=t}function Re(e){this.actionResolver=e}function Ne(e){this.experimentTargetDeterminer=e}function Ae(){}function Oe(){}function Ie(){}function ke(e){this.overrideResolver=e}function xe(e,t){void 0===t&&(t=void 0),this.flowEvaluator=e=void 0===e?void 0:e,this.nextFlow=t}function Me(){}function Se(e){this.bucketer=e}function Ce(){}function Pe(e){this.userConditionMatcher=e}function Le(e){this.segmentMatcher=e}function De(){}function Ue(e,t){this.userValueResolver=e,this.valueOperatorMatcher=t}function Fe(){}function Ve(){}function He(){}function Ge(){}function Be(){}function Ke(){}function qe(){}function ze(){}function je(){}function Xe(){}function Ye(){}function We(){}function Ze(){}function $e(){}function Qe(e,t){this.valueMatcherFactory=e,this.operatorMatcherFactory=t}function Je(e){this.conditionMatcherFactory=e}function et(e){this.evaluationFlowFactory=e}function tt(e,t,r){this.variationId=e,this.variationKey=t,this.reason=r}function rt(e,t,r,n,i){i=c.call(this,e,t,i)||this;return i.eventType=r,i.event=n,i}function nt(e,t,r,n,i,o,s){s=p.call(this,e,t,s)||this;return s.experiment=r,s.variationId=n,s.variationKey=i,s.decisionReason=o,s}function it(e,t,r){this.timestamp=e,this.user=t,this.hackleProperties=r}function ot(){}function st(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.supportedKeyTypes=e}function at(e){this.identifiers=e}function ut(e,t,r){this.major=e,this.minor=t,this.patch=r}function ct(e,t,r){this.coreVersion=e,this.prerelease=t,this.build=r}function lt(e,t){return e.timestamp==t.timestamp&&e.user.id==t.user.id&&e.user.properties==t.user.properties}function pt(e,t,r,n,i){this.experiments=e,this.featureFlags=t,this.buckets=r,this.eventTypes=n,this.segments=i}nr=Z.exports,ur=nr,t={DISABLE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},$.setLogLevel=function(e){this.logLevel=e=void 0===e?t.INFO:e},$._log=function(e,t){var r;switch(e){case"WARN":r="orange";break;case"ERROR":r="red";break;default:r="#AAAAAA"}try{console.log("%c[".concat(e,"] Hackle: ").concat(t),"color: ".concat(r))}catch(e){}},$.logLevel=t.INFO,$.log={error:function(e){t.ERROR<=$.logLevel&&$._log("ERROR",e)},warn:function(e){t.WARN<=$.logLevel&&$._log("WARN",e)},info:function(e){t.INFO<=$.logLevel&&$._log("INFO",e)},debug:function(e){t.DEBUG<=$.logLevel&&$._log("DEBUG",e)}},sr=$,n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},de.of=function(e,t){return new de(e,t)},o=de,he.on=function(e){return new he(!0,e)},he.off=function(e){return new he(!1,e)},s=he,pe.SDK_NOT_READY="SDK_NOT_READY",pe.EXCEPTION="EXCEPTION",pe.INVALID_INPUT="INVALID_INPUT",pe.EXPERIMENT_NOT_FOUND="EXPERIMENT_NOT_FOUND",pe.EXPERIMENT_DRAFT="EXPERIMENT_DRAFT",pe.EXPERIMENT_PAUSED="EXPERIMENT_PAUSED",pe.EXPERIMENT_COMPLETED="EXPERIMENT_COMPLETED",pe.OVERRIDDEN="OVERRIDDEN",pe.TRAFFIC_NOT_ALLOCATED="TRAFFIC_NOT_ALLOCATED",pe.VARIATION_DROPPED="VARIATION_DROPPED",pe.TRAFFIC_ALLOCATED="TRAFFIC_ALLOCATED",pe.NOT_IN_EXPERIMENT_TARGET="NOT_IN_EXPERIMENT_TARGET",pe.FEATURE_FLAG_NOT_FOUND="FEATURE_FLAG_NOT_FOUND",pe.FEATURE_FLAG_INACTIVE="FEATURE_FLAG_INACTIVE",pe.INDIVIDUAL_TARGET_MATCH="INDIVIDUAL_TARGET_MATCH",pe.TARGET_RULE_MATCH="TARGET_RULE_MATCH",pe.DEFAULT_RULE="DEFAULT_RULE",a=pe,le.prototype._winnerVariationOrNull=function(){if(this._winnerVariationId)return this._getVariationByIdOrNull(this._winnerVariationId)},le.prototype._getVariationByIdOrNull=function(t){return this.variations.find(function(e){return e.id===t})},le.prototype._getVariationByKeyOrNull=function(t){return this.variations.find(function(e){return e.key===t})},l=le,ce.prototype.contains=function(e){return this.startInclusive<=e&&e<this.endExclusive},u=ce,ct.tryParse=function(e){var s=ct.regExp.exec(e);if(s){var t=function(e){var t="function"==typeof Symbol&&s[Symbol.iterator];if(!t)return s;var r,n,i=t.call(s),o=[];try{for(;(void 0===e||0<e--)&&!(r=i.next()).done;)o.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return o}(6);t[0];var r=t[1],n=t[2],i=void 0===n?"0":n,e=t[3],n=void 0===e?"0":e,e=t[4],t=t[5];return new ct(new d(parseInt(r,10),parseInt(i,10),parseInt(n,10)),f.parse(e),f.parse(t))}},ct.prototype.compareTo=function(e){return this.coreVersion.compareTo(e.coreVersion)||this.prerelease.compareTo(e.prerelease)},ct.prototype.isEqualTo=function(e){return 0===this.compareTo(e)},ct.prototype.isGreaterThan=function(e){return 0<this.compareTo(e)},ct.prototype.isGreaterThanOrEqualTo=function(e){return 0<=this.compareTo(e)},ct.prototype.isLessThan=function(e){return this.compareTo(e)<0},ct.prototype.isLessThanOrEqualTo=function(e){return this.compareTo(e)<=0},ct.regExp=/^(0|[1-9]\d*)(?:\.(0|[1-9]\d*))?(?:\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,h=ct,ut.prototype.compareTo=function(e){return this.major-e.major||this.minor-e.minor||this.patch-e.patch},d=ut,at.parse=function(e){return e?new at(e.split(".")):at.EMPTY},at.prototype.isEmpty=function(){return 0===this.identifiers.length},at.prototype.isNotEmpty=function(){return!this.isEmpty()},at.prototype.compareTo=function(e){return this.isEmpty()&&e.isEmpty()?0:this.isEmpty()&&e.isNotEmpty()?1:this.isNotEmpty()&&e.isEmpty()?-1:this.compareIdentifiers(e)},at.prototype.compareIdentifiers=function(e){for(var t=Math.min(this.identifiers.length,e.identifiers.length),r=0;r<t;r++){var n=at.compareIdentifiers(this.identifiers[r],e.identifiers[r]);if(0!==n)return n}return this.identifiers.length-e.identifiers.length},at.compareIdentifiers=function(e,t){return at.numericIdentifierRegExp.test(e)&&at.numericIdentifierRegExp.test(t)?+e-+t:e===t?0:e<t?-1:1},at.EMPTY=new at([]),at.numericIdentifierRegExp=/^(0|[1-9]\d*)$/,f=at,v=["MATCH","NOT_MATCH"],m=["STRING","NUMBER","BOOLEAN","VERSION"],w=["IN","CONTAINS","STARTS_WITH","ENDS_WITH","GT","GTE","LT","LTE"],r=["VARIATION","BUCKET"],y=["USER_ID","USER_PROPERTY","HACKLE_PROPERTY","SEGMENT"],g=["USER_ID","USER_PROPERTY"],st.prototype.supports=function(e){return this.supportedKeyTypes.includes(e)},st.IDENTIFIER=new st("SEGMENT"),st.PROPERTY=new st("SEGMENT","USER_PROPERTY","HACKLE_PROPERTY"),st.SEGMENT=new st("USER_ID","USER_PROPERTY","HACKLE_PROPERTY"),E=st,ot.validate=function(e){if(e){if("object"!=typeof e)return!1;for(var t in e)if(!this.validProperty(t,e[t]))return!1}return!0},ot.filteredProperties=function(r){var n=this;return Object.keys(r).filter(function(e){return n.validProperty(e,r[e])}).reduce(function(e,t){return i(i({},e),((e={})[t]=n.filteredPropertiesValue(r[t]),e))},{})},ot.filteredPropertiesValue=function(e){return"string"==typeof e&&1024<e.length?e.slice(0,1024):e},ot.validProperty=function(e,t){return!!e&&"string"==typeof e&&!(128<e.length)&&("string"==typeof t||"boolean"==typeof t||"number"==typeof t&&!isNaN(t)&&isFinite(t))},T=ot,it.exposure=function(e,t,r,n){return void 0===n&&(n={}),new _((new Date).getTime(),t,e,r.variationId,r.variationKey,r.reason,n)},it.track=function(e,t,r,n){return void 0===n&&(n={}),new R((new Date).getTime(),r,e,t,n)},it.isExposure=function(e){return void 0!==e.experiment},it.isTrack=function(e){return void 0!==e.eventType},Q(nt,p=b=it),nt.prototype.toDto=function(){return{timestamp:this.timestamp,userId:this.user.id,userProperties:T.filteredProperties(this.user.properties||{}),experimentId:this.experiment.id,experimentKey:this.experiment.key,experimentType:this.experiment.type,variationId:this.variationId,variationKey:this.variationKey,decisionReason:this.decisionReason.toString(),hackleProperties:T.filteredProperties(this.hackleProperties||{})}},_=nt,Q(rt,c=b),rt.prototype.toDto=function(){return{timestamp:this.timestamp,userId:this.user.id,userProperties:T.filteredProperties(this.user.properties||{}),eventTypeId:this.eventType.id,eventTypeKey:this.eventType.key,value:this.event.value||0,properties:T.filteredProperties(this.event.properties||{}),hackleProperties:T.filteredProperties(this.hackleProperties||{})}},R=rt,tt.withVariation=function(e,t){return new tt(e.id,e.key,t)},tt.withKey=function(e,t){return new tt(void 0,e,t)},tt.of=function(e,t,r){e=e._getVariationByKeyOrNull(t);return e?tt.withVariation(e,r):tt.withKey(t,r)},N=tt,et.prototype.evaluate=function(e,t,r,n,i){return this.evaluationFlowFactory.getFlow(t.type).evaluate(e,t,r,n,i)},A=et,Je.prototype.matches=function(e,t,r,n){var i=this;return e.conditions.every(function(e){return i._matches(e,t,r,n)})},Je.prototype._matches=function(e,t,r,n){return this.conditionMatcherFactory.getMatcher(e.key.type).matches(e,t,r,n)},O=Je,Qe.prototype.matches=function(t,e){var r=this.valueMatcherFactory.getMatcher(e.valueType),n=this.operatorMatcherFactory.getMatcher(e.operator),i=e.values.some(function(e){return r.matches(n,t,e)});return this._matches(e.type,i)},Qe.prototype._matches=function(e,t){switch(e){case"MATCH":return t;case"NOT_MATCH":return!t}},rr=Qe,$e.prototype.booleanMatches=function(e,t){return e===t},$e.prototype.numberMatches=function(e,t){return e===t},$e.prototype.stringMatches=function(e,t){return e===t},$e.prototype.versionMatches=function(e,t){return e.isEqualTo(t)},Rt=$e,Ze.prototype.booleanMatches=function(e,t){return!1},Ze.prototype.numberMatches=function(e,t){return!1},Ze.prototype.stringMatches=function(e,t){return e.includes(t)},Ze.prototype.versionMatches=function(e,t){return!1},Jt=Ze,We.prototype.booleanMatches=function(e,t){return!1},We.prototype.numberMatches=function(e,t){return!1},We.prototype.stringMatches=function(e,t){return e.startsWith(t)},We.prototype.versionMatches=function(e,t){return!1},or=We,Ye.prototype.booleanMatches=function(e,t){return!1},Ye.prototype.numberMatches=function(e,t){return!1},Ye.prototype.stringMatches=function(e,t){return e.endsWith(t)},Ye.prototype.versionMatches=function(e,t){return!1},er=Ye,Xe.prototype.booleanMatches=function(e,t){return!1},Xe.prototype.numberMatches=function(e,t){return t<e},Xe.prototype.stringMatches=function(e,t){return!1},Xe.prototype.versionMatches=function(e,t){return e.isGreaterThan(t)},tr=Xe,je.prototype.booleanMatches=function(e,t){return!1},je.prototype.numberMatches=function(e,t){return t<=e},je.prototype.stringMatches=function(e,t){return!1},je.prototype.versionMatches=function(e,t){return e.isGreaterThanOrEqualTo(t)},ir=je,ze.prototype.booleanMatches=function(e,t){return!1},ze.prototype.numberMatches=function(e,t){return e<t},ze.prototype.stringMatches=function(e,t){return!1},ze.prototype.versionMatches=function(e,t){return e.isLessThan(t)},ar=ze,qe.prototype.booleanMatches=function(e,t){return!1},qe.prototype.numberMatches=function(e,t){return e<=t},qe.prototype.stringMatches=function(e,t){return!1},qe.prototype.versionMatches=function(e,t){return e.isLessThanOrEqualTo(t)},nr=qe,Ke.prototype.getMatcher=function(e){switch(e){case"IN":return Ke.IN_MATCHER;case"CONTAINS":return Ke.CONTAINS_MATCHER;case"STARTS_WITH":return Ke.STARTS_WITH_MATCHER;case"ENDS_WITH":return Ke.ENDS_WITH_MATCHER;case"GT":return Ke.GT_MATCHER;case"GTE":return Ke.GTE_MATCHER;case"LT":return Ke.LT_MATCHER;case"LTE":return Ke.LTE_MATCHER}},Ke.IN_MATCHER=new Rt,Ke.CONTAINS_MATCHER=new Jt,Ke.STARTS_WITH_MATCHER=new or,Ke.ENDS_WITH_MATCHER=new er,Ke.GT_MATCHER=new tr,Ke.GTE_MATCHER=new ir,Ke.LT_MATCHER=new ar,Ke.LTE_MATCHER=new nr,or=Ke,Be.prototype.matches=function(e,t,r){return"string"==typeof t&&"string"==typeof r&&e.stringMatches(t,r)},er=Be,Ge.prototype.matches=function(e,t,r){return"number"==typeof t&&"number"==typeof r&&e.numberMatches(t,r)},tr=Ge,He.prototype.matches=function(e,t,r){return"boolean"==typeof t&&"boolean"==typeof r&&e.booleanMatches(t,r)},ir=He,Ve.prototype.matches=function(e,t,r){t=h.tryParse(t),r=h.tryParse(r);return!(!t||!r)&&e.versionMatches(t,r)},ar=Ve,Fe.prototype.getMatcher=function(e){switch(e){case"STRING":return Fe.STRING_MATCHER;case"NUMBER":return Fe.NUMBER_MATCHER;case"BOOLEAN":return Fe.BOOLEAN_MATCHER;case"VERSION":return Fe.VERSION_MATCHER}},Fe.STRING_MATCHER=new er,Fe.NUMBER_MATCHER=new tr,Fe.BOOLEAN_MATCHER=new ir,Fe.VERSION_MATCHER=new ar,nr=Fe,Ue.prototype.matches=function(e,t,r,n){n=this.userValueResolver.resolveOrNull(r,n,e.key);return!!n&&this.valueOperatorMatcher.matches(n,e.match)},er=Ue,De.prototype.resolveOrNull=function(e,t,r){switch(r.type){case"USER_ID":return e.id;case"USER_PROPERTY":return e.properties&&e.properties[r.name];case"HACKLE_PROPERTY":return t[r.name];case"SEGMENT":throw new Error("Unsupported TargetKeyType [".concat(r.type,"]"))}},tr=De,Le.prototype.matches=function(e,t,r,n){var i=this;if("SEGMENT"!=e.key.type)throw new Error("Unsupported TargetKeyType [".concat(e.key.type,"]"));var o=e.match.values.some(function(e){return i._matches(e,t,r,n)});switch(e.match.type){case"MATCH":return o;case"NOT_MATCH":return!o}},Le.prototype._matches=function(e,t,r,n){if("string"!=typeof e)throw new Error("SegmentKey[".concat(e,"]"));var i=t.getSegmentOrNull(e);if(!i)throw new Error("Segment[".concat(e,"]"));return this.segmentMatcher.matches(i,t,r,n)},ir=Le,Pe.prototype.matches=function(e,t,r,n){var i=this;return e.targets.some(function(e){return i._matches(e,t,r,n)})},Pe.prototype._matches=function(e,t,r,n){var i=this;return e.conditions.every(function(e){return i.userConditionMatcher.matches(e,t,r,n)})},ar=Pe,Ce.prototype.getMatcher=function(e){switch(e){case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":return Ce.USER_CONDITION_MATCHER;case"SEGMENT":return Ce.SEGMENT_CONDITION_MATCHER}},Ce.USER_CONDITION_MATCHER=new er(new tr,new rr(new nr,new or)),Ce.SEGMENT_CONDITION_MATCHER=new ir(new ar(Ce.USER_CONDITION_MATCHER)),I=Ce,Se.prototype.resolveOrNull=function(e,t,r,n){switch(e.type){case"VARIATION":return this._resolveVariation(e,r);case"BUCKET":return this._resolveBucket(e,t,r,n)}},Se.prototype._resolveVariation=function(e,t){return t._getVariationByIdOrNull(e.variationId)},Se.prototype._resolveBucket=function(e,t,r,n){e=t.getBucketOrNull(e.bucketId),n=this.bucketer.bucketing(e,n);if(n)return r._getVariationByIdOrNull(n.variationId)},k=Se,x={murmurhash3_x86_32:function(e,t,r,n){for(var i,o=3432918353,s=461845907,a=-4&(n=void 0===n?e.length:n),u=t,c=0;c<a;c+=4)i=255&e.charCodeAt(c)|(255&e.charCodeAt(c+1))<<8|(255&e.charCodeAt(c+2))<<16|(255&e.charCodeAt(c+3))<<24,i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,u=5*((524287&(u^=i=this.mul32(i,s)))<<13|u>>>19)+3864292196|0;switch(i=0,n%4){case 3:i=(255&e.charCodeAt(2+a))<<16;case 2:i|=(255&e.charCodeAt(1+a))<<8;case 1:i|=255&e.charCodeAt(a),i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,u^=i=this.mul32(i,s)}return u^=n,u=this.mul32(u^=u>>>16,2246822507),(u=this.mul32(u^=u>>>13,3266489909))^u>>>16},mul32:function(e,t){var r=65535&t;return((t-r)*e|0)+(r*e|0)|0}},Me.prototype.bucketing=function(e,t){var r=this.calculateSlotNumber(e.seed,e.slotSize,t.id);return e.slots.find(function(e){return e.contains(r)})},Me.prototype.calculateSlotNumber=function(e,t,r){e=x.murmurhash3_x86_32(r,e);return Math.abs(e)%Math.abs(t)},M=Me,xe.prototype.evaluate=function(e,t,r,n,i){return this.flowEvaluator&&this.nextFlow?this.flowEvaluator.evaluate(e,t,r,n,i,this.nextFlow):N.of(t,i,a.TRAFFIC_NOT_ALLOCATED)},xe.of=function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=new xe;try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(r.reverse()),s=o.next();!s.done;s=o.next())i=new xe(s.value,i)}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return i},S=xe,ke.prototype.evaluate=function(e,t,r,n,i,o){var s=this.overrideResolver.resolveOrNull(e,t,r,n);if(!s)return o.evaluate(e,t,r,n,i);switch(t.type){case"AB_TEST":return N.withVariation(s,a.OVERRIDDEN);case"FEATURE_FLAG":return N.withVariation(s,a.INDIVIDUAL_TARGET_MATCH)}},C=ke,Ie.prototype.evaluate=function(e,t,r,n,i,o){return"DRAFT"===t.status?N.of(t,i,a.EXPERIMENT_DRAFT):o.evaluate(e,t,r,n,i)},P=Ie,Oe.prototype.evaluate=function(e,t,r,n,i,o){if("PAUSED"!==t.status)return o.evaluate(e,t,r,n,i);switch(t.type){case"AB_TEST":return N.of(t,i,a.EXPERIMENT_PAUSED);case"FEATURE_FLAG":return N.of(t,i,a.FEATURE_FLAG_INACTIVE)}},L=Oe,Ae.prototype.evaluate=function(e,t,r,n,i,o){if("COMPLETED"!==t.status)return o.evaluate(e,t,r,n,i);i=t._winnerVariationOrNull();if(!i)throw new Error("winner variation [".concat(t.id,"]"));return N.withVariation(i,a.EXPERIMENT_COMPLETED)},D=Ae,Ne.prototype.evaluate=function(e,t,r,n,i,o){if("AB_TEST"!==t.type)throw new Error("experiment type bust be AB_TEST [".concat(t.id,"]"));return this.experimentTargetDeterminer.isUserInExperimentTarget(e,t,r,n)?o.evaluate(e,t,r,n,i):N.of(t,i,a.NOT_IN_EXPERIMENT_TARGET)},U=Ne,Re.prototype.evaluate=function(e,t,r,n,i,o){if("RUNNING"!==t.status)throw new Error("experiment status must be RUNNING [".concat(t.id,"]"));if("AB_TEST"!==t.type)throw new Error("experiment type bust be AB_TEST [".concat(t.id,"]"));r=this.actionResolver.resolveOrNull(t.defaultRule,e,t,r);return r?r.isDropped?N.of(t,i,a.VARIATION_DROPPED):N.withVariation(r,a.TRAFFIC_ALLOCATED):N.of(t,i,a.TRAFFIC_NOT_ALLOCATED)},F=Re,_e.prototype.evaluate=function(e,t,r,n,i,o){if("RUNNING"!==t.status)throw new Error("experiment status must be RUNNING [".concat(t.id,"]"));if("FEATURE_FLAG"!==t.type)throw new Error("experiment type bust be FEATURE_FLAG [".concat(t.id,"]"));var s=this.targetRuleDeterminer.determineTargetRuleOrNull(e,t,r,n);if(!s)return o.evaluate(e,t,r,n,i);r=this.actionResolver.resolveOrNull(s.action,e,t,r);if(!r)throw new Error("FeatureFlag must decide the Variation [".concat(t.id,"]"));return N.withVariation(r,a.TARGET_RULE_MATCH)},V=_e,be.prototype.evaluate=function(e,t,r,n,i,o){if("RUNNING"!==t.status)throw new Error("experiment status must be RUNNING [".concat(t.id,"]"));if("FEATURE_FLAG"!==t.type)throw new Error("experiment type bust be FEATURE_FLAG [".concat(t.id,"]"));r=this.actionResolver.resolveOrNull(t.defaultRule,e,t,r);if(!r)throw new Error("FeatureFlag must decide the Variation [".concat(t.id,"]"));return N.withVariation(r,a.DEFAULT_RULE)},H=be,Te.prototype.isUserInExperimentTarget=function(t,e,r,n){var i=this;return 0===e.targetAudiences.length||e.targetAudiences.some(function(e){return i.targetMatcher.matches(e,t,r,n)})},G=Te,Ee.prototype.determineTargetRuleOrNull=function(t,e,r,n){var i=this;return e.targetRules.find(function(e){return i.targetMatcher.matches(e.target,t,r,n)})},B=Ee,ge.prototype.resolveOrNull=function(t,e,r,n){var i=this,o=e.userOverrides.get(r.id);if(o)return e._getVariationByIdOrNull(o);o=e.segmentOverrides.find(function(e){return i.targetMatcher.matches(e.target,t,r,n)});return o?this.actionResolver.resolveOrNull(o.action,t,e,r):void 0},K=ge,ye.prototype.getFlow=function(e){switch(e){case"AB_TEST":return this.abTestFlow;case"FEATURE_FLAG":return this.featureFlagFlow}},q=ye,z=sr.log,we.prototype._experiment=function(e,t,r,n){if(!e)return z.error("experimentKey must not be empty"),o.of(n,a.INVALID_INPUT);if(!t)return z.error("user must not be null."),o.of(n,a.INVALID_INPUT);if(!t.id||"string"!=typeof t.id)return z.error("user.id must not be null and must be string type"),o.of(n,a.INVALID_INPUT);var i=this.workspaceFetcher.get();if(!i)return z.warn("SDK not ready."),o.of(n,a.SDK_NOT_READY);e=i.getExperimentOrNull(e);if(!e)return z.warn("Experiment does not exist."),o.of(n,a.EXPERIMENT_NOT_FOUND);n=this.evaluator.evaluate(i,e,t,r,n);return this.eventProcessor.process(b.exposure(e,t,n,r)),o.of(n.variationKey,n.reason)},we.prototype._featureFlag=function(e,t,r){if(!e)return z.error("featureKey must not be empty"),s.off(a.INVALID_INPUT);if(!t)return z.error("user must not be null."),s.off(a.INVALID_INPUT);if(!t.id||"string"!=typeof t.id)return z.error("user.id must not be null and must be string type"),s.off(a.INVALID_INPUT);var n=this.workspaceFetcher.get();if(!n)return z.warn("SDK not ready."),s.off(a.SDK_NOT_READY);e=n.getFeatureFlagOrNull(e);if(!e)return z.warn("FeatureFlag does not exist."),s.off(a.FEATURE_FLAG_NOT_FOUND);n=this.evaluator.evaluate(n,e,t,r,"A");return this.eventProcessor.process(b.exposure(e,t,n,r)),"A"===n.variationKey?s.off(n.reason):s.on(n.reason)},we.prototype._track=function(e,t,r){var n;e?"object"==typeof e?"object"!=typeof e||e.key&&"string"==typeof e.key?t?t.id&&"string"==typeof t.id?(n=this.workspaceFetcher.get())?(n=n.getEventTypeOrNull(e.key),this.eventProcessor.process(b.track(n,e,t,r))):z.warn("SDK not ready"):z.error("Id must not be null. or Id must be string type"):z.error("User must not be null."):z.warn("Event key must be not null. or event key must be string type."):z.warn("Event must be event type."):z.warn("event must not be null.")},we.prototype._onReady=function(e,t){this._onInitialized({timeout:t=void 0===t?3e3:t}).then(function(){return e()})},we.prototype._onInitialized=function(e){var t,r=e.timeout,e=void 0===r?3e3:r;z.debug("Start HackleClient initializing");var r=new Promise(function(e){t=e}),n=setTimeout(function(){t({success:!1})},e);return this.readyPromise.then(function(){clearTimeout(n),t({success:!0})}),Promise.race([this.readyPromise,r]).then(function(e){return z.debug("HackleClient onInitialized"),Promise.resolve({success:e.success})})},we.prototype._close=function(){this.workspaceFetcher.close(),this.eventProcessor.close()},or=we,me.prototype.start=function(){this.timeoutId=setTimeout(this.callback,this.timeout)},me.prototype.refresh=function(){this.stop(),this.start()},me.prototype.stop=function(){this.timeoutId&&clearTimeout(this.timeoutId)},j=me,ve.prototype.start=function(){this.started=!0},ve.prototype.stop=function(){this.started=!1;var e=this.sink(this.buffer,!0);return this.buffer=[],this.timer.stop(),e},ve.prototype.enqueue=function(e){this.started&&(0===this.buffer.length&&this.timer.refresh(),this.buffer.push(e),this.buffer.length>=this.maxQueueSize&&this.flush())},ve.prototype.flush=function(){this.sink(this.buffer),this.buffer=[],this.timer.stop()},ve.prototype.close=function(){this.stop()},X=ve,fe.prototype.drainQueue=function(t,r){var n=this;return new Promise(function(e){0!==t.length?r?n.eventDispatcher.dispatchXhrOrBeacon(t,function(){e()}):n.eventDispatcher.dispatch(t,function(){e()}):e()})},fe.prototype.process=function(e){this.queue.enqueue(e)},fe.prototype.start=function(){return e=this,u=function(){return r=this,n=function(e){return this.queue.start(),[2]},a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!((s=0<(s=a.trys).length&&s[s.length-1])||6!==t[0]&&2!==t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],o=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}var r,n,i,o,s,a,t},new(a=(a=s=void 0)||Promise)(function(r,t){function n(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}o((u=u.apply(e,s||[])).next())});var e,s,a,u},fe.prototype.stop=function(){try{this.queue.close()}catch(e){}return Promise.resolve()},fe.prototype.close=function(){this.stop()},fe.DEFAULT_FLUSH_INTERVAL=1e4,ir=fe,Y=sr.log,pt.prototype.getExperimentOrNull=function(e){return this.experiments.get(e)},pt.prototype.getFeatureFlagOrNull=function(e){return this.featureFlags.get(e)},pt.prototype.getBucketOrNull=function(e){return this.buckets.get(e)},pt.prototype.getEventTypeOrNull=function(e){return this.eventTypes.get(e)||new te(0,e)},pt.prototype.getSegmentOrNull=function(e){return this.segments.get(e)},pt.from=function(e){var t=this,r=pt.associate(e.buckets,function(e){return[e.id,t.toBucket(e)]}),n=pt.associateBy(pt.mapNotUndefined(e.experiments,function(e){return t.toExperimentOrNull("AB_TEST",e)}),function(e){return e.key}),i=pt.associateBy(pt.mapNotUndefined(e.featureFlags,function(e){return t.toExperimentOrNull("FEATURE_FLAG",e)}),function(e){return e.key}),o=pt.associate(e.events,function(e){return[e.key,new te(e.id,e.key)]}),e=pt.associateBy(pt.mapNotUndefined(e.segments,function(e){return t.toSegmentOrNull(e)}),function(e){return e.key});return new pt(n,i,r,o,e)},pt.toBucket=function(e){return new ee(e.seed,e.slotSize,e.slots.map(function(e){var t=e.startInclusive,r=e.endExclusive,e=e.variationId;return new u(t,r,e)}))},pt.toExperimentOrNull=function(e,t){var r=this,n=this.experimentStatusOrNull(t.execution.status),i=t.variations.map(function(e){return new J(e.id,e.key,"DROPPED"===e.status)}),o=pt.associate(t.execution.userOverrides,function(e){return[e.userId,e.variationId]}),s=pt.mapNotUndefined(t.execution.segmentOverrides,function(e){return r.toTargetRuleOrNull(e,E.IDENTIFIER)}),a=pt.mapNotUndefined(t.execution.targetAudiences,function(e){return r.toTargetOrNull(e,E.PROPERTY)}),u=pt.mapNotUndefined(t.execution.targetRules,function(e){return r.toTargetRuleOrNull(e,E.PROPERTY)}),c=this.toTargetActionOrNull(t.execution.defaultRule);return n&&c&&new l(t.id,t.key,e,n,i,o,s,a,u,c,t.winnerVariationId)},pt.experimentStatusOrNull=function(e){switch(e){case"READY":return"DRAFT";case"RUNNING":return"RUNNING";case"PAUSED":return"PAUSED";case"STOPPED":return"COMPLETED";default:return void Y.debug("Unsupported status [".concat(e,"]"))}},pt.toTargetRuleOrNull=function(e,t){t=this.toTargetOrNull(e.target,t),e=this.toTargetActionOrNull(e.action);return t&&e&&new ae(t,e)},pt.toTargetActionOrNull=function(e){var t=this.parseOrNull(r,e.type);return t&&new se(t,e.variationId,e.bucketId)},pt.toTargetOrNull=function(e,t){var r=this,e=pt.mapNotUndefined(e.conditions,function(e){return r.toConditionOrNull(e,t)});return new re(e)},pt.toConditionOrNull=function(e,t){var r=this.toTargetKeyOrNull(e.key);if(r&&t.supports(r.type)){e=this.toTargetMatchOrNull(e.match);return e&&new ne(r,e)}},pt.toTargetKeyOrNull=function(e){var t=this.parseOrNull(y,e.type);return t&&new ie(t,e.name)},pt.toTargetMatchOrNull=function(e){var t=this.parseOrNull(v,e.type),r=this.parseOrNull(w,e.operator),n=this.parseOrNull(m,e.valueType);return t&&r&&n&&new oe(t,r,n,e.values)},pt.toSegmentOrNull=function(e){var t=this,r=this.parseOrNull(g,e.type);return r&&new ue(e.id,e.key,r,this.mapNotUndefined(e.targets,function(e){return t.toTargetOrNull(e,E.SEGMENT)}))},pt.parseOrNull=function(e,t){e=e.find(function(e){return e===t});return e||Y.debug("Unsupported type [".concat(t,"]. Please use the latest version of sdk.")),e},pt.mapNotUndefined=function(e,r){return e.reduce(function(e,t){t=r(t);return t&&e.push(t),e},Array())},pt.associateTo=function(e,t,r){return e.reduce(function(e,t){t=r(t);return e.set(t[0],t[1]),e},t)},pt.associate=function(e,t){return pt.associateTo(e,new Map,t)},pt.associateBy=function(e,t){return this.associateTo(e,new Map,function(e){return[t(e),e]})},ar=pt,ur.Bucket=ee,ur.CoreVersion=d,ur.DEFAULT_ON_READY_TIMEOUT=3e3,ur.Decision=o,ur.DecisionReason=a,ur.DefaultEventQueue=X,ur.Event=b,ur.EventProcessor=ir,ur.EventType=te,ur.Experiment=l,ur.Exposure=_,ur.FeatureFlagDecision=s,ur.HackleInternalClient=or,ur.Logger=sr,ur.MATCH_OPERATORS=w,ur.MATCH_TYPES=v,ur.MATCH_VALUE_TYPES=m,ur.MetaVersion=f,ur.SEGMENT_TYPES=g,ur.Segment=ue,ur.Slot=u,ur.TARGET_ACTION_TYPES=r,ur.TARGET_KEY_TYPES=y,ur.Target=re,ur.TargetAction=se,ur.TargetCondition=ne,ur.TargetKey=ie,ur.TargetMatch=oe,ur.TargetRule=ae,ur.TargetingType=E,ur.Track=R,ur.Variation=J,ur.Version=h,ur.Workspace=ar,ur.logLevels=t,ur.toPayload=function(e){var t=new Array,r=new Array;return e.forEach(function(e){b.isExposure(e)?t.push(e.toDto()):b.isTrack(e)&&r.push(e.toDto())}),{exposureEvents:t,trackEvents:r}},Object.defineProperty(ur,"__esModule",{value:!0});var ht="X-HACKLE-SDK-KEY",dt="X-HACKLE-SDK-NAME",ft="X-HACKLE-SDK-VERSION",vt="X-HACKLE-SDK-TIME",mt=[0,8,16,32,64,128,256,512],wt="_hackle_hid",yt="_hackle_id",gt=Z.exports.Logger.log;function Et(n,i){return{abort:function(){},responsePromise:new Promise(function(e,t){var r=new XMLHttpRequest;r.open("GET",n),r.onreadystatechange=function(){r.readyState===r.DONE&&200<=r.status&&r.status<400&&e({statusCode:r.status,body:r.responseText})},r.setRequestHeader("content-type","application/json"),r.withCredentials=!0,Tt(r,i),r.send()})}}function Tt(e,t){for(var r in t)t.hasOwnProperty(r)&&e.setRequestHeader(r,t[r])}var bt=(At.prototype.dispatch=function(e,t){this._post(e,t)},At.prototype.dispatchXhrOrBeacon=function(e,t){this.useBeacon?this._beacon(e,t):this._post(e,t)},At.prototype._post=function(e,t){var r,n,i=this._createRequest(e),o=i.payload,e=i.headers;i=this.dispatchUrl,e=e,r=t,o=JSON.stringify(o),(n=new XMLHttpRequest).open("POST",i),n.onreadystatechange=function(){n.readyState===n.DONE&&200<=n.status&&n.status<400&&r(n)},n.setRequestHeader("content-type","application/json"),n.withCredentials=!0,Tt(n,e),n.send(o)},At.prototype._beacon=function(e,t){var r=this._createRequest(e),n=r.payload,i=r.headers;e=this.beaconDispatchUrl,r=i,i=t,t=!1,(t="undefined"!=typeof window?window&&window.navigator&&window.navigator.sendBeacon&&!0:t)?(n=JSON.stringify(n),(t=new URLSearchParams).append("sdkName",r[dt]),t.append("sdkVersion",r[ft]),t.append("sdkTime",r[vt]),t.append("data",n),window.navigator.sendBeacon(e,t)):gt.error("Does not support sendBeacon"),i()},At.prototype._createRequest=function(e){return{payload:Z.exports.toPayload(e),headers:W(((e={})[ht]=this.sdkKey,e[vt]=(new Date).getTime().toString(),e),this.headers)}},At),_t={exports:{}},Rt="object"==typeof Reflect?Reflect:null,Nt=Rt&&"function"==typeof Rt.apply?Rt.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};function At(e,t){this.sdkKey=e,this.headers=t.headers,this.dispatchUrl=t.dispatchUrl,this.beaconDispatchUrl=t.beaconDispatchUrl||"",this.useBeacon=t.useBeacon}var Ot=Rt&&"function"==typeof Rt.ownKeys?Rt.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},It=Number.isNaN||function(e){return e!=e};function kt(){kt.init.call(this)}_t.exports=kt,_t.exports.once=function(i,o){return new Promise(function(e,t){function r(e){i.removeListener(o,n),t(e)}function n(){"function"==typeof i.removeListener&&i.removeListener("error",r),e([].slice.call(arguments))}Vt(i,o,n,{once:!0}),"error"===o||"function"==typeof i.on&&Vt(i,"error",r,{once:!0})})},(kt.EventEmitter=kt).prototype._events=void 0,kt.prototype._eventsCount=0,kt.prototype._maxListeners=void 0;var xt,Mt=10;function St(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Ct(e){return void 0===e._maxListeners?kt.defaultMaxListeners:e._maxListeners}function Pt(e,t,r,n){var i,o;return St(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener||r),i=e._events),o=i[t]),void 0===o?(o=i[t]=r,++e._eventsCount):("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),0<(r=Ct(e))&&o.length>r&&!o.warned&&(o.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",r.emitter=e,r.type=t,r.count=o.length,console&&console.warn&&console.warn(r))),e}function Lt(e,t,r){e={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},t=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(e);return t.listener=r,e.wrapFn=t}function Dt(e,t,r){e=e._events;if(void 0===e)return[];t=e[t];return void 0===t?[]:"function"==typeof t?r?[t.listener||t]:[t]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):Ft(t,t.length)}function Ut(e){var t=this._events;if(void 0!==t){e=t[e];if("function"==typeof e)return 1;if(void 0!==e)return e.length}return 0}function Ft(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Vt(r,n,i,o){if("function"==typeof r.on)o.once?r.once(n,i):r.on(n,i);else{if("function"!=typeof r.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r);r.addEventListener(n,function e(t){o.once&&r.removeEventListener(n,e),i(t)})}}Object.defineProperty(kt,"defaultMaxListeners",{enumerable:!0,get:function(){return Mt},set:function(e){if("number"!=typeof e||e<0||It(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Mt=e}}),kt.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},kt.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||It(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},kt.prototype.getMaxListeners=function(){return Ct(this)},kt.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n,i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){if((n=0<t.length?t[0]:n)instanceof Error)throw n;i=new Error("Unhandled error."+(n?" ("+n.message+")":""));throw i.context=n,i}e=o[e];if(void 0===e)return!1;if("function"==typeof e)Nt(e,this,t);else for(var s=e.length,a=Ft(e,s),r=0;r<s;++r)Nt(a[r],this,t);return!0},kt.prototype.on=kt.prototype.addListener=function(e,t){return Pt(this,e,t,!1)},kt.prototype.prependListener=function(e,t){return Pt(this,e,t,!0)},kt.prototype.once=function(e,t){return St(t),this.on(e,Lt(this,e,t)),this},kt.prototype.prependOnceListener=function(e,t){return St(t),this.prependListener(e,Lt(this,e,t)),this},kt.prototype.off=kt.prototype.removeListener=function(e,t){var r,n,i,o,s;if(St(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;0<=o;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},kt.prototype.removeAllListeners=function(e){var t,r;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},kt.prototype.listeners=function(e){return Dt(this,e,!0)},kt.prototype.rawListeners=function(e){return Dt(this,e,!1)},kt.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Ut.call(e,t)},kt.prototype.listenerCount=Ut,kt.prototype.eventNames=function(){return 0<this._eventsCount?Ot(this._events):[]};var Ht=new Uint8Array(16);var Gt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Bt=[],Kt=0;Kt<256;++Kt)Bt.push((Kt+256).toString(16).substr(1));function qt(e,t,r){var n=(e=e||{}).random||(e.rng||function(){if(!xt&&!(xt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return xt(Ht)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return function(e,t){var t=1<arguments.length&&void 0!==t?t:0,e=(Bt[e[t+0]]+Bt[e[t+1]]+Bt[e[t+2]]+Bt[e[t+3]]+"-"+Bt[e[t+4]]+Bt[e[t+5]]+"-"+Bt[e[t+6]]+Bt[e[t+7]]+"-"+Bt[e[t+8]]+Bt[e[t+9]]+"-"+Bt[e[t+10]]+Bt[e[t+11]]+Bt[e[t+12]]+Bt[e[t+13]]+Bt[e[t+14]]+Bt[e[t+15]]).toLowerCase();if("string"!=typeof(t=e)||!Gt.test(t))throw TypeError("Stringified UUID is invalid");return e}(n)}var zt=(jt.get=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null},jt.set=function(e,t,r,n,i,o){var s,a="",u="",c="";n&&(a=(s=function(e){var t=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,r=e.split("."),r=r[r.length-1];(4<r.length||"com"===r||"org"===r)&&(t=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i);t=e.match(t);return t?t[0]:""}(document.location.hostname))?"; domain=."+s:""),r&&((s=new Date).setTime(s.getTime()+24*r*60*60*1e3),u="; expires="+s.toUTCString()),o&&(i=!0,c="; SameSite=None"),i&&(c+="; secure");c=e+"="+encodeURIComponent(t)+u+"; path=/"+a+c;return document.cookie=c},jt.remove=function(e,t){jt.set(e,"",-1,t,!1,!1)},jt);function jt(){}var Xt=(Yt.initialize=function(){zt.get(wt)||Qt()},Yt.reInitialize=function(){Qt()},Yt);function Yt(){}function Wt(){var e=zt.get(yt);return e||zt.get(wt)||Qt()}function Zt(e){zt.set(yt,e,3650,!0)}function $t(){zt.remove(yt,!0)}function Qt(){var e=qt();return zt.set(wt,e,3650,!0),e}var Jt="model",er="name",tr="type",rr="vendor",nr="version",ir="architecture",or="console",sr="mobile",ar="tablet",ur="smarttv",Rt="wearable",cr=(br.parse=function(e){return{browser:br.getBrowser(e),cpu:br.getCPU(e),device:br.getDevice(e),engine:br.getEngine(e),os:br.getOS(e)}},br.getBrowser=function(e){var t={name:void 0,version:void 0,major:void 0};return br.mapper.rgx.call(t,e,br.regexes.browser),t.major=br.util.major(t.version),t},br.getCPU=function(e){var t={architecture:void 0};return br.mapper.rgx.call(t,e,br.regexes.cpu),t},br.getDevice=function(e){var t={model:void 0,type:void 0,vendor:void 0};return br.mapper.rgx.call(t,e,br.regexes.device),t},br.getEngine=function(e){var t={name:void 0,version:void 0};return br.mapper.rgx.call(t,e,br.regexes.os),t},br.getOS=function(e){var t={name:void 0,version:void 0};return br.mapper.rgx.call(t,e,br.regexes.os),t},br.util={extend:function(e,t){var r,n={};for(r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},br.regexes={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[er,nr],[/(opios)[\/\s]+([\w\.]+)/i],[[er,"Opera Mini"],nr],[/\s(opr)\/([\w\.]+)/i],[[er,"Opera"],nr],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[er,nr],[/(konqueror)\/([\w\.]+)/i],[[er,"Konqueror"],nr],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[er,"IE"],nr],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[er,"Edge"],nr],[/(yabrowser)\/([\w\.]+)/i],[[er,"Yandex"],nr],[/(Avast)\/([\w\.]+)/i],[[er,"Avast Secure Browser"],nr],[/(AVG)\/([\w\.]+)/i],[[er,"AVG Secure Browser"],nr],[/(puffin)\/([\w\.]+)/i],[[er,"Puffin"],nr],[/(focus)\/([\w\.]+)/i],[[er,"Firefox Focus"],nr],[/(opt)\/([\w\.]+)/i],[[er,"Opera Touch"],nr],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[er,"UCBrowser"],nr],[/(comodo_dragon)\/([\w\.]+)/i],[[er,/_/g," "],nr],[/(windowswechat qbcore)\/([\w\.]+)/i],[[er,"WeChat(Win) Desktop"],nr],[/(micromessenger)\/([\w\.]+)/i],[[er,"WeChat"],nr],[/(brave)\/([\w\.]+)/i],[[er,"Brave"],nr],[/(whale)\/([\w\.]+)/i],[[er,"Whale"],nr],[/(qqbrowserlite)\/([\w\.]+)/i],[er,nr],[/(QQ)\/([\d\.]+)/i],[er,nr],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[er,nr],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[er,nr],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[er,nr],[/(MetaSr)[\/\s]?([\w\.]+)/i],[er],[/(LBBROWSER)/i],[er],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[nr,[er,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[nr,[er,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[er,nr],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[nr,[er,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[er,/(.+)/,"$1 WebView"],nr],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[er,/(.+(?:g|us))(.+)/,"$1 $2"],nr],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[er,"Chrome Mobile"],nr],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[nr,[er,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[er,"Sailfish Browser"],nr],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[er,nr],[/(dolfin)\/([\w\.]+)/i],[[er,"Dolphin"],nr],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[er,"360 Browser"]],[/(coast)\/([\w\.]+)/i],[[er,"Opera Coast"],nr],[/fxios\/([\w\.-]+)/i],[nr,[er,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[nr,[er,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[nr,er],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[er,"GSA"],nr],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[er,[nr,(br.mapper={rgx:function(e,t){for(var r,n,i,o,s,a=0;a<t.length&&!o;){for(var u=t[a],c=t[a+1],l=r=0;l<u.length&&!o;)if(o=u[l++].exec(e))for(n=0;n<c.length;n++)s=o[++r],"object"==typeof(i=c[n])&&0<i.length?2==i.length?"function"==typeof i[1]?this[i[0]]=i[1].call(this,s):this[i[0]]=i[1]:3==i.length?"function"!=typeof i[1]||i[1].exec&&i[1].test?this[i[0]]=s?s.replace(i[1],i[2]):void 0:this[i[0]]=s?i[1].call(this,s,i[2]):void 0:4==i.length&&(this[i[0]]=s?i[3].call(this,s.replace(i[1],i[2])):void 0):this[i]=s||void 0;a+=2}},str:function(e,t){for(var r in t)if("object"==typeof t[r]&&0<t[r].length){for(var n=0;n<t[r].length;n++)if(br.util.has(t[r][n],e))return"?"===r?void 0:r}else if(br.util.has(t[r],e))return"?"===r?void 0:r;return e}}).str,(br.maps={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}}).browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[er,nr],[/(navigator|netscape)\/([\w\.-]+)/i],[[er,"Netscape"],nr],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[er,nr]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[ir,"amd64"]],[/(ia32(?=;))/i],[[ir,br.util.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[ir,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[ir,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[ir,/ower/,"",br.util.lowerize]],[/(sun4\w)[;\)]/i],[[ir,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[ir,br.util.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[Jt,rr,[tr,ar]],[/applecoremedia\/[\w\.]+ \((ipad)/],[Jt,[rr,"Apple"],[tr,ar]],[/(apple\s{0,1}tv)/i],[[Jt,"Apple TV"],[rr,"Apple"],[tr,ur]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[rr,Jt,[tr,ar]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[Jt,[rr,"Amazon"],[tr,ar]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[Jt,br.mapper.str,br.maps.device.amazon.model],[rr,"Amazon"],[tr,sr]],[/android.+aft([bms])\sbuild/i],[Jt,[rr,"Amazon"],[tr,ur]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[Jt,rr,[tr,sr]],[/\((ip[honed|\s\w*]+);/i],[Jt,[rr,"Apple"],[tr,sr]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[rr,Jt,[tr,sr]],[/\(bb10;\s(\w+)/i],[Jt,[rr,"BlackBerry"],[tr,sr]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[Jt,[rr,"Asus"],[tr,ar]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[rr,"Sony"],[Jt,"Xperia Tablet"],[tr,ar]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[Jt,[rr,"Sony"],[tr,sr]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[rr,Jt,[tr,or]],[/android.+;\s(shield)\sbuild/i],[Jt,[rr,"Nvidia"],[tr,or]],[/(playstation\s[34portablevi]+)/i],[Jt,[rr,"Sony"],[tr,or]],[/(sprint\s(\w+))/i],[[rr,br.mapper.str,br.maps.device.sprint.vendor],[Jt,br.mapper.str,br.maps.device.sprint.model],[tr,sr]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[rr,[Jt,/_/g," "],[tr,sr]],[/(nexus\s9)/i],[Jt,[rr,"HTC"],[tr,ar]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[Jt,[rr,"Huawei"],[tr,sr]],[/android.+(bah2?-a?[lw]\d{2})/i],[Jt,[rr,"Huawei"],[tr,ar]],[/(microsoft);\s(lumia[\s\w]+)/i],[rr,Jt,[tr,sr]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[Jt,[rr,"Microsoft"],[tr,or]],[/(kin\.[onetw]{3})/i],[[Jt,/\./g," "],[rr,"Microsoft"],[tr,sr]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[Jt,[rr,"Motorola"],[tr,sr]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[Jt,[rr,"Motorola"],[tr,ar]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[rr,br.util.trim],[Jt,br.util.trim],[tr,ur]],[/hbbtv.+maple;(\d+)/i],[[Jt,/^/,"SmartTV"],[rr,"Samsung"],[tr,ur]],[/\(dtv[\);].+(aquos)/i],[Jt,[rr,"Sharp"],[tr,ur]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[rr,"Samsung"],Jt,[tr,ar]],[/smart-tv.+(samsung)/i],[rr,[tr,ur],Jt],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[rr,"Samsung"],Jt,[tr,sr]],[/sie-(\w*)/i],[Jt,[rr,"Siemens"],[tr,sr]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[rr,"Nokia"],Jt,[tr,sr]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[Jt,[rr,"Acer"],[tr,ar]],[/android.+([vl]k\-?\d{3})\s+build/i],[Jt,[rr,"LG"],[tr,ar]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[rr,"LG"],Jt,[tr,ar]],[/(lg) netcast\.tv/i],[rr,Jt,[tr,ur]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[Jt,[rr,"LG"],[tr,sr]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[rr,Jt,[tr,ar]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[Jt,[rr,"Lenovo"],[tr,ar]],[/(lenovo)[_\s-]?([\w-]+)/i],[rr,Jt,[tr,sr]],[/linux;.+((jolla));/i],[rr,Jt,[tr,sr]],[/((pebble))app\/[\d\.]+\s/i],[rr,Jt,[tr,Rt]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[rr,Jt,[tr,sr]],[/crkey/i],[[Jt,"Chromecast"],[rr,"Google"],[tr,ur]],[/android.+;\s(glass)\s\d/i],[Jt,[rr,"Google"],[tr,Rt]],[/android.+;\s(pixel c)[\s)]/i],[Jt,[rr,"Google"],[tr,ar]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[Jt,[rr,"Google"],[tr,sr]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[Jt,/_/g," "],[rr,"Xiaomi"],[tr,sr]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[Jt,/_/g," "],[rr,"Xiaomi"],[tr,ar]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[Jt,[rr,"Meizu"],[tr,sr]],[/(mz)-([\w-]{2,})/i],[[rr,"Meizu"],Jt,[tr,sr]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[Jt,[rr,"OnePlus"],[tr,sr]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[Jt,[rr,"RCA"],[tr,ar]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[Jt,[rr,"Dell"],[tr,ar]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[Jt,[rr,"Verizon"],[tr,ar]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[rr,"Barnes & Noble"],Jt,[tr,ar]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[Jt,[rr,"NuVision"],[tr,ar]],[/android.+;\s(k88)\sbuild/i],[Jt,[rr,"ZTE"],[tr,ar]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[Jt,[rr,"Swiss"],[tr,sr]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[Jt,[rr,"Swiss"],[tr,ar]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[Jt,[rr,"Zeki"],[tr,ar]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[rr,"Dragon Touch"],Jt,[tr,ar]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[Jt,[rr,"Insignia"],[tr,ar]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[Jt,[rr,"NextBook"],[tr,ar]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[rr,"Voice"],Jt,[tr,sr]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[rr,"LvTel"],Jt,[tr,sr]],[/android.+;\s(PH-1)\s/i],[Jt,[rr,"Essential"],[tr,sr]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[Jt,[rr,"Envizen"],[tr,ar]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[rr,Jt,[tr,ar]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[Jt,[rr,"MachSpeed"],[tr,ar]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[rr,Jt,[tr,ar]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[Jt,[rr,"Rotor"],[tr,ar]],[/android.+(KS(.+))\s+build/i],[Jt,[rr,"Amazon"],[tr,ar]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[rr,Jt,[tr,ar]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[tr,br.util.lowerize],rr,Jt],[/[\s\/\(](smart-?tv)[;\)]/i],[[tr,ur]],[/(android[\w\.\s\-]{0,9});.+build/i],[Jt,[rr,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[nr,[er,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[nr,[er,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[er,nr],[/rv\:([\w\.]{1,9}).+(gecko)/i],[nr,er]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[er,nr],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[er,br.mapper.str,br.maps.os.windows],[nr,br.mapper.str,br.maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[er,"Windows"],[nr,br.mapper.str,br.maps.os.windows.version]],[/\((bb)(10);/i],[[er,"BlackBerry"],nr],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[er,nr],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[er,"Symbian"],nr],[/\((series40);/i],[er],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[er,"Firefox OS"],nr],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[er,"Linux"],nr],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[er,"Chromium OS"],nr],[/(sunos)\s?([\w\.\d]*)/i],[[er,"Solaris"],nr],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[er,"Linux"],nr],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[er,"iPhone"],[nr,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[er,"iPad"],[nr,/_/g,"."]],[/(haiku)\s(\w+)/i],[er,nr],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[nr,/_/g,"."],[er,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[er,"Mac"],[nr,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[er,nr]]},br),lr=(Tr.generate=function(e){var t;t=void 0===e?{navigator:{userAgent:"",vendor:"",languages:[]},document:{location:u={hostname:"",pathname:"",host:"",search:"",protocol:""},title:""},location:u,screen:{width:"",height:""}}:e;var r=cr.parse(t.navigator.userAgent),n=r.browser,i=r.os,o=r.device,s=o.type?"mobile"===o.type?"Mobile":"ETC":"Web",a=(t.location.protocol||"").replace(":",""),u=t.screen,r="";try{r=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}return{platform:s||"",browserName:n.name||"",browserMajorVersion:n.major||"",browserVersion:n.version||"",osName:i.name||"",osVersion:i.version||"",deviceModel:o.model||"",deviceType:o.type||"",deviceVendor:o.vendor||"",language:(null===(o=t.navigator.languages)||void 0===o?void 0:o[0])||"",userAgent:t.navigator.userAgent||"",pagePath:t.location.pathname||"",pageTitle:t.document.title||"",host:t.location.host||"",protocol:a,referrer:t.document.referrer||"",queryParameter:t.location.search||"",screenWidth:u.width||"",screenHeight:u.height||"",timeZone:r||""}},Tr),pr=Z.exports.Logger.log,hr=(Er.prototype.variation=function(e,t,r){return this.variationDetail(e,t,r).variation},Er.prototype.variationDetail=function(e,t,r){try{return this.hackleInternalClient._experiment(e,this._getUser(t),this._getHackleProperties(),r||"A")}catch(t){return pr.error("Unexpected exception while deciding variation for experiment[".concat(e,"]. Returning default variation[").concat(r,"] : ").concat(t)),Z.exports.Decision.of(r||"A",Z.exports.DecisionReason.EXCEPTION)}},Er.prototype.isFeatureOn=function(e,t){return this.featureFlagDetail(e,t).isOn},Er.prototype.featureFlagDetail=function(e,t){try{return this.hackleInternalClient._featureFlag(e,this._getUser(t),this._getHackleProperties())}catch(t){return pr.error('"Unexpected exception while deciding feature flag['.concat(e,"]. Returning default value[false] : ").concat(t)),Z.exports.FeatureFlagDecision.off(Z.exports.DecisionReason.EXCEPTION)}},Er.prototype.track=function(e,t){pr.debug("track event : ".concat(JSON.stringify(e))),this.hackleInternalClient._track(this._convertEvent(e),this._getUser(t),this._getHackleProperties())},Er.prototype.trackPageView=function(e){pr.debug("tracking page view"),this.hackleInternalClient._track({key:"$page_view"},this._getUser(null==e?void 0:e.user),this._getHackleProperties())},Er.prototype._getHackleProperties=function(){var e;return(e="undefined"!=typeof window?lr.generate(window):e)||{}},Er.prototype._getUser=function(e){return e?"string"==typeof e?{id:e}:e:{id:Wt()}},Er.prototype.onReady=function(e,t){void 0===t&&(t=Z.exports.DEFAULT_ON_READY_TIMEOUT),this.hackleInternalClient._onReady(e,t)},Er.prototype.onInitialized=function(e){return this.hackleInternalClient._onInitialized({timeout:null==e?void 0:e.timeout})},Er.prototype.close=function(){pr.debug("Hackle Client is closing"),this.hackleInternalClient._close()},Er.prototype._convertEvent=function(e){return"string"==typeof e?{key:e}:e},Er),dr=(gr.prototype.onReady=function(){return this.readyPromise},gr.prototype.start=function(){this.isStarted||(this.isStarted=!0,this.errorRetryController.reset(),this.fetch())},gr.prototype.stop=function(){return this.isStarted=!1,this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),Promise.resolve()},gr.prototype.get=function(){return this.workspace},gr.prototype.scheduleNextUpdate=function(){var e=this,t=this.errorRetryController.getDelay(),t=Math.max(t,this.updateInterval);this.currentTimeout=setTimeout(function(){e.currentRequest?e.syncOnCurrentRequestComplete=!0:e.fetch()},t)},gr.prototype.fetch=function(){var t=this,e=((e={})[ht]=this.sdkKey,e[vt]=(new Date).getTime().toString(),e[dt]=this.headers[dt],e[ft]=this.headers[ft],e);this.currentRequest=this.httpGetRequest(this.fetchUrl,e);function r(){t.onRequestComplete()}this.currentRequest.responsePromise.then(function(e){t.onRequestResolved(e)},function(e){t.onRequestRejected(e)}).then(r,r),0<this.updateInterval&&this.scheduleNextUpdate()},gr.prototype.onRequestComplete=function(){this.isStarted&&(this.currentRequest=null,this.syncOnCurrentRequestComplete&&this.fetch(),this.syncOnCurrentRequestComplete=!1)},gr.prototype.onRequestResolved=function(e){var t=this;this.isStarted&&(void 0!==e.statusCode&&200<=e.statusCode&&e.statusCode<400?this.errorRetryController.reset():this.errorRetryController.countError(),e.body)&&(e=JSON.parse(e.body),this.workspace||setTimeout(function(){t.eventEmitter.emit("ready")},0),this.workspace=Z.exports.Workspace.from(e),this.readyPromiseResolver())},gr.prototype.onRequestRejected=function(e){console.error(e),this.isStarted&&this.errorRetryController.countError()},gr.prototype.close=function(){this.stop()},gr),fr=(yr.prototype.getDelay=function(){return 0===this.errorCount?0:1e3*mt[Math.min(mt.length-1,this.errorCount)]+Math.round(1e3*Math.random())},yr.prototype.countError=function(){this.errorCount<mt.length-1&&this.errorCount++},yr.prototype.reset=function(){this.errorCount=0},yr),vr=Z.exports.Logger.log,mr=null,wr={debug:!1,log_disabled:!1,auto_track_page_view:!0,SDK_NAME_HEADER:"js-client-sdk",SDK_VERSION_HEADER:"3.3.2"};function yr(){this.errorCount=0}function gr(e,t,r,n){var i=this;this.workspace=null,this.sdkKey=e,this.httpGetRequest=t,this.eventEmitter=r,this.isStarted=!1,this.updateInterval=n.updateInterval,this.fetchUrl=n.fetchUrl,this.headers=n.headers,this.readyPromiseResolver=function(){},this.readyPromiseRejecter=function(){},this.readyPromise=new Promise(function(e,t){i.readyPromiseResolver=e,i.readyPromiseRejecter=t}),this.currentTimeout=null,this.errorRetryController=new fr,this.currentRequest=null,this.syncOnCurrentRequestComplete=!1,this.isReadyPromiseSettled=!1}function Er(e,t,r){this.hackleInternalClient=new Z.exports.HackleInternalClient(e,t,r)}function Tr(){}function br(){}function _r(e,t){var r=W(W({},wr),t);if(r.log_disabled?Z.exports.Logger.setLogLevel(Z.exports.logLevels.DISABLE):r.debug&&Z.exports.Logger.setLogLevel(Z.exports.logLevels.DEBUG),vr.debug("sdkKey : "+e),e||vr.error("SDK Key must not be null"),mr)return vr.debug("use already exists hackleClient"),mr;Xt.initialize();var n=!1;"undefined"!=typeof window&&(n=window&&window.navigator&&window.navigator.sendBeacon&&!0)&&vr.debug("support sendBeacon API");var i,n=new bt(e,{dispatchUrl:"https://event.hackle.io/api/v2/w/events",beaconDispatchUrl:"".concat("https://event.hackle.io/api/v2/w/").concat(e).concat("/events"),useBeacon:n,headers:((t={})[dt]=r.SDK_NAME_HEADER,t[ft]=r.SDK_VERSION_HEADER,t)}),t=new _t.exports.EventEmitter,e=new dr(e,Et,t,{fetchUrl:"".concat("https://sdk.hackle.io/api/v2/w/").concat(e).concat("/w"),updateInterval:-1,headers:((e={})[dt]=r.SDK_NAME_HEADER,e[ft]=r.SDK_VERSION_HEADER,e)}),n=new Z.exports.EventProcessor(n,100,500),o=new hr(e,n,t);return mr=o,r.auto_track_page_view&&(i=function(){return o.trackPageView({user:{id:Wt()}})},o.onReady(function(){i();try{history.pushState=(r=history.pushState,function(){var e=r.apply(this,arguments);return window.dispatchEvent(new Event("locationchange")),e}),history.replaceState=(t=history.replaceState,function(){var e=t.apply(this,arguments);return window.dispatchEvent(new Event("locationchange")),e}),window.addEventListener("popstate",function(){window.dispatchEvent(new Event("locationchange"))}),window.addEventListener("locationchange",function(e){i()})}catch(r){vr.error(r)}var t,r})),window.addEventListener("onpagehide"in window?"pagehide":"unload",function(){$t(),o.close()}),o}nr={createInstance:_r,getUserId:Wt,setUserId:Zt,removeUserId:$t};e.createInstance=_r,e.default=nr,e.getUserId=Wt,e.removeUserId=$t,e.setUserId=Zt,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.min.js.map
