!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).HackleDevTools={})}(this,(function(t){"use strict";function e(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function n(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var r="https://devtools.hackle.io",i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t){var e=t.default;if("function"==typeof e){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}var s,a={},u=new Uint8Array(16);function c(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(u)}var f=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function p(t){return"string"==typeof t&&f.test(t)}for(var l,h,d=[],v=0;v<256;++v)d.push((v+256).toString(16).substr(1));function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(d[t[e+0]]+d[t[e+1]]+d[t[e+2]]+d[t[e+3]]+"-"+d[t[e+4]]+d[t[e+5]]+"-"+d[t[e+6]]+d[t[e+7]]+"-"+d[t[e+8]]+d[t[e+9]]+"-"+d[t[e+10]]+d[t[e+11]]+d[t[e+12]]+d[t[e+13]]+d[t[e+14]]+d[t[e+15]]).toLowerCase();if(!p(n))throw TypeError("Stringified UUID is invalid");return n}var m=0,g=0;function E(t){if(!p(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n}function w(t,e,n){function r(t,r,i,o){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof r&&(r=E(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+t.length);if(s.set(r),s.set(t,r.length),(s=n(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,i){o=o||0;for(var a=0;a<16;++a)i[o+a]=s[a];return i}return y(s)}try{r.name=t}catch(t){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function T(t){return 14+(t+64>>>9<<4)+1}function _(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function I(t,e,n,r,i,o){return _((s=_(_(e,t),_(r,o)))<<(a=i)|s>>>32-a,n);var s,a}function A(t,e,n,r,i,o,s){return I(e&n|~e&r,t,e,i,o,s)}function N(t,e,n,r,i,o,s){return I(e&r|n&~r,t,e,i,o,s)}function O(t,e,n,r,i,o,s){return I(e^n^r,t,e,i,o,s)}function R(t,e,n,r,i,o,s){return I(n^(e|~r),t,e,i,o,s)}var b=w("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){for(var e=[],n=32*t.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=t[i>>5]>>>i%32&255,s=parseInt(r.charAt(o>>>4&15)+r.charAt(15&o),16);e.push(s)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[T(e)-1]=e;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<t.length;s+=16){var a=n,u=r,c=i,f=o;n=A(n,r,i,o,t[s],7,-680876936),o=A(o,n,r,i,t[s+1],12,-389564586),i=A(i,o,n,r,t[s+2],17,606105819),r=A(r,i,o,n,t[s+3],22,-1044525330),n=A(n,r,i,o,t[s+4],7,-176418897),o=A(o,n,r,i,t[s+5],12,1200080426),i=A(i,o,n,r,t[s+6],17,-1473231341),r=A(r,i,o,n,t[s+7],22,-45705983),n=A(n,r,i,o,t[s+8],7,1770035416),o=A(o,n,r,i,t[s+9],12,-1958414417),i=A(i,o,n,r,t[s+10],17,-42063),r=A(r,i,o,n,t[s+11],22,-1990404162),n=A(n,r,i,o,t[s+12],7,1804603682),o=A(o,n,r,i,t[s+13],12,-40341101),i=A(i,o,n,r,t[s+14],17,-1502002290),n=N(n,r=A(r,i,o,n,t[s+15],22,1236535329),i,o,t[s+1],5,-165796510),o=N(o,n,r,i,t[s+6],9,-1069501632),i=N(i,o,n,r,t[s+11],14,643717713),r=N(r,i,o,n,t[s],20,-373897302),n=N(n,r,i,o,t[s+5],5,-701558691),o=N(o,n,r,i,t[s+10],9,38016083),i=N(i,o,n,r,t[s+15],14,-660478335),r=N(r,i,o,n,t[s+4],20,-405537848),n=N(n,r,i,o,t[s+9],5,568446438),o=N(o,n,r,i,t[s+14],9,-1019803690),i=N(i,o,n,r,t[s+3],14,-187363961),r=N(r,i,o,n,t[s+8],20,1163531501),n=N(n,r,i,o,t[s+13],5,-1444681467),o=N(o,n,r,i,t[s+2],9,-51403784),i=N(i,o,n,r,t[s+7],14,1735328473),n=O(n,r=N(r,i,o,n,t[s+12],20,-1926607734),i,o,t[s+5],4,-378558),o=O(o,n,r,i,t[s+8],11,-2022574463),i=O(i,o,n,r,t[s+11],16,1839030562),r=O(r,i,o,n,t[s+14],23,-35309556),n=O(n,r,i,o,t[s+1],4,-1530992060),o=O(o,n,r,i,t[s+4],11,1272893353),i=O(i,o,n,r,t[s+7],16,-155497632),r=O(r,i,o,n,t[s+10],23,-1094730640),n=O(n,r,i,o,t[s+13],4,681279174),o=O(o,n,r,i,t[s],11,-358537222),i=O(i,o,n,r,t[s+3],16,-722521979),r=O(r,i,o,n,t[s+6],23,76029189),n=O(n,r,i,o,t[s+9],4,-640364487),o=O(o,n,r,i,t[s+12],11,-421815835),i=O(i,o,n,r,t[s+15],16,530742520),n=R(n,r=O(r,i,o,n,t[s+2],23,-995338651),i,o,t[s],6,-198630844),o=R(o,n,r,i,t[s+7],10,1126891415),i=R(i,o,n,r,t[s+14],15,-1416354905),r=R(r,i,o,n,t[s+5],21,-57434055),n=R(n,r,i,o,t[s+12],6,1700485571),o=R(o,n,r,i,t[s+3],10,-1894986606),i=R(i,o,n,r,t[s+10],15,-1051523),r=R(r,i,o,n,t[s+1],21,-2054922799),n=R(n,r,i,o,t[s+8],6,1873313359),o=R(o,n,r,i,t[s+15],10,-30611744),i=R(i,o,n,r,t[s+6],15,-1560198380),r=R(r,i,o,n,t[s+13],21,1309151649),n=R(n,r,i,o,t[s+4],6,-145523070),o=R(o,n,r,i,t[s+11],10,-1120210379),i=R(i,o,n,r,t[s+2],15,718787259),r=R(r,i,o,n,t[s+9],21,-343485551),n=_(n,a),r=_(r,u),i=_(i,c),o=_(o,f)}return[n,r,i,o]}(function(t){if(0===t.length)return[];for(var e=8*t.length,n=new Uint32Array(T(e)),r=0;r<e;r+=8)n[r>>5]|=(255&t[r/8])<<r%32;return n}(t),8*t.length))})),S=b;function M(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:case 3:return e^n^r;case 2:return e&n^e&r^n&r}}function C(t,e){return t<<e|t>>>32-e}var x=w("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var r=unescape(encodeURIComponent(t));t=[];for(var i=0;i<r.length;++i)t.push(r.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,s=Math.ceil(o/16),a=new Array(s),u=0;u<s;++u){for(var c=new Uint32Array(16),f=0;f<16;++f)c[f]=t[64*u+4*f]<<24|t[64*u+4*f+1]<<16|t[64*u+4*f+2]<<8|t[64*u+4*f+3];a[u]=c}a[s-1][14]=8*(t.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(t.length-1)&4294967295;for(var p=0;p<s;++p){for(var l=new Uint32Array(80),h=0;h<16;++h)l[h]=a[p][h];for(var d=16;d<80;++d)l[d]=C(l[d-3]^l[d-8]^l[d-14]^l[d-16],1);for(var v=n[0],y=n[1],m=n[2],g=n[3],E=n[4],w=0;w<80;++w){var T=Math.floor(w/20),_=C(v,5)+M(T,y,m,g)+E+e[T]+l[w]>>>0;E=g,g=m,m=C(y,30)>>>0,y=v,v=_}n[0]=n[0]+v>>>0,n[1]=n[1]+y>>>0,n[2]=n[2]+m>>>0,n[3]=n[3]+g>>>0,n[4]=n[4]+E>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),P=x;var k,U=Object.freeze({__proto__:null,v1:function(t,e,n){var r=e&&n||0,i=e||new Array(16),o=(t=t||{}).node||l,s=void 0!==t.clockseq?t.clockseq:h;if(null==o||null==s){var a=t.random||(t.rng||c)();null==o&&(o=l=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==s&&(s=h=16383&(a[6]<<8|a[7]))}var u=void 0!==t.msecs?t.msecs:Date.now(),f=void 0!==t.nsecs?t.nsecs:g+1,p=u-m+(f-g)/1e4;if(p<0&&void 0===t.clockseq&&(s=s+1&16383),(p<0||u>m)&&void 0===t.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=u,g=f,h=s;var d=(1e4*(268435455&(u+=122192928e5))+f)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;var v=u/4294967296*1e4&268435455;i[r++]=v>>>8&255,i[r++]=255&v,i[r++]=v>>>24&15|16,i[r++]=v>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var E=0;E<6;++E)i[r+E]=o[E];return e||y(i)},v3:S,v4:function(t,e,n){var r=(t=t||{}).random||(t.rng||c)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return y(r)},v5:P,NIL:"00000000-0000-0000-0000-000000000000",version:function(t){if(!p(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)},validate:p,stringify:y,parse:E}),D=o(U);Object.defineProperty(a,"__esModule",{value:!0});var L=D,F=function(t,e){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},F(t,e)};function V(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}F(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var G=function(){return G=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},G.apply(this,arguments)};function j(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function H(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function K(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var B=function(){function t(){}return t.isNotNullOrUndefined=function(t){return null!=t},t.isNullOrUndefined=function(t){return null==t},t.requiredNotNullOrUndefined=function(t,e){if(void 0===e&&(e=function(){return"Required value is null or undefined"}),this.isNullOrUndefined(t))throw new Error(e());return t},t.fromMap=function(t){var e={};return t.forEach((function(t,n){e[n]=t})),e},t}(),z=function(){function t(){}return t.mapNotNullOrUndefined=function(t,e){for(var n=Array(),r=0,i=t;r<i.length;r++){var o=e(i[r]);B.isNotNullOrUndefined(o)&&n.push(o)}return n},t.mapOrUndefined=function(t,e){for(var n=Array(),r=0,i=t;r<i.length;r++){var o=e(i[r]);if(B.isNullOrUndefined(o))return;n.push(o)}return n},t.associateTo=function(t,e,n){for(var r=0,i=t;r<i.length;r++){var o=n(i[r]);e.set(o[0],o[1])}return e},t.associate=function(t,e){return this.associateTo(t,new Map,e)},t.associateBy=function(t,e){return this.associate(t,(function(t){return[e(t),t]}))},t.chunked=function(t,e){for(var n=[],r=t.slice();r.length;)n.push(r.splice(0,e));return n},t}(),J={DISABLE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},q=function(){function t(){}return t.setLogLevel=function(t){void 0===t&&(t=J.INFO),this.logLevel=t},t.initCounter=function(t){this.counters=z.associate(Object.keys(J),(function(e){return[e,t(e)]}))},t._log=function(t,e){var n;switch(t){case"WARN":n="orange";break;case"ERROR":n="red";break;default:n="#AAAAAA"}if(e instanceof Error)Y.log(t,n,e.message,e);else try{Y.log(t,n,e)}catch(t){}},t.increment=function(e){var n,r;null===(r=null===(n=t.counters)||void 0===n?void 0:n.get(e))||void 0===r||r.increment()},t.logLevel=J.INFO,t.log={error:function(e){t.logLevel>=J.ERROR&&(t._log("ERROR",e),t.increment("ERROR"))},warn:function(e){t.logLevel>=J.WARN&&(t._log("WARN",e),t.increment("WARN"))},info:function(e){t.logLevel>=J.INFO&&(t._log("INFO",e),t.increment("INFO"))},debug:function(e){t.logLevel>=J.DEBUG&&(t._log("DEBUG",e),t.increment("DEBUG"))}},t}(),Y=function(){function t(){}return t.log=function(t,e,n,r){try{console.log("%c[".concat(t,"] Hackle: ").concat(n),"color: ".concat(e))}catch(t){}},t}(),X="X-HACKLE-SDK-NAME",W=[0,8,16,32,64,128,256,512],$=q.log;function Z(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setRequestHeader(n,e[n])}var Q={getRequest:function(t,e){return{abort:function(){},responsePromise:new Promise((function(n,r){var i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){if(i.readyState===i.DONE){if(0===i.status)return void r(new Error("Request error"));n({statusCode:i.status,body:i.responseText})}},i.onerror=function(){r()},i.setRequestHeader("content-type","application/json"),Z(i,e),i.send()}))}},postRequest:function(t,e,n,r,i){var o=JSON.stringify(e),s=new XMLHttpRequest;s.open("POST",t),s.onreadystatechange=function(){s.readyState===s.DONE&&(s.status>=200&&s.status<400?r({statusCode:s.status}):i&&i({statusCode:s.status}))},s.setRequestHeader("content-type","application/json"),Z(s,n),s.send(o)},sendBeacon:function(t,e,n,r,i){var o=!1;if("undefined"!=typeof window&&(o=window&&window.navigator&&window.navigator.sendBeacon&&!0),o){var s=JSON.stringify(e),a=new URLSearchParams;if(a.append("sdkName",n[X]),a.append("sdkVersion",n["X-HACKLE-SDK-VERSION"]),a.append("sdkKey",n["X-HACKLE-SDK-KEY"]),a.append("data",s),!window.navigator.sendBeacon(t,a))return $.error("sendBeacon failed to queue request."),void i();r()}else $.error("Does not support sendBeacon"),i()}},tt=q.log,et=function(){function t(){}return t.isEquals=function(t,e){if(null==e)return!1;var n=Object.keys(t);return n.length===Object.keys(e).length&&n.every((function(n){return t[n]===e[n]}))},t.sanitize=function(t){var e={};if(B.isNullOrUndefined(t))return e;for(var n=0,r=Object.entries(t);n<r.length;n++){var i=r[n],o=i[0],s=i[1];if(this.isValidType(o)){var a=this.sanitizeValue(s);B.isNullOrUndefined(a)?tt.debug("Invalid identifier value. The identifier type value be a string of 512 characters or less. [".concat(o,"]")):e[o]=a}else tt.debug("Invalid identifier type. The identifier type must be a string of 128 characters or less. [".concat(o,"]"))}return e},t.isValidType=function(t){return!B.isNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_TYPE_LENGTH},t.sanitizeValue=function(t){return"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_VALUE_LENGTH?t:"number"==typeof t?t.toString():null},t.MAX_IDENTIFIER_TYPE_LENGTH=128,t.MAX_IDENTIFIER_VALUE_LENGTH=512,t}(),nt=q.log,rt=function(){function t(){}return t.sanitize=function(t){var e={};if(B.isNullOrUndefined(t))return e;for(var n=0,r=Object.entries(t);n<r.length;n++){var i=r[n],o=i[0],s=i[1];if(Object.keys(e).length>=this.MAX_PROPERTIES_COUNT){nt.debug("The number of properties cannot exceed 128. Drops excess properties. [".concat(o,", ").concat(s,"]"));break}if(this.isValidKey(o)){var a=this.sanitizeValue(o,s);B.isNullOrUndefined(a)?nt.debug("Invalid property value. The property value mus be 'string(..1024)', 'number', 'boolean', or 'array' type. [".concat(s,"]")):e[o]=a}else nt.debug("Invalid property key. The property key must be a string of 128 characters or less. [".concat(o,"]"))}return e},t.isValidProperty=function(t,e){return this.isValidKey(t)&&this.isValidValue(e)},t.isValidKey=function(t){return B.isNotNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_PROPERTY_KEY_LENGTH},t.sanitizeValue=function(t,e){var n=this;return"string"==typeof t&&t.startsWith(this.SYSTEM_PROPERTY_KEY_PREFIX)?e:this.isValidValue(e)?Array.isArray(e)?e.filter((function(t){return n.isValidElement(t)})):e:null},t.isValidValue=function(t){return!B.isNullOrUndefined(t)&&("string"==typeof t?t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t?!isNaN(t)&&isFinite(t):"boolean"==typeof t||Array.isArray(t))},t.isValidElement=function(t){return!B.isNullOrUndefined(t)&&("string"==typeof t?t.length>0&&t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t)},t.SYSTEM_PROPERTY_KEY_PREFIX="$",t.MAX_PROPERTIES_COUNT=128,t.MAX_PROPERTY_KEY_LENGTH=128,t.MAX_PROPERTY_VALUE_LENGTH=1024,t}(),it=["nanoseconds","microseconds","milliseconds","seconds","minutes","hours","days"],ot=function(){function t(){}return t.nanosToUnit=function(e,n){switch(n){case"nanoseconds":return e;case"microseconds":return e/(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C0);case"seconds":return e/(t.C3/t.C0);case"minutes":return e/(t.C4/t.C0);case"hours":return e/(t.C5/t.C0);case"days":return e/(t.C6/t.C0)}},t.microsToUnit=function(e,n){switch(n){case"nanoseconds":return e*(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C1);case"microseconds":return e;case"seconds":return e/(t.C3/t.C1);case"minutes":return e/(t.C4/t.C1);case"hours":return e/(t.C5/t.C1);case"days":return e/(t.C6/t.C1)}},t.millisToUnit=function(e,n){switch(n){case"nanoseconds":return e*(t.C2/t.C0);case"microseconds":return e*(t.C2/t.C1);case"milliseconds":return e;case"seconds":return e/(t.C3/t.C2);case"minutes":return e/(t.C4/t.C2);case"hours":return e/(t.C5/t.C2);case"days":return e/(t.C6/t.C2)}},t.secondsToUnit=function(e,n){switch(n){case"nanoseconds":return e*(t.C3/t.C0);case"microseconds":return e*(t.C3/t.C1);case"milliseconds":return e*(t.C3/t.C2);case"seconds":return e;case"minutes":return e/(t.C4/t.C3);case"hours":return e/(t.C5/t.C3);case"days":return e/(t.C6/t.C3)}},t.minutesToUnit=function(e,n){switch(n){case"nanoseconds":return e*(t.C4/t.C0);case"microseconds":return e*(t.C4/t.C1);case"milliseconds":return e*(t.C4/t.C2);case"seconds":return e*(t.C4/t.C3);case"minutes":return e;case"hours":return e/(t.C5/t.C4);case"days":return e/(t.C6/t.C4)}},t.hoursToUnit=function(e,n){switch(n){case"nanoseconds":return e*(t.C5/t.C0);case"microseconds":return e*(t.C5/t.C1);case"milliseconds":return e*(t.C5/t.C2);case"seconds":return e*(t.C5/t.C3);case"minutes":return e*(t.C5/t.C4);case"hours":return e;case"days":return e/(t.C6/t.C5)}},t.daysToUnit=function(e,n){switch(n){case"nanoseconds":return e*(t.C6/t.C0);case"microseconds":return e*(t.C6/t.C1);case"milliseconds":return e*(t.C6/t.C2);case"seconds":return e*(t.C6/t.C3);case"minutes":return e*(t.C6/t.C4);case"hours":return e*(t.C6/t.C5);case"days":return e}},t.C0=1,t.C1=1e3*t.C0,t.C2=1e3*t.C1,t.C3=1e3*t.C2,t.C4=60*t.C3,t.C5=60*t.C4,t.C6=24*t.C5,t.converter={nanoseconds:t.nanosToUnit,microseconds:t.microsToUnit,milliseconds:t.millisToUnit,seconds:t.secondsToUnit,minutes:t.minutesToUnit,hours:t.hoursToUnit,days:t.daysToUnit},t}(),st=function(){function t(){}return t.prototype.tick=function(){return 1e3*Date.now()},t.prototype.currentMillis=function(){return Date.now()},t.instance=new t,t}(),at=q.log;function ut(t,e){var n=t.find((function(t){return t===e||t.toLowerCase()===e.toLowerCase()}));return n||at.debug("Unsupported type [".concat(e,"]. Please use the latest version of sdk.")),n}function ct(t,e){if(!B.isNullOrUndefined(e)){for(var n=new Array,r=0,i=e;r<i.length;r++){var o=ut(t,i[r]);if(B.isNullOrUndefined(o))return;n.push(o)}return n}}var ft=function(){function t(t,e){this.value=t,this.reason=e}return t.of=function(e,n){return new t(e,n)},t}(),pt=function(){function t(t,e,n){this.inAppMessage=t,this.message=e,this.reason=n}return t.prototype.isShow=function(){return B.isNotNullOrUndefined(this.inAppMessage)&&B.isNotNullOrUndefined(this.message)},t.of=function(e,n,r){return new t(n,r,e)},t}(),lt=function(){function t(t,e,n){this.variation=t,this.reason=e,this.config=n}return t.of=function(e,n,r){return void 0===r&&(r=new vt),new t(e,n,r)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),ht=function(){function t(t,e,n){this.isOn=t,this.reason=e,this.config=n}return t.on=function(e,n){return void 0===n&&(n=new vt),new t(!0,e,n)},t.off=function(e,n){return void 0===n&&(n=new vt),new t(!1,e,n)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),dt=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),vt=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),yt=function(){function t(){}return t.SDK_NOT_READY="SDK_NOT_READY",t.EXCEPTION="EXCEPTION",t.INVALID_INPUT="INVALID_INPUT",t.UNSUPPORTED_PLATFORM="UNSUPPORTED_PLATFORM",t.TYPE_MISMATCH="TYPE_MISMATCH",t.EXPERIMENT_NOT_FOUND="EXPERIMENT_NOT_FOUND",t.EXPERIMENT_DRAFT="EXPERIMENT_DRAFT",t.EXPERIMENT_PAUSED="EXPERIMENT_PAUSED",t.EXPERIMENT_COMPLETED="EXPERIMENT_COMPLETED",t.OVERRIDDEN="OVERRIDDEN",t.TRAFFIC_NOT_ALLOCATED="TRAFFIC_NOT_ALLOCATED",t.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT="NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT",t.IDENTIFIER_NOT_FOUND="IDENTIFIER_NOT_FOUND",t.VARIATION_DROPPED="VARIATION_DROPPED",t.TRAFFIC_ALLOCATED="TRAFFIC_ALLOCATED",t.TRAFFIC_ALLOCATED_BY_TARGETING="TRAFFIC_ALLOCATED_BY_TARGETING",t.NOT_IN_EXPERIMENT_TARGET="NOT_IN_EXPERIMENT_TARGET",t.FEATURE_FLAG_NOT_FOUND="FEATURE_FLAG_NOT_FOUND",t.FEATURE_FLAG_INACTIVE="FEATURE_FLAG_INACTIVE",t.INDIVIDUAL_TARGET_MATCH="INDIVIDUAL_TARGET_MATCH",t.TARGET_RULE_MATCH="TARGET_RULE_MATCH",t.DEFAULT_RULE="DEFAULT_RULE",t.REMOTE_CONFIG_PARAMETER_NOT_FOUND="REMOTE_CONFIG_PARAMETER_NOT_FOUND",t.IN_APP_MESSAGE_NOT_FOUND="IN_APP_MESSAGE_NOT_FOUND",t.IN_APP_MESSAGE_DRAFT="IN_APP_MESSAGE_DRAFT",t.IN_APP_MESSAGE_PAUSED="IN_APP_MESSAGE_PAUSED",t.IN_APP_MESSAGE_HIDDEN="IN_APP_MESSAGE_HIDDEN",t.IN_APP_MESSAGE_TARGET="IN_APP_MESSAGE_TARGET",t.NOT_IN_IN_APP_MESSAGE_PERIOD="NOT_IN_IN_APP_MESSAGE_PERIOD",t.NOT_IN_IN_APP_MESSAGE_TARGET="NOT_IN_IN_APP_MESSAGE_TARGET",t}(),mt=function(){function t(t,e,n,r,i,o,s,a,u,c,f,p,l,h,d){this.id=t,this.key=e,this.type=n,this.identifierType=r,this.status=i,this.version=o,this.executionVersion=s,this.variations=a,this.userOverrides=u,this.segmentOverrides=c,this.targetAudiences=f,this.targetRules=p,this.defaultRule=l,this.containerId=h,this.winnerVariationId=d}return t.fromJson=function(e,n){var r=t.experimentStatusOrNull(n.execution.status),i=n.variations.map((function(t){return new gt(t.id,t.key,"DROPPED"===t.status,t.parameterConfigurationId)})),o=z.associate(n.execution.userOverrides,(function(t){return[t.userId,t.variationId]})),s=z.mapNotNullOrUndefined(n.execution.segmentOverrides,(function(t){return Mt.fromJson(t,Yt.IDENTIFIER)})),a=z.mapNotNullOrUndefined(n.execution.targetAudiences,(function(t){return Nt.fromJson(t,Yt.PROPERTY)})),u=z.mapNotNullOrUndefined(n.execution.targetRules,(function(t){return Mt.fromJson(t,Yt.PROPERTY)})),c=St.fromJson(n.execution.defaultRule);return r&&c&&new t(n.id,n.key,e,n.identifierType,r,n.version,n.execution.version,i,o,s,a,u,c,n.containerId,n.winnerVariationId)},t.experimentStatusOrNull=function(t){switch(t){case"READY":return"DRAFT";case"RUNNING":return"RUNNING";case"PAUSED":return"PAUSED";case"STOPPED":return"COMPLETED";default:return void at.debug("Unsupported status [".concat(t,"]"))}},t.prototype._winnerVariationOrNull=function(){if(this.winnerVariationId)return this._getVariationByIdOrNull(this.winnerVariationId)},t.prototype._getVariationByIdOrNull=function(t){return this.variations.find((function(e){return e.id===t}))},t.prototype._getVariationByKeyOrNull=function(t){return this.variations.find((function(e){return e.key===t}))},t}(),gt=function(t,e,n,r){this.id=t,this.key=e,this.isDropped=n,this.parameterConfigurationId=r},Et=function(){function t(t,e,n,r){this.id=t,this.seed=e,this.slotSize=n,this.slots=r}return t.fromJson=function(e){return new t(e.id,e.seed,e.slotSize,e.slots.map((function(t){var e=t.startInclusive,n=t.endExclusive,r=t.variationId;return new wt(e,n,r)})))},t}(),wt=function(){function t(t,e,n){this.startInclusive=t,this.endExclusive=e,this.variationId=n}return t.prototype.contains=function(t){return this.startInclusive<=t&&t<this.endExclusive},t}(),Tt=function(){function t(t,e){this.id=t,this.key=e}return t.fromJson=function(e){return new t(e.id,e.key)},t}(),_t=function(){function t(){}return t.ID="$id",t.USER="$userId",t.DEVICE="$deviceId",t.SESSION="$sessionId",t.HACKLE_DEVICE="$hackleDeviceId",t}(),It=function(){function t(){this.identifiers={}}return t.prototype.addIdentifiers=function(t){for(var e in t)this.add(e,t[e]);return this},t.prototype.add=function(t,e){var n=et.sanitizeValue(e);return et.isValidType(t)&&n?this.identifiers[t]=e:at.warn("Invalid user identifier [type=".concat(t,", value=").concat(e,"]")),this},t.prototype.build=function(){return this.identifiers},t}(),At=function(t){var e,n,r,i={};return i.id=null!==(e=et.sanitizeValue(t.id))&&void 0!==e?e:void 0,i.userId=null!==(n=et.sanitizeValue(t.userId))&&void 0!==n?n:void 0,i.deviceId=null!==(r=et.sanitizeValue(t.deviceId))&&void 0!==r?r:void 0,"object"==typeof t.properties&&(i.properties=rt.sanitize(t.properties)),"object"==typeof t.identifiers&&(i.identifiers=et.sanitize(t.identifiers)),function(t){return Boolean(t.id||t.userId||t.deviceId||t.identifiers&&Object.keys(t.identifiers).length>0)}(i)?i:null},Nt=function(){function t(t){this.conditions=t}return t.fromJson=function(e,n){return new t(z.mapNotNullOrUndefined(e.conditions,(function(t){return Ot.fromJson(t,n)})))},t.prototype.toJson=function(){return{conditions:this.conditions.map((function(t){return t.toJson()}))}},t}(),Ot=function(){function t(t,e){this.key=t,this.match=e}return t.fromJson=function(e,n){var r=Rt.fromJson(e.key);if(r&&n.supports(r.type)){var i=bt.fromJson(e.match);return i&&new t(r,i)}},t.prototype.toJson=function(){return{key:this.key.toJson(),match:this.match.toJson()}},t}(),Rt=function(){function t(t,e){this.type=t,this.name=e}return t.fromJson=function(e){var n=ut(Jt,e.type);return n&&new t(n,e.name)},t.prototype.toJson=function(){return{type:this.type,name:this.name}},t}(),bt=function(){function t(t,e,n,r){this.type=t,this.operator=e,this.valueType=n,this.values=r}return t.fromJson=function(e){var n=ut(Ht,e.type),r=ut(Bt,e.operator),i=ut(Kt,e.valueType);return n&&r&&i&&new t(n,r,i,e.values)},t.prototype.toJson=function(){return{operator:this.operator,type:this.type,valueType:this.valueType,values:this.values}},t}(),St=function(){function t(t,e,n){this.type=t,this.variationId=e,this.bucketId=n}return t.fromJson=function(e){var n=ut(zt,e.type);return n&&new t(n,e.variationId,e.bucketId)},t}(),Mt=function(){function t(t,e){this.target=t,this.action=e}return t.fromJson=function(e,n){var r=Nt.fromJson(e.target,n),i=St.fromJson(e.action);return r&&i&&new t(r,i)},t}(),Ct=function(){function t(t,e,n,r){this.id=t,this.key=e,this.type=n,this.targets=r}return t.fromJson=function(e){var n=ut(qt,e.type);return n&&new t(e.id,e.key,n,z.mapNotNullOrUndefined(e.targets,(function(t){return Nt.fromJson(t,Yt.SEGMENT)})))},t}(),xt=function(){function t(t,e,n){this.id=t,this.bucketId=e,this.groups=n}return t.fromJson=function(e){return new t(e.id,e.bucketId,e.groups.map((function(t){return Pt.fromJson(t)})))},t.prototype.getGroupOrNull=function(t){return this.groups.find((function(e){return e.id===t}))},t}(),Pt=function(){function t(t,e){this.id=t,this.experiments=e}return t.fromJson=function(e){return new t(e.id,e.experiments)},t}(),kt=function(){function t(t,e){this.id=t,this.parameters=e}return t.fromJson=function(e){return new t(e.id,z.associate(e.parameters,(function(t){return[t.key,t.value]})))},t.prototype.get=function(t,e){var n=this.parameters.get(t);return B.isNullOrUndefined(n)?e:B.isNullOrUndefined(e)||typeof n==typeof e?n:e},t}(),Ut=function(){function t(t,e,n,r,i,o){this.id=t,this.key=e,this.type=n,this.identifierType=r,this.targetRules=i,this.defaultValue=o}return t.fromJson=function(e){var n=ut(Kt,e.type),r=z.mapNotNullOrUndefined(e.targetRules,(function(t){return Dt.fromJson(t,Yt.PROPERTY)})),i=Lt.fromJson(e.defaultValue);return n&&new t(e.id,e.key,n,e.identifierType,r,i)},t}(),Dt=function(){function t(t,e,n,r,i){this.key=t,this.name=e,this.target=n,this.bucketId=r,this.value=i}return t.fromJson=function(e,n){var r=Nt.fromJson(e.target,n);return r&&new t(e.key,e.name,r,e.bucketId,Lt.fromJson(e.value))},t}(),Lt=function(){function t(t,e){this.id=t,this.rawValue=e}return t.fromJson=function(e){return new t(e.id,e.value)},t}();function Ft(t,e){return t-e}var Vt=function(){function t(t,e,n){this.coreVersion=t,this.prerelease=e,this.build=n}return t.tryParse=function(e){var n=t.regExp.exec(e);if(n){n[0];var r=n[1],i=n[2],o=void 0===i?"0":i,s=n[3],a=void 0===s?"0":s,u=n[4],c=n[5];return new t(new Gt(parseInt(r,10),parseInt(o,10),parseInt(a,10)),jt.parse(u),jt.parse(c))}},t.prototype.compareTo=function(t){return this.coreVersion.compareTo(t.coreVersion)||this.prerelease.compareTo(t.prerelease)},t.prototype.isEqualTo=function(t){return 0===this.compareTo(t)},t.prototype.isGreaterThan=function(t){return this.compareTo(t)>0},t.prototype.isGreaterThanOrEqualTo=function(t){return this.compareTo(t)>=0},t.prototype.isLessThan=function(t){return this.compareTo(t)<0},t.prototype.isLessThanOrEqualTo=function(t){return this.compareTo(t)<=0},t.regExp=/^(0|[1-9]\d*)(?:\.(0|[1-9]\d*))?(?:\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,t}(),Gt=function(){function t(t,e,n){this.major=t,this.minor=e,this.patch=n}return t.prototype.compareTo=function(t){return Ft(this.major,t.major)||Ft(this.minor,t.minor)||Ft(this.patch,t.patch)},t}(),jt=function(){function t(t){this.identifiers=t}return t.parse=function(e){return e?new t(e.split(".")):t.EMPTY},t.prototype.isEmpty=function(){return 0===this.identifiers.length},t.prototype.isNotEmpty=function(){return!this.isEmpty()},t.prototype.compareTo=function(t){return this.isEmpty()&&t.isEmpty()?0:this.isEmpty()&&t.isNotEmpty()?1:this.isNotEmpty()&&t.isEmpty()?-1:this.compareIdentifiers(t)},t.prototype.compareIdentifiers=function(e){for(var n=Math.min(this.identifiers.length,e.identifiers.length),r=0;r<n;r++){var i=t.compareIdentifiers(this.identifiers[r],e.identifiers[r]);if(0!==i)return i}return Ft(this.identifiers.length,e.identifiers.length)},t.compareIdentifiers=function(e,n){return t.numericIdentifierRegExp.test(e)&&t.numericIdentifierRegExp.test(n)?Ft(+e,+n):e===n?0:e<n?-1:1},t.EMPTY=new t([]),t.numericIdentifierRegExp=/^(0|[1-9]\d*)$/,t}(),Ht=["MATCH","NOT_MATCH"],Kt=["STRING","NUMBER","BOOLEAN","VERSION","JSON","NULL","UNKNOWN"],Bt=["IN","CONTAINS","STARTS_WITH","ENDS_WITH","GT","GTE","LT","LTE"],zt=["VARIATION","BUCKET"],Jt=["USER_ID","USER_PROPERTY","HACKLE_PROPERTY","SEGMENT","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY"],qt=["USER_ID","USER_PROPERTY"],Yt=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.supportedKeyTypes=t}return t.prototype.supports=function(t){return this.supportedKeyTypes.includes(t)},t.IDENTIFIER=new t("SEGMENT"),t.PROPERTY=new t("SEGMENT","USER_PROPERTY","HACKLE_PROPERTY","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY"),t.SEGMENT=new t("USER_ID","USER_PROPERTY","HACKLE_PROPERTY"),t}(),Xt=["ACTIVE","DRAFT","PAUSE"],Wt=["WEB","ANDROID","IOS"],$t=["IMMEDIATE","CUSTOM"],Zt=["MODAL"],Qt=["IMAGE_TEXT","IMAGE_ONLY","TEXT_ONLY"],te=["VERTICAL","HORIZONTAL"],ee=["CLICK"],ne=["CLOSE","WEB_LINK","HIDDEN","LINK_AND_CLOSE","LINK_NEW_TAB","LINK_NEW_TAB_AND_CLOSE","LINK_NEW_WINDOW","LINK_NEW_WINDOW_AND_CLOSE"],re=function(){function t(t,e,n,r,i,o,s){this.id=t,this.key=e,this.status=n,this.period=r,this.eventTrigger=i,this.targetContext=o,this.messageContext=s}return t.fromJson=function(e){var n=ut(Xt,e.status);if(!B.isNullOrUndefined(n)){var r;switch(ut($t,e.timeUnit)){case"IMMEDIATE":r=new ie;break;case"CUSTOM":if(B.isNullOrUndefined(e.startEpochTimeMillis))return;if(B.isNullOrUndefined(e.endEpochTimeMillis))return;r=new oe(e.startEpochTimeMillis,e.endEpochTimeMillis);break;default:return}var i=he.fromJson(e.messageContext);if(!B.isNullOrUndefined(i)){var o=e.eventTriggerRules.map(ae.fromJson),s=ue.fromJson(e.eventFrequencyCap);return new t(e.id,e.key,n,r,new se(o,s),pe.fromJson(e.targetContext),i)}}},t.prototype.supports=function(t){return this.messageContext.platformTypes.includes(t)},t}(),ie=function(){function t(){this.type="IMMEDIATE"}return t.prototype.within=function(t){return!0},t}(),oe=function(){function t(t,e){this.startMillisInclusive=t,this.endMillisExclusive=e,this.type="CUSTOM"}return t.prototype.within=function(t){return this.startMillisInclusive<=t&&t<this.endMillisExclusive},t}(),se=function(t,e){this.rules=t,this.frequencyCap=e},ae=function(){function t(t,e){this.eventKey=t,this.targets=e}return t.fromJson=function(e){return new t(e.eventKey,z.mapNotNullOrUndefined(e.targets,(function(t){return Nt.fromJson(t,Yt.PROPERTY)})))},t}(),ue=function(){function t(t,e){this.identifierCaps=t,this.durationCap=e}return t.fromJson=function(e){return e?new t(e.identifiers.map(ce.fromJson),fe.fromJson(e.duration)):null},t}(),ce=function(){function t(t,e){this.identifierType=t,this.count=e}return t.fromJson=function(e){return new t(e.identifierType,e.countPerIdentifier)},t}(),fe=function(){function t(t,e){this.durationMillis=t,this.count=e}return t.fromJson=function(e){if(!e)return null;var n=ut(it,e.durationUnit.timeUnit);return n?new t(ot.converter[n](e.durationUnit.amount,"milliseconds"),e.countPerDuration):null},t}(),pe=function(){function t(t,e){this.overrides=t,this.targets=e}return t.fromJson=function(e){return new t(e.overrides.map(le.fromJson),z.mapNotNullOrUndefined(e.targets,(function(t){return Nt.fromJson(t,Yt.PROPERTY)})))},t}(),le=function(){function t(t,e){this.identifierType=t,this.identifiers=e}return t.fromJson=function(e){return new t(e.identifierType,e.identifiers)},t}(),he=function(){function t(t,e,n,r){this.defaultLang=t,this.platformTypes=e,this.orientations=n,this.messages=r}return t.fromJson=function(e){var n=ct(Wt,e.platformTypes);if(!B.isNullOrUndefined(n)){var r=ct(te,e.orientations);if(!B.isNullOrUndefined(r)){var i=z.mapOrUndefined(e.messages,de.fromJson);if(!B.isNullOrUndefined(i))return new t(e.defaultLang,n,r,i)}}},t}(),de=function(){function t(t,e,n,r,i,o,s){this.lang=t,this.layout=e,this.images=n,this.text=r,this.buttons=i,this.closeButton=o,this.background=s}return t.fromJson=function(e){var n=ve.fromJson(e.layout);if(!B.isNullOrUndefined(n)){var r=z.mapOrUndefined(e.images,ye.fromJson);if(!B.isNullOrUndefined(r)){var i=z.mapOrUndefined(e.buttons,we.fromJson);if(!B.isNullOrUndefined(i)){var o=void 0;if(!B.isNotNullOrUndefined(e.closeButton)||(o=we.fromJson2(e.closeButton),!B.isNullOrUndefined(o)))return new t(e.lang,n,r,e.text?me.fromJson(e.text):void 0,i,o,new _e(e.background.color))}}}},t.prototype.toJson=function(){var t,e,n,r;return{lang:this.lang,layout:{layoutType:this.layout.layoutType,displayType:this.layout.displayType},images:this.images.map((function(t){return t.toJson()})),text:null!==(e=null===(t=this.text)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null,closeButton:null!==(r=null===(n=this.closeButton)||void 0===n?void 0:n.toCloseButtonJson())&&void 0!==r?r:null,buttons:this.buttons.map((function(t){return t.toJson()})),background:{color:this.background.color}}},t}(),ve=function(){function t(t,e){this.displayType=t,this.layoutType=e}return t.fromJson=function(e){var n=ut(Qt,e.layoutType),r=ut(Zt,e.displayType);if(!B.isNullOrUndefined(r)&&!B.isNullOrUndefined(n))return new t(r,n)},t}(),ye=function(){function t(t,e,n){this.orientation=t,this.imagePath=e,this.action=n}return t.fromJson=function(e){var n=ut(te,e.orientation);if(!B.isNullOrUndefined(n)){var r=void 0;if(!B.isNotNullOrUndefined(e.action)||(r=Ie.fromJson(e.action),!B.isNullOrUndefined(r)))return new t(n,e.imagePath,r)}},t.prototype.toJson=function(){var t,e;return{orientation:this.orientation,imagePath:this.imagePath,action:null!==(e=null===(t=this.action)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null}},t}(),me=function(){function t(t,e){this.title=t,this.body=e}return t.fromJson=function(e){return new t(ge.fromJson(e.title),ge.fromJson(e.body))},t.prototype.toJson=function(){return{title:{text:this.title.text,style:{textColor:this.title.style.color}},body:{text:this.body.text,style:{textColor:this.body.style.color}}}},t}(),ge=function(){function t(t,e){this.text=t,this.style=e}return t.fromJson=function(e){return new t(e.text,new Ee(e.style.textColor))},t}(),Ee=function(t){this.color=t},we=function(){function t(t,e,n){this.text=t,this.style=e,this.action=n}return t.fromJson=function(e){var n=Ie.fromJson(e.action);if(!B.isNullOrUndefined(n))return new t(e.text,new Te(e.style.textColor,e.style.bgColor,e.style.borderColor),n)},t.fromJson2=function(e){var n=Ie.fromJson(e.action);if(!B.isNullOrUndefined(n))return new t("✕",new Te(e.style.color,"#FFFFFF","#FFFFFF"),n)},t.prototype.toJson=function(){return{text:this.text,action:this.action.toJson(),style:{textColor:this.style.textColor,bgColor:this.style.backgroundColor,borderColor:this.style.backgroundColor}}},t.prototype.toCloseButtonJson=function(){return{action:this.action.toJson(),style:{color:this.style.textColor}}},t}(),Te=function(t,e,n){this.textColor=t,this.backgroundColor=e,this.borderColor=n},_e=function(t){this.color=t},Ie=function(){function t(t,e,n){this.behavior=t,this.type=e,this.value=n}return t.fromJson=function(e){var n,r=ut(ee,e.behavior);if(!B.isNullOrUndefined(r)){var i=ut(ne,e.type);if(!B.isNullOrUndefined(i))return new t(r,i,null!==(n=e.value)&&void 0!==n?n:void 0)}},t.prototype.toJson=function(){var t;return{behavior:this.behavior,type:this.type,value:null!==(t=this.value)&&void 0!==t?t:null}},t}(),Ae=function(){function t(t){this.name=t,this._tags={},this.name=t}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var n=t[0],r=t[1];e._tags[n]=r})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerTimer({name:this.name,tags:this._tags,type:"TIMER"})},t}(),Ne=function(){function t(t){this._clock=t,this.startTime=this._clock.tick()}return t.start=function(e){return void 0===e&&(e=t.defaultClock),new t(e)},t.prototype.stop=function(t){var e=this._clock.tick()-this.startTime;t.record(e,"microseconds")},t.defaultClock=new st,t}(),Oe=function(){function t(t){this.name=t,this._tags={}}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var n=t[0],r=t[1];e._tags[n]=r})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerCounter({name:this.name,tags:this._tags,type:"COUNTER"})},t}(),Re=function(){function t(t,e){this.valueSupplier=e,this.field=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this.valueSupplier()},enumerable:!1,configurable:!0}),t}();function be(t,e){return t.name===e.name&&et.isEquals(t.tags,e.tags)}var Se,Me=function(){function t(t){this.counterValue=0,this.id=t}return t.prototype.count=function(){return this.counterValue},t.prototype.increment=function(t){this.counterValue+=null!=t?t:1},t.prototype.measure=function(){return[new Re("count",this.count.bind(this))]},t}(),Ce=function(){function t(t){this.id=t,this.currentCounter=new Me(t)}return t.prototype.flush=function(){var t=this.currentCounter;return this.currentCounter=new Me(this.id),t},t.prototype.count=function(){return this.currentCounter.count()},t.prototype.increment=function(t){this.currentCounter.increment(t)},t.prototype.measure=function(){return[new Re("count",this.count.bind(this))]},t}(),xe=function(){function t(t){this.compareFn=t,this.data=new Map,this.compareFn=t,this.data=new Map}return t.prototype.values=function(){return Array.from(this.data.values())},t.prototype.keys=function(){return Array.from(this.data.keys())},t.prototype.get=function(t){var e=this,n=this.keys().find((function(n){return e.compareFn(n,t)}));return n?this.data.get(n):void 0},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.add=function(t,e){var n=e;return n||(n=t),this.data.set(t,n),this},t.prototype.delete=function(t){if(this.has(t)){var e=this.get(t);return this.data.delete(t),e}},t.prototype.forEach=function(t){this.data.forEach(t)},t.prototype.entries=function(){return Array.from(this.data.entries())},t}(),Pe=function(){function t(){this.id=L.v4(),this.name="MetricRegistry",this._metrics=new xe(be)}return Object.defineProperty(t.prototype,"metrics",{get:function(){return Array.from(this._metrics.values())},enumerable:!1,configurable:!0}),t.prototype.registerCounter=function(t){return this.registerMetricIfNecessary(t,this.createCounter.bind(this))},t.prototype.registerTimer=function(t){return this.registerMetricIfNecessary(t,this.createTimer.bind(this))},t.prototype.counter=function(t,e){return void 0===e&&(e={}),new Oe(t).tags(e).register(this)},t.prototype.timer=function(t,e){return void 0===e&&(e={}),new Ae(t).tags(e).register(this)},t.prototype.registerMetricIfNecessary=function(t,e){return this.getOrCreateMetric(t,e)},t.prototype.getOrCreateMetric=function(t,e){var n,r=this._metrics.get(t);return r?n=r:(n=e(t),this._metrics.add(t,n)),n},t.prototype.close=function(){},t}(),ke=function(t){function e(e){var n=t.call(this)||this;return n.pushIntervalMillis=e,n.currentIntervalId=void 0,n.pushIntervalMillis=e,n}return V(e,t),e.prototype.start=function(){var t=this;void 0===this.currentIntervalId&&(this.currentIntervalId=setInterval((function(){t.publish()}),this.pushIntervalMillis),q.log.debug("PushMetricRegistry started. Publish metrics every ".concat(this.pushIntervalMillis,"ms.")))},e.prototype.stop=function(){void 0!==this.currentIntervalId&&(clearInterval(this.currentIntervalId),this.currentIntervalId=void 0,this.publish(),q.log.debug("PushMetricRegistry stopped."))},e.prototype.close=function(){this.stop()},e}(Pe),Ue=function(){function t(t){this._count=0,this._total=0,this._max=0,this.id=t}return t.prototype.count=function(){return this._count},t.prototype.totalTime=function(t){return ot.nanosToUnit(this._total,t)},t.prototype.max=function(t){return ot.nanosToUnit(this._max,t)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.record=function(t,e){if(!(t<0)){var n=ot.converter[e](t,"nanoseconds");this._count=this.count()+1,this._total+=n,this._max=Math.max(n,this._max)}},t.prototype.measure=function(){var t=this;return[new Re("count",this.count.bind(this)),new Re("total",(function(){return t.totalTime("milliseconds")})),new Re("max",(function(){return t.max("milliseconds")})),new Re("mean",(function(){return t.mean("milliseconds")}))]},t}(),De=function(){function t(t){this.id=t,this.currentTimer=new Ue(t)}return t.prototype.flush=function(){var t=this.currentTimer;return this.currentTimer=new Ue(this.id),t},t.prototype.count=function(){return this.currentTimer.count()},t.prototype.totalTime=function(t){return this.currentTimer.totalTime(t)},t.prototype.max=function(t){return this.currentTimer.max(t)},t.prototype.record=function(t,e){this.currentTimer.record(t,e)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.measure=function(){var t=this;return[new Re("count",this.count.bind(this)),new Re("total",(function(){return t.totalTime("milliseconds")})),new Re("max",(function(){return t.max("milliseconds")})),new Re("mean",(function(){return t.mean("milliseconds")}))]},t}(),Le=function(t){function e(e){return t.call(this,e)||this}return V(e,t),e.prototype.createCounter=function(t){return new Ce(t)},e.prototype.createTimer=function(t){return new De(t)},e.prototype.publish=function(){var t=this.metrics.reduce((function(t,e){return function(t){return void 0!==t.flush&&"function"==typeof t.flush}(e)?t.concat(e.flush()):t}),[]);this.flushMetrics(t)},e.prototype.close=function(){t.prototype.close.call(this)},e}(ke),Fe=function(){function t(t){this.id=t}return t.prototype.count=function(){return 0},t.prototype.increment=function(t){},t.prototype.measure=function(){return[new Re("count",this.count.bind(this))]},t}(),Ve=function(){function t(t){this._counters=new xe((function(t,e){return t.id===e.id})),this.id=t,this.noopCounter=new Fe(t)}return Object.defineProperty(t.prototype,"counters",{get:function(){return Array.from(this._counters.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._counters.add(t,t.registerCounter(this.id))},t.prototype.count=function(){return(this.counters[0]||this.noopCounter).count()},t.prototype.increment=function(t){this.counters.forEach((function(e){e.increment(t)}))},t.prototype.measure=function(){return[new Re("count",this.count.bind(this))]},t}(),Ge=function(){function t(t){this.id=t}return t.prototype.measure=function(){var t=this;return[new Re("count",this.count.bind(this)),new Re("total",(function(){return t.totalTime("milliseconds")})),new Re("max",(function(){return t.max("milliseconds")})),new Re("mean",(function(){return t.mean("milliseconds")}))]},t.prototype.count=function(){return 0},t.prototype.totalTime=function(t){return 0},t.prototype.max=function(t){return 0},t.prototype.mean=function(t){return 0},t.prototype.record=function(t,e){},t}(),je=function(){function t(t){this._timers=new xe((function(t,e){return t.id===e.id})),this.id=t,this.noopTimer=new Ge(t)}return Object.defineProperty(t.prototype,"firstTimer",{get:function(){return this.timers[0]||this.noopTimer},enumerable:!1,configurable:!0}),t.prototype.totalTime=function(t){return this.firstTimer.totalTime(t)},t.prototype.max=function(t){return this.firstTimer.max(t)},t.prototype.mean=function(t){return this.firstTimer.mean(t)},t.prototype.record=function(t,e){this.timers.forEach((function(n){n.record(t,e)}))},Object.defineProperty(t.prototype,"timers",{get:function(){return Array.from(this._timers.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._timers.add(t,t.registerTimer(this.id))},t.prototype.count=function(){return this.firstTimer.count()},t.prototype.measure=function(){var t=this;return[new Re("count",this.count.bind(this)),new Re("total",(function(){return t.totalTime("milliseconds")})),new Re("max",(function(){return t.max("milliseconds")})),new Re("mean",(function(){return t.mean("milliseconds")}))]},t}(),He=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registries=new xe((function(t,e){return t.id===e.id})),e}return V(e,t),e.prototype.createCounter=function(t){var e=new Ve(t);return this.addRegistry(e),e},e.prototype.createTimer=function(t){var e=new je(t);return this.addRegistry(e),e},e.prototype.addRegistry=function(t){this.registries.forEach((function(e){return t.add(e)}))},e.prototype.add=function(t){t instanceof e||this.registries.has(t)||(this.registries.add(t),this.metrics.forEach((function(e){(function(t){return void 0!==t.add&&"function"==typeof t.add})(e)&&e.add(t)})))},e.prototype.close=function(){this.registries.forEach((function(t){t.close()}))},e}(Pe),Ke=function(){function t(){}return t.counter=function(e,n){return t.globalRegistry.counter(e,n)},t.timer=function(e,n){return t.globalRegistry.timer(e,n)},t.addRegistry=function(e){t.globalRegistry.add(e),q.log.debug("MetricRegistry added ".concat(e.name))},t.globalRegistry=new He,t}(),Be=function(t){function e(e,n,r,i,o){var s=t.call(this,n)||this;return s.monitoringBaseUrl=e,s.httpClient=r,s.httpHeader=i,s.useBeacon=o,s.monitoringEndPoint="".concat(s.monitoringBaseUrl,"/metrics"),s.shouldUseBeacon=!1,s.start(),s.monitoringBaseUrl=e,s}return V(e,t),e.prototype.flushMetrics=function(t){var e=this;z.chunked(t.filter(this.isDispatchTarget.bind(this)),100).forEach((function(t){e.dispatch(t)}))},e.prototype.isDispatchTarget=function(t){return!(!function(t){return"COUNTER"===t.id.type}(t)&&!function(t){return"TIMER"===t.id.type}(t))&&t.count()>0},e.prototype.dispatch=function(t){this.useBeacon&&this.shouldUseBeacon?this.httpClient.sendBeacon(this.monitoringEndPoint,this.batch(t),this.httpHeader,(function(){q.log.debug("Beacon called.")})):this.httpClient.postRequest(this.monitoringEndPoint,this.batch(t),this.httpHeader,(function(){}),(function(){q.log.debug("Failed to flushing metrics.")}))},e.prototype.batch=function(t){return{metrics:t.map((function(t){return{name:t.id.name,type:t.id.type,tags:t.id.tags,measurements:B.fromMap(z.associate(t.measure(),(function(t){return[t.field,t.value]})))}}))}},e.prototype.createCounter=function(t){return new Ce(t)},e.prototype.createTimer=function(t){return new De(t)},e.prototype.close=function(){this.shouldUseBeacon=!0,t.prototype.close.call(this)},e}(Le),ze=function(){function t(){}return t.experiment=function(t,e,n){var r=Ke.timer("experiment.decision",{key:String(e),variation:n.variation,reason:String(n.reason)});t.stop(r)},t.featureFlag=function(t,e,n){var r=Ke.timer("feature.flag.decision",{key:String(e),on:String(n.isOn),reason:String(n.reason)});t.stop(r)},t.remoteConfig=function(t,e,n){var r=Ke.timer("remote.config.decision",{key:String(e),reason:String(n.reason)});t.stop(r)},t.inAppMessage=function(t,e,n){var r=Ke.timer("iam.decision",{key:String(e),show:String(n.isShow()),reason:String(n.reason)});t.stop(r)},t}(),Je=function(){function t(){}return t.record=function(t,e,n){var r=Ke.timer("api.call",{operation:t,success:String(n)});e.stop(r)},t}(),qe=function(){function t(){}return t.decide=function(t,e,n,r){if(B.isNullOrUndefined(n))return this.decision(t,e,"NULL",n,r);switch(typeof n){case"string":return this.decision(t,e,"STRING",n,r);case"number":return this.decision(t,e,"NUMBER",n,r);case"boolean":return this.decision(t,e,"BOOLEAN",n,r);default:return this.decision(t,e,"UNKNOWN",n,r)}},t.decision=function(t,e,n,r,i){return B.isNullOrUndefined(e)?ft.of(r,yt.INVALID_INPUT):t.remoteConfig(e,i,n,r)},t}(),Ye=q.log,Xe=function(){function t(t,e,n,r){this.core=t,this.userManager=e,this.hackleUserResolver=n,this.user=r}return t.prototype.get=function(t,e){var n,r=Ne.start();try{n=this.decide(t,e)}catch(r){Ye.error("Unexpected exception while deciding remote config parameter[".concat(t,"]. Returning default value. : ").concat(r)),n=ft.of(e,yt.EXCEPTION)}return ze.remoteConfig(r,t,n),n.value},t.prototype.decide=function(t,e){var n=this.userManager.resolveCurrentOrNull(this.user);if(!n)return Ye.warn("invalid user"),ft.of(e,yt.INVALID_INPUT);var r=this.hackleUserResolver.resolve(n);return qe.decide(this.core,t,e,r)},t}(),We=function(){function t(){this._properties=new Map,this.MAX_PROPERTIES_COUNT=128,this.MAX_PROPERTY_KEY_LENGTH=128}return t.prototype.contains=function(t){return this._properties.has(t)},t.prototype.remove=function(t){var e=this;return t instanceof Map&&t.forEach((function(t,n){e.remove(n)})),"string"==typeof t&&this._properties.delete(t),this},t.prototype.compute=function(t,e){var n=this._properties.get(t),r=e(n);null!==r?this.add(t,r):(null!==n||this.contains(t))&&this.remove(t)},t.prototype.add=function(t,e,n){if(void 0===n&&(n=!1),n&&this.contains(t))return this;if(this._properties.size>=this.MAX_PROPERTIES_COUNT)return this;if("string"==typeof t&&t.length>this.MAX_PROPERTY_KEY_LENGTH)return this;var r=rt.sanitizeValue(t,e);return r?(this._properties.set(t,r),this):this},t.prototype.addProperties=function(t,e){var n=this;return void 0===e&&(e=!1),t.forEach((function(t,r){n.add(r,t,e)})),this},t.prototype.build=function(){return this._properties},t}();!function(t){t.SET="$set",t.SET_ONCE="$setOnce",t.UNSET="$unset",t.INCREMENT="$increment",t.APPEND="$append",t.APPEND_ONCE="$appendOnce",t.PREPEND="$prepend",t.PREPEND_ONCE="$prependOnce",t.REMOVE="$remove",t.CLEAR_ALL="$clearAll"}(Se||(Se={}));var $e=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new We).addProperties(t).addProperties(e).build()},t}(),Ze=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new We).addProperties(t).addProperties(e,!0).build()},t}(),Qe=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?new Map:0===e.size?t:(new We).addProperties(t).remove(e).build()},t}(),tn=function(){function t(){}return t.prototype.operate=function(t,e){var n=this;if(0===e.size)return t;var r=new We;return r.addProperties(t),e.forEach((function(t,e){r.compute(e,(function(e){return n.increment(e,t)}))})),r.build()},t.prototype.increment=function(t,e){return"number"!=typeof e?t:"number"!=typeof t?null==t?e:t:t+e},t}(),en=function(){function t(){}return t.prototype.operate=function(t,e){var n=this;if(0===e.size)return t;var r=new We;return r.addProperties(t),e.forEach((function(t,e){r.compute(e,(function(e){return n.compute(e,t)}))})),r.build()},t.prototype.compute=function(t,e){var n=this.toArray(t),r=this.toArray(e);return this.operateArray(n,r)},t.prototype.toArray=function(t){return null==t?[]:Array.isArray(t)?t:[t]},t.prototype.contains=function(t,e){return t.includes(e)},t.prototype.prepend=function(t,e,n){return void 0===n&&(n=!1),n&&this.contains(e,t)?e:K([t],e,!0)},t.prototype.append=function(t,e,n){return void 0===n&&(n=!1),n&&this.contains(t,e)?t:K(K([],t,!0),[e],!1)},t}(),nn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.operateArray=function(t,e){var n=this;return e.reduce((function(t,e){return n.append.bind(n)(t,e)}),t)},e}(en),rn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.appendOnce.bind(this),t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e}(en),on=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.operateArray=function(t,e){var n=this;return e.reduceRight((function(t,e){return n.prepend.bind(n)(e,t)}),t)},e}(en),sn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.operateArray=function(t,e){var n=this;return e.reduce(this.appendOnce.bind(this),[]).reduceRight((function(t,e){return n.prependOnce.bind(n)(e,t)}),t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e.prototype.prependOnce=function(t,e){return this.prepend(t,e,!0)},e}(en),an=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.remove.bind(this),t)},e.prototype.remove=function(t,e){return t.filter((function(t){return t!==e}))},e}(en),un=function(){function t(){}return t.prototype.operate=function(t,e){return new Map},t}(),cn=function(){function t(){}return t.get=function(t){switch(t){case Se.SET:return new $e;case Se.SET_ONCE:return new Ze;case Se.UNSET:return new Qe;case Se.INCREMENT:return new tn;case Se.APPEND:return new nn;case Se.APPEND_ONCE:return new rn;case Se.PREPEND:return new on;case Se.PREPEND_ONCE:return new sn;case Se.CLEAR_ALL:return new un;case Se.REMOVE:return new an}},t}(),fn=function(){function t(){this.operations=new Map}return t.prototype.set=function(t,e){return this.add(Se.SET,t,e)},t.prototype.setOnce=function(t,e){return this.add(Se.SET_ONCE,t,e)},t.prototype.unset=function(t){return this.add(Se.UNSET,t,"-")},t.prototype.increment=function(t,e){return this.add(Se.INCREMENT,t,e)},t.prototype.append=function(t,e){return this.add(Se.APPEND,t,e)},t.prototype.appendOnce=function(t,e){return this.add(Se.APPEND_ONCE,t,e)},t.prototype.prepend=function(t,e){return this.add(Se.PREPEND,t,e)},t.prototype.prependOnce=function(t,e){return this.add(Se.PREPEND_ONCE,t,e)},t.prototype.remove=function(t,e){return this.add(Se.REMOVE,t,e)},t.prototype.clearAll=function(){return this.add(Se.CLEAR_ALL,"clearAll","-")},t.prototype.build=function(){var t=Array.from(this.operations.entries()).map((function(t){return[t[0],t[1].build()]}));return new pn(new Map(t))},t.prototype.containsKey=function(t){return Array.from(this.operations.entries()).some((function(e){return e[0],e[1].contains(t)}))},t.prototype.add=function(t,e,n){if(this.containsKey(e))return this;this.operations.has(t)||this.operations.set(t,new We);var r=this.operations.get(t);return null==r||r.add(e,n),this},t}(),pn=function(){function t(t){this.operations=null!=t?t:new Map}return t.prototype.operate=function(t){var e=t;return this.operations.forEach((function(t,n){e=cn.get(n).operate(e,t)})),e},t.prototype.toEvent=function(){var t={key:"$properties"};return this.operations.forEach((function(e,n){var r,i;t.properties=G(G({},t.properties),((r={})[n]=G(G({},null===(i=t.properties)||void 0===i?void 0:i[n]),rt.sanitize(B.fromMap(e))),r))})),t},t}(),ln=q.log,hn=function(){function t(t,e,n,r,i){this.core=t,this.hackleUserResolver=e,this.sessionManager=n,this.userManager=r,this.devTools=i}return t.prototype.getSessionId=function(){return this.sessionManager.sessionId},t.prototype.getUser=function(){return this.userManager.currentUser},t.prototype.setUser=function(t){try{var e=At(t);if(!e)return void ln.warn("invalid user");this.userManager.setUser(e)}catch(t){ln.error("Unexpected exception while set user: ".concat(t))}},t.prototype.setUserId=function(t){try{void 0===t&&this.userManager.setUserId(void 0);var e=et.sanitizeValue(t);if(!e)return void ln.warn("Invalid userId. [userId=".concat(t,"]"));this.userManager.setUserId(e)}catch(t){ln.error("Unexpected exception while set userId: ".concat(t))}},t.prototype.setDeviceId=function(t){try{if(!et.sanitizeValue(t))return void ln.warn("Invalid deviceId. [deviceId=".concat(t,"]"));this.userManager.setDeviceId(t)}catch(t){ln.error("Unexpected exception while set deviceId: ".concat(t))}},t.prototype.setUserProperty=function(t,e){var n=(new fn).set(t,e).build();this.updateUserProperties(n)},t.prototype.setUserProperties=function(t){try{var e=rt.sanitize(t),n=new fn;Object.entries(e).forEach((function(t){var e=t[0],r=t[1];n.set(e,r)})),this.updateUserProperties(n.build())}catch(t){ln.error("Unexpected exception while set userProperties: ".concat(t))}},t.prototype.updateUserProperties=function(t){try{var e=t.toEvent();this.track(e),this.userManager.updateUserProperties(t)}catch(t){ln.error("Unexpected exception while update userProperties: ".concat(t))}},t.prototype.resetUser=function(){try{this.userManager.resetUser();var t=(new fn).clearAll().build();this.track(t.toEvent())}catch(t){ln.error("Unexpected exception while reset user: ".concat(t))}},t.prototype.variation=function(t,e,n){return this.variationDetail(t,e,n).variation},t.prototype.variationDetail=function(t,e,n){var r=n||"A",i=Ne.start(),o=function(n){try{var i=n.userManager.resolveCurrentOrNull(e);if(!i)return ln.warn("invalid user"),lt.of(r,yt.INVALID_INPUT);var o=n.hackleUserResolver.resolve(i);return n.core.experiment(t,o,r)}catch(e){return ln.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(r,"] : ").concat(e)),lt.of(r,yt.EXCEPTION)}}(this);return ze.experiment(i,t,o),o},t.prototype.isFeatureOn=function(t,e){return this.featureFlagDetail(t,e).isOn},t.prototype.featureFlagDetail=function(t,e){var n=Ne.start(),r=function(n){try{var r=n.userManager.resolveCurrentOrNull(e);if(!r)return ln.warn("invalid user"),ht.off(yt.INVALID_INPUT);var i=n.hackleUserResolver.resolve(r);return n.core.featureFlag(t,i)}catch(e){return ln.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),ht.off(yt.EXCEPTION)}}(this);return ze.featureFlag(n,t,r),r},t.prototype.track=function(t,e){try{ln.debug("track event : ".concat(JSON.stringify(t)));var n=this._convertEvent(t),r=this.userManager.resolveCurrentOrNull(e);if(!r)return void ln.warn("invalid user");var i=this.hackleUserResolver.resolve(r);this.core.track(n,i)}catch(t){ln.error("Unexpected exception while tracking event: ".concat(t))}},t.prototype.trackPageView=function(t){ln.debug("tracking page view");var e=this.hackleUserResolver.resolve(this.userManager.currentUser);this.core.track({key:"$page_view"},e)},t.prototype.remoteConfig=function(t){return new Xe(this.core,this.userManager,this.hackleUserResolver,t)},t.prototype.onReady=function(t,e){void 0===e&&(e=3e3),this.core.onReady(t,e)},t.prototype.onInitialized=function(t){return this.core.onInitialized({timeout:null==t?void 0:t.timeout})},t.prototype.close=function(){ln.debug("Hackle Client is closing"),this.core.close()},t.prototype._convertEvent=function(t){return"string"==typeof t?{key:t}:t},t.prototype.showUserExplorer=function(){var t;(null===(t=this.devTools)||void 0===t?void 0:t.userExplorer)?(ln.debug("UserExplorer opened."),Ke.counter("user.explorer.show",{}).increment(),this.devTools.manager.userExplorer(this.devTools.userExplorer)):ln.error("UserExplorer is not provided")},t.prototype.hideUserExplorer=function(){this.devTools?this.devTools.manager.close():ln.warn("There is no active HackleDevtools.")},t}(),dn=function(){function t(t,e,n){void 0===n&&(n=L.v4()),this.timestamp=t,this.user=e,this.insertId=n}return t.exposure=function(t,e,n,r){return new vn(r,t,e.experiment,e.variationId,e.variationKey,e.reason,n)},t.track=function(t,e,n,r){return new yn(r,n,t,e)},t.remoteConfig=function(t,e,n,r){return new mn(r,t,e.parameter,e.valueId,e.reason,n)},t.isExposure=function(t){return void 0!==t.experiment},t.isTrack=function(t){return void 0!==t.eventType},t.isRemoteConfig=function(t){return void 0!==t.parameter},t.isExposureDto=function(t){return"experimentId"in t&&void 0!==t.experimentId},t.isTrackDto=function(t){return"eventTypeId"in t&&void 0!==t.eventTypeId},t.isRemoteConfigDto=function(t){return"parameterId"in t&&void 0!==t.parameterId},t.prototype.toDto=function(){return{insertId:this.insertId,timestamp:this.timestamp,userId:this.user.identifiers[_t.ID],identifiers:this.user.identifiers,userProperties:rt.sanitize(this.user.properties),hackleProperties:rt.sanitize(this.user.hackleProperties)}},t}(),vn=function(t){function e(e,n,r,i,o,s,a,u){var c=t.call(this,e,n,u)||this;return c.experiment=r,c.variationId=i,c.variationKey=o,c.decisionReason=s,c.properties=a,c}return V(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.experiment,this.variationId,this.variationKey,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return G(G({},t.prototype.toDto.call(this)),{experimentId:this.experiment.id,experimentKey:this.experiment.key,experimentType:this.experiment.type,experimentVersion:this.experiment.version,variationId:this.variationId,variationKey:this.variationKey,decisionReason:this.decisionReason.toString(),properties:this.properties})},e}(dn),yn=function(t){function e(e,n,r,i,o){var s=t.call(this,e,n,o)||this;return s.eventType=r,s.event=i,s}return V(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.eventType,this.event,this.insertId)},e.prototype.toDto=function(){return G(G({},t.prototype.toDto.call(this)),{eventTypeId:this.eventType.id,eventTypeKey:this.eventType.key,value:this.event.value||0,properties:rt.sanitize(this.event.properties)})},e}(dn),mn=function(t){function e(e,n,r,i,o,s,a){var u=t.call(this,e,n,a)||this;return u.parameter=r,u.valueId=i,u.decisionReason=o,u.properties=s,u}return V(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.parameter,this.valueId,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return G(G({},t.prototype.toDto.call(this)),{parameterId:this.parameter.id,parameterKey:this.parameter.key,parameterType:this.parameter.type,valueId:this.valueId,decisionReason:this.decisionReason.toString(),properties:rt.sanitize(this.properties)})},e}(dn);function gn(t){var e=new Array,n=new Array,r=new Array;return t.forEach((function(t){t instanceof dn?dn.isExposure(t)?e.push(t.toDto()):dn.isTrack(t)?n.push(t.toDto()):dn.isRemoteConfig(t)&&r.push(t.toDto()):dn.isExposureDto(t)?e.push(t):dn.isTrackDto(t)?n.push(t):dn.isRemoteConfigDto(t)&&r.push(t)})),{exposureEvents:e,trackEvents:n,remoteConfigEvents:r}}var En=function(){function t(t,e,n){this.sdkKey=t,this.httpRequest=e,this.headers=n.headers,this.dispatchUrl=n.dispatchUrl,this.beaconDispatchUrl=n.beaconDispatchUrl||"",this.useBeacon=n.useBeacon||!1}return t.prototype.dispatch=function(t,e,n){var r={};r["X-HACKLE-SDK-KEY"]=this.sdkKey,r[X]=this.headers[X],r["X-HACKLE-SDK-VERSION"]=this.headers["X-HACKLE-SDK-VERSION"],r["X-HACKLE-SDK-TIME"]=(new Date).getTime().toString();var i=gn(t),o=Ne.start();this.httpRequest.postRequest(this.dispatchUrl,i,r,(function(t){e(t),Je.record("post.events",o,!0)}),(function(t){null==n||n(t),Je.record("post.events",o,!1)}))},t.prototype.dispatchXhrOrBeacon=function(t,e,n){if(this.useBeacon){var r={};r["X-HACKLE-SDK-KEY"]=this.sdkKey,r[X]=this.headers[X],r["X-HACKLE-SDK-VERSION"]=this.headers["X-HACKLE-SDK-VERSION"],r["X-HACKLE-SDK-TIME"]=(new Date).getTime().toString();var i=gn(t),o=Ne.start();this.httpRequest.sendBeacon(this.beaconDispatchUrl,i,r,(function(t){e(t),Je.record("post.events",o,!0)}),(function(t){null==n||n(t),Je.record("post.events",o,!1)}))}else this.dispatch(t,e,n)},t}(),wn=function(){function t(t,e,n,r,i,o,s,a,u){this.experiments=z.associateBy(t,(function(t){return t.key})),this.featureFlags=z.associateBy(e,(function(t){return t.key})),this.buckets=z.associateBy(n,(function(t){return t.id})),this.eventTypes=z.associateBy(r,(function(t){return t.key})),this.segments=z.associateBy(i,(function(t){return t.key})),this.containers=z.associateBy(o,(function(t){return t.id})),this.parameterConfigurations=z.associateBy(s,(function(t){return t.id})),this.remoteConfigParameters=z.associateBy(a,(function(t){return t.key})),this.inAppMessages=z.associateBy(u,(function(t){return t.key}))}return t.prototype.getExperiments=function(){return Array.from(this.experiments.values())},t.prototype.getFeatureFlags=function(){return Array.from(this.featureFlags.values())},t.prototype.getInAppMessages=function(){return Array.from(this.inAppMessages.values())},t.prototype.getExperimentOrNull=function(t){return this.experiments.get(t)},t.prototype.getFeatureFlagOrNull=function(t){return this.featureFlags.get(t)},t.prototype.getBucketOrNull=function(t){return this.buckets.get(t)},t.prototype.getEventTypeOrNull=function(t){return this.eventTypes.get(t)},t.prototype.getSegmentOrNull=function(t){return this.segments.get(t)},t.prototype.getContainerOrNull=function(t){return this.containers.get(t)},t.prototype.getParameterConfigurationOrNull=function(t){return this.parameterConfigurations.get(t)},t.prototype.getRemoteConfigParameterOrNull=function(t){return this.remoteConfigParameters.get(t)},t.prototype.getInAppMessageOrNull=function(t){return this.inAppMessages.get(t)},t.from=function(e){return new t(z.mapNotNullOrUndefined(e.experiments,(function(t){return mt.fromJson("AB_TEST",t)})),z.mapNotNullOrUndefined(e.featureFlags,(function(t){return mt.fromJson("FEATURE_FLAG",t)})),e.buckets.map(Et.fromJson),e.events.map(Tt.fromJson),z.mapNotNullOrUndefined(e.segments,Ct.fromJson),e.containers.map(xt.fromJson),e.parameterConfigurations.map(kt.fromJson),z.mapNotNullOrUndefined(e.remoteConfigParameters,Ut.fromJson),z.mapNotNullOrUndefined(e.inAppMessages,re.fromJson))},t}(),Tn=function(){function t(t,e,n){var r=this;this.workspace=null,this.sdkKey=t,this.httpRequest=e,this.isStarted=!1,this.updateInterval=n.updateInterval,this.fetchUrl=n.fetchUrl,this.headers=n.headers,this.readyPromiseResolver=function(){},this.readyPromiseRejecter=function(){},this.readyPromise=new Promise((function(t,e){r.readyPromiseResolver=t,r.readyPromiseRejecter=e})),this.currentTimeout=null,this.errorRetryController=new _n,this.currentRequest=null,this.syncOnCurrentRequestComplete=!1,this.isReadyPromiseSettled=!1}return t.prototype.onReady=function(){return this.readyPromise},t.prototype.start=function(){this.isStarted||(this.isStarted=!0,this.errorRetryController.reset(),this.fetch())},t.prototype.stop=function(){return this.isStarted=!1,this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),Promise.resolve()},t.prototype.get=function(){return this.workspace},t.prototype.scheduleNextUpdate=function(){var t=this,e=this.errorRetryController.getDelay(),n=Math.max(e,this.updateInterval);this.currentTimeout=setTimeout((function(){t.currentRequest?t.syncOnCurrentRequestComplete=!0:t.fetch()}),n)},t.prototype.fetch=function(){var t,e,n=this,r=((t={})["X-HACKLE-SDK-KEY"]=this.sdkKey,t["X-HACKLE-SDK-TIME"]=(new Date).getTime().toString(),t[X]=this.headers[X],t["X-HACKLE-SDK-VERSION"]=this.headers["X-HACKLE-SDK-VERSION"],t),i=Ne.start();this.currentRequest=this.httpRequest.getRequest(this.fetchUrl,r);var o=function(t){var e=t.isSuccess;Je.record("get.workspace",i,e)},s=function(){n.onRequestComplete()};null===(e=this.currentRequest)||void 0===e||e.responsePromise.then((function(t){n.onRequestResolved(t,o)}),(function(t){n.onRequestRejected(t,o)})).then(s,s),this.updateInterval>0&&this.scheduleNextUpdate()},t.prototype.onRequestComplete=function(){this.isStarted&&(this.currentRequest=null,this.syncOnCurrentRequestComplete&&this.fetch(),this.syncOnCurrentRequestComplete=!1)},t.prototype.onRequestResolved=function(t,e){if(this.isStarted){if(void 0!==t.statusCode&&t.statusCode>=200&&t.statusCode<400)this.errorRetryController.reset(),e({isSuccess:!0});else{if(e({isSuccess:!1}),401===t.statusCode||403===t.statusCode)return void this.readyPromiseRejecter(new Error("Invalid key provided."));this.errorRetryController.countError()}if(t.body){var n=JSON.parse(t.body);this.workspace=wn.from(n),this.readyPromiseResolver()}}},t.prototype.onRequestRejected=function(t,e){this.isStarted&&(e({isSuccess:!1}),this.errorRetryController.countError(),console.error("Error fetching data",t))},t.prototype.close=function(){this.stop()},t}(),_n=function(){function t(){this.errorCount=0}return t.prototype.getDelay=function(){return 0===this.errorCount?0:1e3*W[Math.min(W.length-1,this.errorCount)]+Math.round(1e3*Math.random())},t.prototype.countError=function(){this.errorCount<W.length-1&&this.errorCount++},t.prototype.reset=function(){this.errorCount=0},t}(),In="model",An="name",Nn="type",On="vendor",Rn="version",bn="mobile",Sn="tablet",Mn=function(){function t(){}return t.parse=function(e){return{browser:t.getBrowser(e),cpu:t.getCPU(e),device:t.getDevice(e),engine:t.getEngine(e),os:t.getOS(e)}},t.getBrowser=function(e){var n={name:void 0,version:void 0,major:void 0};return t.mapper.rgx.call(n,e,t.regexes.browser),n.major=t.util.major(n.version),n},t.getCPU=function(e){var n={architecture:void 0};return t.mapper.rgx.call(n,e,t.regexes.cpu),n},t.getDevice=function(e){var n={model:void 0,type:void 0,vendor:void 0};return t.mapper.rgx.call(n,e,t.regexes.device),n},t.getEngine=function(e){var n={name:void 0,version:void 0};return t.mapper.rgx.call(n,e,t.regexes.os),n},t.getOS=function(e){var n={name:void 0,version:void 0};return t.mapper.rgx.call(n,e,t.regexes.os),n},t.util={extend:function(t,e){var n={};for(var r in t)e[r]&&e[r].length%2==0?n[r]=e[r].concat(t[r]):n[r]=t[r];return n},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},t.mapper={rgx:function(t,e){for(var n,r,i,o,s,a,u=0;u<e.length&&!s;){var c=e[u],f=e[u+1];for(n=r=0;n<c.length&&!s;)if(s=c[n++].exec(t))for(i=0;i<f.length;i++)a=s[++r],"object"==typeof(o=f[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,a):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=a?a.replace(o[1],o[2]):void 0:this[o[0]]=a?o[1].call(this,a,o[2]):void 0:4==o.length&&(this[o[0]]=a?o[3].call(this,a.replace(o[1],o[2])):void 0):this[o]=a||void 0;u+=2}},str:function(e,n){for(var r in n)if("object"==typeof n[r]&&n[r].length>0){for(var i=0;i<n[r].length;i++)if(t.util.has(n[r][i],e))return"?"===r?void 0:r}else if(t.util.has(n[r],e))return"?"===r?void 0:r;return e}},t.maps={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},t.regexes={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[An,Rn],[/(opios)[\/\s]+([\w\.]+)/i],[[An,"Opera Mini"],Rn],[/\s(opr)\/([\w\.]+)/i],[[An,"Opera"],Rn],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[An,Rn],[/(konqueror)\/([\w\.]+)/i],[[An,"Konqueror"],Rn],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[An,"IE"],Rn],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[An,"Edge"],Rn],[/(yabrowser)\/([\w\.]+)/i],[[An,"Yandex"],Rn],[/(Avast)\/([\w\.]+)/i],[[An,"Avast Secure Browser"],Rn],[/(AVG)\/([\w\.]+)/i],[[An,"AVG Secure Browser"],Rn],[/(puffin)\/([\w\.]+)/i],[[An,"Puffin"],Rn],[/(focus)\/([\w\.]+)/i],[[An,"Firefox Focus"],Rn],[/(opt)\/([\w\.]+)/i],[[An,"Opera Touch"],Rn],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[An,"UCBrowser"],Rn],[/(comodo_dragon)\/([\w\.]+)/i],[[An,/_/g," "],Rn],[/(windowswechat qbcore)\/([\w\.]+)/i],[[An,"WeChat(Win) Desktop"],Rn],[/(micromessenger)\/([\w\.]+)/i],[[An,"WeChat"],Rn],[/(brave)\/([\w\.]+)/i],[[An,"Brave"],Rn],[/(whale)\/([\w\.]+)/i],[[An,"Whale"],Rn],[/(qqbrowserlite)\/([\w\.]+)/i],[An,Rn],[/(QQ)\/([\d\.]+)/i],[An,Rn],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[An,Rn],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[An,Rn],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[An,Rn],[/(MetaSr)[\/\s]?([\w\.]+)/i],[An],[/(LBBROWSER)/i],[An],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[Rn,[An,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[Rn,[An,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[An,Rn],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[Rn,[An,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[An,/(.+)/,"$1 WebView"],Rn],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[An,/(.+(?:g|us))(.+)/,"$1 $2"],Rn],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[An,"Chrome Mobile"],Rn],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[Rn,[An,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[An,"Sailfish Browser"],Rn],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[An,Rn],[/(dolfin)\/([\w\.]+)/i],[[An,"Dolphin"],Rn],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[An,"360 Browser"]],[/(coast)\/([\w\.]+)/i],[[An,"Opera Coast"],Rn],[/fxios\/([\w\.-]+)/i],[Rn,[An,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[Rn,[An,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[Rn,An],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[An,"GSA"],Rn],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[An,[Rn,t.mapper.str,t.maps.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[An,Rn],[/(navigator|netscape)\/([\w\.-]+)/i],[[An,"Netscape"],Rn],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[An,Rn]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",t.util.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",t.util.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",t.util.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[In,On,[Nn,Sn]],[/applecoremedia\/[\w\.]+ \((ipad)/],[In,[On,"Apple"],[Nn,Sn]],[/(apple\s{0,1}tv)/i],[[In,"Apple TV"],[On,"Apple"],[Nn,"smarttv"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[On,In,[Nn,Sn]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[In,[On,"Amazon"],[Nn,Sn]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[In,t.mapper.str,t.maps.device.amazon.model],[On,"Amazon"],[Nn,bn]],[/android.+aft([bms])\sbuild/i],[In,[On,"Amazon"],[Nn,"smarttv"]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[In,On,[Nn,bn]],[/\((ip[honed|\s\w*]+);/i],[In,[On,"Apple"],[Nn,bn]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[On,In,[Nn,bn]],[/\(bb10;\s(\w+)/i],[In,[On,"BlackBerry"],[Nn,bn]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[In,[On,"Asus"],[Nn,Sn]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[On,"Sony"],[In,"Xperia Tablet"],[Nn,Sn]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[In,[On,"Sony"],[Nn,bn]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[On,In,[Nn,"console"]],[/android.+;\s(shield)\sbuild/i],[In,[On,"Nvidia"],[Nn,"console"]],[/(playstation\s[34portablevi]+)/i],[In,[On,"Sony"],[Nn,"console"]],[/(sprint\s(\w+))/i],[[On,t.mapper.str,t.maps.device.sprint.vendor],[In,t.mapper.str,t.maps.device.sprint.model],[Nn,bn]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[On,[In,/_/g," "],[Nn,bn]],[/(nexus\s9)/i],[In,[On,"HTC"],[Nn,Sn]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[In,[On,"Huawei"],[Nn,bn]],[/android.+(bah2?-a?[lw]\d{2})/i],[In,[On,"Huawei"],[Nn,Sn]],[/(microsoft);\s(lumia[\s\w]+)/i],[On,In,[Nn,bn]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[In,[On,"Microsoft"],[Nn,"console"]],[/(kin\.[onetw]{3})/i],[[In,/\./g," "],[On,"Microsoft"],[Nn,bn]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[In,[On,"Motorola"],[Nn,bn]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[In,[On,"Motorola"],[Nn,Sn]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[On,t.util.trim],[In,t.util.trim],[Nn,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[In,/^/,"SmartTV"],[On,"Samsung"],[Nn,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[In,[On,"Sharp"],[Nn,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[On,"Samsung"],In,[Nn,Sn]],[/smart-tv.+(samsung)/i],[On,[Nn,"smarttv"],In],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[On,"Samsung"],In,[Nn,bn]],[/sie-(\w*)/i],[In,[On,"Siemens"],[Nn,bn]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[On,"Nokia"],In,[Nn,bn]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[In,[On,"Acer"],[Nn,Sn]],[/android.+([vl]k\-?\d{3})\s+build/i],[In,[On,"LG"],[Nn,Sn]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[On,"LG"],In,[Nn,Sn]],[/(lg) netcast\.tv/i],[On,In,[Nn,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[In,[On,"LG"],[Nn,bn]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[On,In,[Nn,Sn]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[In,[On,"Lenovo"],[Nn,Sn]],[/(lenovo)[_\s-]?([\w-]+)/i],[On,In,[Nn,bn]],[/linux;.+((jolla));/i],[On,In,[Nn,bn]],[/((pebble))app\/[\d\.]+\s/i],[On,In,[Nn,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[On,In,[Nn,bn]],[/crkey/i],[[In,"Chromecast"],[On,"Google"],[Nn,"smarttv"]],[/android.+;\s(glass)\s\d/i],[In,[On,"Google"],[Nn,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[In,[On,"Google"],[Nn,Sn]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[In,[On,"Google"],[Nn,bn]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[In,/_/g," "],[On,"Xiaomi"],[Nn,bn]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[In,/_/g," "],[On,"Xiaomi"],[Nn,Sn]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[In,[On,"Meizu"],[Nn,bn]],[/(mz)-([\w-]{2,})/i],[[On,"Meizu"],In,[Nn,bn]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[In,[On,"OnePlus"],[Nn,bn]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[In,[On,"RCA"],[Nn,Sn]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[In,[On,"Dell"],[Nn,Sn]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[In,[On,"Verizon"],[Nn,Sn]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[On,"Barnes & Noble"],In,[Nn,Sn]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[In,[On,"NuVision"],[Nn,Sn]],[/android.+;\s(k88)\sbuild/i],[In,[On,"ZTE"],[Nn,Sn]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[In,[On,"Swiss"],[Nn,bn]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[In,[On,"Swiss"],[Nn,Sn]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[In,[On,"Zeki"],[Nn,Sn]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[On,"Dragon Touch"],In,[Nn,Sn]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[In,[On,"Insignia"],[Nn,Sn]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[In,[On,"NextBook"],[Nn,Sn]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[On,"Voice"],In,[Nn,bn]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[On,"LvTel"],In,[Nn,bn]],[/android.+;\s(PH-1)\s/i],[In,[On,"Essential"],[Nn,bn]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[In,[On,"Envizen"],[Nn,Sn]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[On,In,[Nn,Sn]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[In,[On,"MachSpeed"],[Nn,Sn]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[On,In,[Nn,Sn]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[In,[On,"Rotor"],[Nn,Sn]],[/android.+(KS(.+))\s+build/i],[In,[On,"Amazon"],[Nn,Sn]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[On,In,[Nn,Sn]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[Nn,t.util.lowerize],On,In],[/[\s\/\(](smart-?tv)[;\)]/i],[[Nn,"smarttv"]],[/(android[\w\.\s\-]{0,9});.+build/i],[In,[On,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[Rn,[An,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[Rn,[An,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[An,Rn],[/rv\:([\w\.]{1,9}).+(gecko)/i],[Rn,An]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[An,Rn],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[An,t.mapper.str,t.maps.os.windows],[Rn,t.mapper.str,t.maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[An,"Windows"],[Rn,t.mapper.str,t.maps.os.windows.version]],[/\((bb)(10);/i],[[An,"BlackBerry"],Rn],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[An,Rn],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[An,"Symbian"],Rn],[/\((series40);/i],[An],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[An,"Firefox OS"],Rn],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[An,"Linux"],Rn],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[An,"Chromium OS"],Rn],[/(sunos)\s?([\w\.\d]*)/i],[[An,"Solaris"],Rn],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[An,"Linux"],Rn],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[An,"iPhone"],[Rn,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[An,"iPad"],[Rn,/_/g,"."]],[/(haiku)\s(\w+)/i],[An,Rn],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[Rn,/_/g,"."],[An,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[An,"Mac"],[Rn,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[An,Rn]]},t}(),Cn=function(){function t(){}return t.generate=function(t){var e,n;if(void 0===t){var r={hostname:"",pathname:"",host:"",search:"",protocol:""};n={navigator:{userAgent:"",vendor:"",languages:[]},document:{location:r,title:""},location:r,screen:{width:"",height:""}}}else n=t;var i=Mn.parse(n.navigator.userAgent),o=i.browser,s=i.os,a=i.device,u=a.type?"mobile"===a.type?"Mobile":"ETC":"Web",c=(n.location.protocol||"").replace(":",""),f=n.screen,p="";try{p=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){}return{platform:u||"",browserName:o.name||"",browserMajorVersion:o.major||"",browserVersion:o.version||"",osName:s.name||"",osVersion:s.version||"",deviceModel:a.model||"",deviceType:a.type||"",deviceVendor:a.vendor||"",language:(null===(e=n.navigator.languages)||void 0===e?void 0:e[0])||"",userAgent:n.navigator.userAgent||"",pagePath:n.location.pathname||"",pageTitle:n.document.title||"",host:n.location.host||"",protocol:c,referrer:n.document.referrer||"",queryParameter:n.location.search||"",screenWidth:f.width||"",screenHeight:f.height||"",timeZone:p||""}},t}(),xn=function(){function t(t){void 0===t&&(t={days:0,isCrossSubdomain:!1,isSecure:!1}),this.options=t}return t.extractDomain=function(t){var e=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,n=t.split("."),r=n[n.length-1];(r.length>4||"com"===r||"org"===r)&&(e=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i);var i=t.match(e);return i?i[0]:""},t.prototype.getItem=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return decodeURIComponent(i.substring(e.length,i.length))}return null},t.prototype.getAllItem=function(t){var e=document.cookie.split("; ").map((function(t){return t.split("=")})),n=null==t?void 0:t.keyPrefix;return n?e.filter((function(t){var e=t[0];return t[1],e.startsWith(n)})):e},t.prototype.setItem=function(e,n,r){var i=G(G({},this.options),r),o="",s="",a="",u="";if(i.isCrossSubdomain){var c=t.extractDomain(document.location.hostname);o=c?"; domain=."+c:""}if(i.days){var f=new Date;f.setTime(f.getTime()+24*i.days*60*60*1e3),s="; expires="+f.toUTCString()}i.sameSite&&(u="; SameSite=".concat(i.sameSite)),i.isSecure&&(a+="; secure");var p=e+"="+encodeURIComponent(n)+s+"; path=/"+o+u+a;return document.cookie=p,p},t.prototype.removeItem=function(t,e){this.setItem(t,"",G(G({},e),{days:-1}))},t.prototype.getOptions=function(){return this.options},t.getInstance=function(e){return void 0===e&&(e={days:3650,isCrossSubdomain:!0}),t.storage||(t.storage=new t(e)),t.storage},t}(),Pn=function(){function t(t){this.userManager=t,kn.initialize()}return t.prototype.resolve=function(t){var e=Un(),n=(new It).addIdentifiers(t.identifiers||{}).add(_t.ID,t.id||e).add(_t.DEVICE,t.deviceId||e).add(_t.HACKLE_DEVICE,e);return B.isNotNullOrUndefined(t.userId)&&n.add(_t.USER,t.userId),{identifiers:n.build(),properties:t.properties||{},hackleProperties:this._getHackleProperties()}},t.prototype.resolveCurrentUser=function(){return this.resolve(this.userManager.currentUser)},t.prototype._getHackleProperties=function(){var t;return"undefined"!=typeof window&&(t=Cn.generate(window)),t||{}},t}(),kn=function(){function t(){}return t.initialize=function(){xn.getInstance().getItem("_hackle_hid")||Fn()},t.reInitialize=function(){Fn()},t}();function Un(){var t=xn.getInstance(),e=t.getItem("_hackle_id");return e||(t.getItem("_hackle_hid")||Fn())}function Dn(t){xn.getInstance().setItem("_hackle_id",t)}function Ln(){xn.getInstance().removeItem("_hackle_id")}function Fn(){var t=L.v4();return xn.getInstance().setItem("_hackle_hid",t),t}var Vn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{},Gn=function(t){return t&&t.Math==Math&&t},jn=Gn("object"==typeof globalThis&&globalThis)||Gn("object"==typeof window&&window)||Gn("object"==typeof self&&self)||Gn("object"==typeof Vn&&Vn)||function(){return this}()||Function("return this")(),Hn={},Kn=function(t){try{return!!t()}catch(t){return!0}},Bn=!Kn((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),zn=!Kn((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),Jn=zn,qn=Function.prototype.call,Yn=Jn?qn.bind(qn):function(){return qn.apply(qn,arguments)},Xn={},Wn={}.propertyIsEnumerable,$n=Object.getOwnPropertyDescriptor,Zn=$n&&!Wn.call({1:2},1);Xn.f=Zn?function(t){var e=$n(this,t);return!!e&&e.enumerable}:Wn;var Qn,tr,er=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},nr=zn,rr=Function.prototype,ir=rr.bind,or=rr.call,sr=nr&&ir.bind(or,or),ar=nr?function(t){return t&&sr(t)}:function(t){return t&&function(){return or.apply(t,arguments)}},ur=ar,cr=ur({}.toString),fr=ur("".slice),pr=function(t){return fr(cr(t),8,-1)},lr=Kn,hr=pr,dr=Object,vr=ar("".split),yr=lr((function(){return!dr("z").propertyIsEnumerable(0)}))?function(t){return"String"==hr(t)?vr(t,""):dr(t)}:dr,mr=TypeError,gr=function(t){if(null==t)throw mr("Can't call method on "+t);return t},Er=yr,wr=gr,Tr=function(t){return Er(wr(t))},_r=function(t){return"function"==typeof t},Ir=_r,Ar=function(t){return"object"==typeof t?null!==t:Ir(t)},Nr=jn,Or=_r,Rr=function(t,e){return arguments.length<2?function(t){return Or(t)?t:void 0}(Nr[t]):Nr[t]&&Nr[t][e]},br=ar({}.isPrototypeOf),Sr=Rr("navigator","userAgent")||"",Mr=jn,Cr=Sr,xr=Mr.process,Pr=Mr.Deno,kr=xr&&xr.versions||Pr&&Pr.version,Ur=kr&&kr.v8;Ur&&(tr=(Qn=Ur.split("."))[0]>0&&Qn[0]<4?1:+(Qn[0]+Qn[1])),!tr&&Cr&&(!(Qn=Cr.match(/Edge\/(\d+)/))||Qn[1]>=74)&&(Qn=Cr.match(/Chrome\/(\d+)/))&&(tr=+Qn[1]);var Dr=tr,Lr=Dr,Fr=Kn,Vr=!!Object.getOwnPropertySymbols&&!Fr((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Lr&&Lr<41})),Gr=Vr&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,jr=Rr,Hr=_r,Kr=br,Br=Object,zr=Gr?function(t){return"symbol"==typeof t}:function(t){var e=jr("Symbol");return Hr(e)&&Kr(e.prototype,Br(t))},Jr=String,qr=function(t){try{return Jr(t)}catch(t){return"Object"}},Yr=_r,Xr=qr,Wr=TypeError,$r=function(t){if(Yr(t))return t;throw Wr(Xr(t)+" is not a function")},Zr=$r,Qr=function(t,e){var n=t[e];return null==n?void 0:Zr(n)},ti=Yn,ei=_r,ni=Ar,ri=TypeError,ii={exports:{}},oi=jn,si=Object.defineProperty,ai=function(t,e){try{si(oi,t,{value:e,configurable:!0,writable:!0})}catch(n){oi[t]=e}return e},ui=ai,ci=jn["__core-js_shared__"]||ui("__core-js_shared__",{}),fi=ci;(ii.exports=function(t,e){return fi[t]||(fi[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.24.1",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"});var pi=gr,li=Object,hi=function(t){return li(pi(t))},di=hi,vi=ar({}.hasOwnProperty),yi=Object.hasOwn||function(t,e){return vi(di(t),e)},mi=ar,gi=0,Ei=Math.random(),wi=mi(1..toString),Ti=function(t){return"Symbol("+(void 0===t?"":t)+")_"+wi(++gi+Ei,36)},_i=jn,Ii=ii.exports,Ai=yi,Ni=Ti,Oi=Vr,Ri=Gr,bi=Ii("wks"),Si=_i.Symbol,Mi=Si&&Si.for,Ci=Ri?Si:Si&&Si.withoutSetter||Ni,xi=function(t){if(!Ai(bi,t)||!Oi&&"string"!=typeof bi[t]){var e="Symbol."+t;Oi&&Ai(Si,t)?bi[t]=Si[t]:bi[t]=Ri&&Mi?Mi(e):Ci(e)}return bi[t]},Pi=Yn,ki=Ar,Ui=zr,Di=Qr,Li=TypeError,Fi=xi("toPrimitive"),Vi=function(t,e){if(!ki(t)||Ui(t))return t;var n,r=Di(t,Fi);if(r){if(void 0===e&&(e="default"),n=Pi(r,t,e),!ki(n)||Ui(n))return n;throw Li("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var n,r;if("string"===e&&ei(n=t.toString)&&!ni(r=ti(n,t)))return r;if(ei(n=t.valueOf)&&!ni(r=ti(n,t)))return r;if("string"!==e&&ei(n=t.toString)&&!ni(r=ti(n,t)))return r;throw ri("Can't convert object to primitive value")}(t,e)},Gi=zr,ji=function(t){var e=Vi(t,"string");return Gi(e)?e:e+""},Hi=Ar,Ki=jn.document,Bi=Hi(Ki)&&Hi(Ki.createElement),zi=function(t){return Bi?Ki.createElement(t):{}},Ji=zi,qi=!Bn&&!Kn((function(){return 7!=Object.defineProperty(Ji("div"),"a",{get:function(){return 7}}).a})),Yi=Bn,Xi=Yn,Wi=Xn,$i=er,Zi=Tr,Qi=ji,to=yi,eo=qi,no=Object.getOwnPropertyDescriptor;Hn.f=Yi?no:function(t,e){if(t=Zi(t),e=Qi(e),eo)try{return no(t,e)}catch(t){}if(to(t,e))return $i(!Xi(Wi.f,t,e),t[e])};var ro={},io=Bn&&Kn((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),oo=Ar,so=String,ao=TypeError,uo=function(t){if(oo(t))return t;throw ao(so(t)+" is not an object")},co=Bn,fo=qi,po=io,lo=uo,ho=ji,vo=TypeError,yo=Object.defineProperty,mo=Object.getOwnPropertyDescriptor;ro.f=co?po?function(t,e,n){if(lo(t),e=ho(e),lo(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var r=mo(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return yo(t,e,n)}:yo:function(t,e,n){if(lo(t),e=ho(e),lo(n),fo)try{return yo(t,e,n)}catch(t){}if("get"in n||"set"in n)throw vo("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var go=ro,Eo=er,wo=Bn?function(t,e,n){return go.f(t,e,Eo(1,n))}:function(t,e,n){return t[e]=n,t},To={exports:{}},_o=Bn,Io=yi,Ao=Function.prototype,No=_o&&Object.getOwnPropertyDescriptor,Oo=Io(Ao,"name"),Ro={EXISTS:Oo,PROPER:Oo&&"something"===function(){}.name,CONFIGURABLE:Oo&&(!_o||_o&&No(Ao,"name").configurable)},bo=_r,So=ci,Mo=ar(Function.toString);bo(So.inspectSource)||(So.inspectSource=function(t){return Mo(t)});var Co,xo,Po,ko=So.inspectSource,Uo=_r,Do=ko,Lo=jn.WeakMap,Fo=Uo(Lo)&&/native code/.test(Do(Lo)),Vo=ii.exports,Go=Ti,jo=Vo("keys"),Ho=function(t){return jo[t]||(jo[t]=Go(t))},Ko={},Bo=Fo,zo=jn,Jo=ar,qo=Ar,Yo=wo,Xo=yi,Wo=ci,$o=Ho,Zo=Ko,Qo=zo.TypeError,ts=zo.WeakMap;if(Bo||Wo.state){var es=Wo.state||(Wo.state=new ts),ns=Jo(es.get),rs=Jo(es.has),is=Jo(es.set);Co=function(t,e){if(rs(es,t))throw new Qo("Object already initialized");return e.facade=t,is(es,t,e),e},xo=function(t){return ns(es,t)||{}},Po=function(t){return rs(es,t)}}else{var os=$o("state");Zo[os]=!0,Co=function(t,e){if(Xo(t,os))throw new Qo("Object already initialized");return e.facade=t,Yo(t,os,e),e},xo=function(t){return Xo(t,os)?t[os]:{}},Po=function(t){return Xo(t,os)}}var ss={set:Co,get:xo,has:Po,enforce:function(t){return Po(t)?xo(t):Co(t,{})},getterFor:function(t){return function(e){var n;if(!qo(e)||(n=xo(e)).type!==t)throw Qo("Incompatible receiver, "+t+" required");return n}}},as=Kn,us=_r,cs=yi,fs=Bn,ps=Ro.CONFIGURABLE,ls=ko,hs=ss.enforce,ds=ss.get,vs=Object.defineProperty,ys=fs&&!as((function(){return 8!==vs((function(){}),"length",{value:8}).length})),ms=String(String).split("String"),gs=To.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!cs(t,"name")||ps&&t.name!==e)&&(fs?vs(t,"name",{value:e,configurable:!0}):t.name=e),ys&&n&&cs(n,"arity")&&t.length!==n.arity&&vs(t,"length",{value:n.arity});try{n&&cs(n,"constructor")&&n.constructor?fs&&vs(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=hs(t);return cs(r,"source")||(r.source=ms.join("string"==typeof e?e:"")),t};Function.prototype.toString=gs((function(){return us(this)&&ds(this).source||ls(this)}),"toString");var Es=_r,ws=ro,Ts=To.exports,_s=ai,Is=function(t,e,n,r){r||(r={});var i=r.enumerable,o=void 0!==r.name?r.name:e;if(Es(n)&&Ts(n,o,r),r.global)i?t[e]=n:_s(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch(t){}i?t[e]=n:ws.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},As={},Ns=Math.ceil,Os=Math.floor,Rs=Math.trunc||function(t){var e=+t;return(e>0?Os:Ns)(e)},bs=function(t){var e=+t;return e!=e||0===e?0:Rs(e)},Ss=bs,Ms=Math.max,Cs=Math.min,xs=function(t,e){var n=Ss(t);return n<0?Ms(n+e,0):Cs(n,e)},Ps=bs,ks=Math.min,Us=function(t){return function(t){return t>0?ks(Ps(t),9007199254740991):0}(t.length)},Ds=Tr,Ls=xs,Fs=Us,Vs=function(t){return function(e,n,r){var i,o=Ds(e),s=Fs(o),a=Ls(r,s);if(t&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}},Gs={includes:Vs(!0),indexOf:Vs(!1)},js=yi,Hs=Tr,Ks=Gs.indexOf,Bs=Ko,zs=ar([].push),Js=function(t,e){var n,r=Hs(t),i=0,o=[];for(n in r)!js(Bs,n)&&js(r,n)&&zs(o,n);for(;e.length>i;)js(r,n=e[i++])&&(~Ks(o,n)||zs(o,n));return o},qs=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ys=Js,Xs=qs.concat("length","prototype");As.f=Object.getOwnPropertyNames||function(t){return Ys(t,Xs)};var Ws={};Ws.f=Object.getOwnPropertySymbols;var $s=Rr,Zs=As,Qs=Ws,ta=uo,ea=ar([].concat),na=$s("Reflect","ownKeys")||function(t){var e=Zs.f(ta(t)),n=Qs.f;return n?ea(e,n(t)):e},ra=yi,ia=na,oa=Hn,sa=ro,aa=function(t,e,n){for(var r=ia(e),i=sa.f,o=oa.f,s=0;s<r.length;s++){var a=r[s];ra(t,a)||n&&ra(n,a)||i(t,a,o(e,a))}},ua=Kn,ca=_r,fa=/#|\.prototype\./,pa=function(t,e){var n=ha[la(t)];return n==va||n!=da&&(ca(e)?ua(e):!!e)},la=pa.normalize=function(t){return String(t).replace(fa,".").toLowerCase()},ha=pa.data={},da=pa.NATIVE="N",va=pa.POLYFILL="P",ya=pa,ma=jn,ga=Hn.f,Ea=wo,wa=Is,Ta=ai,_a=aa,Ia=ya,Aa=function(t,e){var n,r,i,o,s,a=t.target,u=t.global,c=t.stat;if(n=u?ma:c?ma[a]||Ta(a,{}):(ma[a]||{}).prototype)for(r in e){if(o=e[r],i=t.dontCallGetSet?(s=ga(n,r))&&s.value:n[r],!Ia(u?r:a+(c?".":"#")+r,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;_a(o,i)}(t.sham||i&&i.sham)&&Ea(o,"sham",!0),wa(n,r,o,t)}},Na=!Kn((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Oa=yi,Ra=_r,ba=hi,Sa=Na,Ma=Ho("IE_PROTO"),Ca=Object,xa=Ca.prototype,Pa=Sa?Ca.getPrototypeOf:function(t){var e=ba(t);if(Oa(e,Ma))return e[Ma];var n=e.constructor;return Ra(n)&&e instanceof n?n.prototype:e instanceof Ca?xa:null},ka=_r,Ua=String,Da=TypeError,La=ar,Fa=uo,Va=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=La(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Fa(n),function(t){if("object"==typeof t||ka(t))return t;throw Da("Can't set "+Ua(t)+" as a prototype")}(r),e?t(n,r):n.__proto__=r,n}}():void 0),Ga={},ja=Js,Ha=qs,Ka=Object.keys||function(t){return ja(t,Ha)},Ba=Bn,za=io,Ja=ro,qa=uo,Ya=Tr,Xa=Ka;Ga.f=Ba&&!za?Object.defineProperties:function(t,e){qa(t);for(var n,r=Ya(e),i=Xa(e),o=i.length,s=0;o>s;)Ja.f(t,n=i[s++],r[n]);return t};var Wa,$a=Rr("document","documentElement"),Za=uo,Qa=Ga,tu=qs,eu=Ko,nu=$a,ru=zi,iu=Ho("IE_PROTO"),ou=function(){},su=function(t){return"<script>"+t+"<\/script>"},au=function(t){t.write(su("")),t.close();var e=t.parentWindow.Object;return t=null,e},uu=function(){try{Wa=new ActiveXObject("htmlfile")}catch(t){}var t,e;uu="undefined"!=typeof document?document.domain&&Wa?au(Wa):((e=ru("iframe")).style.display="none",nu.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(su("document.F=Object")),t.close(),t.F):au(Wa);for(var n=tu.length;n--;)delete uu.prototype[tu[n]];return uu()};eu[iu]=!0;var cu=Object.create||function(t,e){var n;return null!==t?(ou.prototype=Za(t),n=new ou,ou.prototype=null,n[iu]=t):n=uu(),void 0===e?n:Qa.f(n,e)},fu=Error,pu=ar("".replace),lu=String(fu("zxcasd").stack),hu=/\n\s*at [^:]*:[^\n]*/,du=hu.test(lu),vu=Ar,yu=wo,mu=$r,gu=zn,Eu=ar(ar.bind),wu=function(t,e){return mu(t),void 0===e?t:gu?Eu(t,e):function(){return t.apply(e,arguments)}},Tu={},_u=Tu,Iu=xi("iterator"),Au=Array.prototype,Nu=function(t){return void 0!==t&&(_u.Array===t||Au[Iu]===t)},Ou={};Ou[xi("toStringTag")]="z";var Ru="[object z]"===String(Ou),bu=Ru,Su=_r,Mu=pr,Cu=xi("toStringTag"),xu=Object,Pu="Arguments"==Mu(function(){return arguments}()),ku=bu?Mu:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=xu(t),Cu))?n:Pu?Mu(e):"Object"==(r=Mu(e))&&Su(e.callee)?"Arguments":r},Uu=ku,Du=Qr,Lu=Tu,Fu=xi("iterator"),Vu=function(t){if(null!=t)return Du(t,Fu)||Du(t,"@@iterator")||Lu[Uu(t)]},Gu=Yn,ju=$r,Hu=uo,Ku=qr,Bu=Vu,zu=TypeError,Ju=function(t,e){var n=arguments.length<2?Bu(t):e;if(ju(n))return Hu(Gu(n,t));throw zu(Ku(t)+" is not iterable")},qu=Yn,Yu=uo,Xu=Qr,Wu=function(t,e,n){var r,i;Yu(t);try{if(!(r=Xu(t,"return"))){if("throw"===e)throw n;return n}r=qu(r,t)}catch(t){i=!0,r=t}if("throw"===e)throw n;if(i)throw r;return Yu(r),n},$u=wu,Zu=Yn,Qu=uo,tc=qr,ec=Nu,nc=Us,rc=br,ic=Ju,oc=Vu,sc=Wu,ac=TypeError,uc=function(t,e){this.stopped=t,this.result=e},cc=uc.prototype,fc=function(t,e,n){var r,i,o,s,a,u,c,f=n&&n.that,p=!(!n||!n.AS_ENTRIES),l=!(!n||!n.IS_RECORD),h=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),v=$u(e,f),y=function(t){return r&&sc(r,"normal",t),new uc(!0,t)},m=function(t){return p?(Qu(t),d?v(t[0],t[1],y):v(t[0],t[1])):d?v(t,y):v(t)};if(l)r=t.iterator;else if(h)r=t;else{if(!(i=oc(t)))throw ac(tc(t)+" is not iterable");if(ec(i)){for(o=0,s=nc(t);s>o;o++)if((a=m(t[o]))&&rc(cc,a))return a;return new uc(!1)}r=ic(t,i)}for(u=l?t.next:r.next;!(c=Zu(u,r)).done;){try{a=m(c.value)}catch(t){sc(r,"throw",t)}if("object"==typeof a&&a&&rc(cc,a))return a}return new uc(!1)},pc=ku,lc=String,hc=function(t){if("Symbol"===pc(t))throw TypeError("Cannot convert a Symbol value to a string");return lc(t)},dc=hc,vc=er,yc=!Kn((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",vc(1,7)),7!==t.stack)})),mc=Aa,gc=br,Ec=Pa,wc=Va,Tc=aa,_c=cu,Ic=wo,Ac=er,Nc=fc,Oc=yc,Rc=xi("toStringTag"),bc=Error,Sc=[].push,Mc=function(t,e){var n,r=arguments.length>2?arguments[2]:void 0,i=gc(Cc,this);wc?n=wc(new bc,i?Ec(this):Cc):(n=i?this:_c(Cc),Ic(n,Rc,"Error")),void 0!==e&&Ic(n,"message",function(t,e){return void 0===t?arguments.length<2?"":e:dc(t)}(e)),Oc&&Ic(n,"stack",function(t,e){if(du&&"string"==typeof t&&!fu.prepareStackTrace)for(;e--;)t=pu(t,hu,"");return t}(n.stack,1)),function(t,e){vu(e)&&"cause"in e&&yu(t,"cause",e.cause)}(n,r);var o=[];return Nc(t,Sc,{that:o}),Ic(n,"errors",o),n};wc?wc(Mc,bc):Tc(Mc,bc,{name:!0});var Cc=Mc.prototype=_c(bc.prototype,{constructor:Ac(1,Mc),message:Ac(1,""),name:Ac(1,"AggregateError")});mc({global:!0,constructor:!0,arity:2},{AggregateError:Mc});var xc=xi,Pc=cu,kc=ro.f,Uc=xc("unscopables"),Dc=Array.prototype;null==Dc[Uc]&&kc(Dc,Uc,{configurable:!0,value:Pc(null)});var Lc,Fc,Vc,Gc=function(t){Dc[Uc][t]=!0},jc=Kn,Hc=_r,Kc=Pa,Bc=Is,zc=xi("iterator"),Jc=!1;[].keys&&("next"in(Vc=[].keys())?(Fc=Kc(Kc(Vc)))!==Object.prototype&&(Lc=Fc):Jc=!0);var qc=null==Lc||jc((function(){var t={};return Lc[zc].call(t)!==t}));qc&&(Lc={}),Hc(Lc[zc])||Bc(Lc,zc,(function(){return this}));var Yc={IteratorPrototype:Lc,BUGGY_SAFARI_ITERATORS:Jc},Xc=ro.f,Wc=yi,$c=xi("toStringTag"),Zc=function(t,e,n){t&&!n&&(t=t.prototype),t&&!Wc(t,$c)&&Xc(t,$c,{configurable:!0,value:e})},Qc=Yc.IteratorPrototype,tf=cu,ef=er,nf=Zc,rf=Tu,of=function(){return this},sf=Aa,af=Yn,uf=_r,cf=Pa,ff=Va,pf=Zc,lf=wo,hf=Is,df=Tu,vf=Ro.PROPER,yf=Ro.CONFIGURABLE,mf=Yc.IteratorPrototype,gf=Yc.BUGGY_SAFARI_ITERATORS,Ef=xi("iterator"),wf=function(){return this},Tf=function(t,e,n,r,i,o,s){!function(t,e,n,r){var i=e+" Iterator";t.prototype=tf(Qc,{next:ef(+!r,n)}),nf(t,i,!1),rf[i]=of}(n,e,r);var a,u,c,f=function(t){if(t===i&&v)return v;if(!gf&&t in h)return h[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},p=e+" Iterator",l=!1,h=t.prototype,d=h[Ef]||h["@@iterator"]||i&&h[i],v=!gf&&d||f(i),y="Array"==e&&h.entries||d;if(y&&(a=cf(y.call(new t)))!==Object.prototype&&a.next&&(cf(a)!==mf&&(ff?ff(a,mf):uf(a[Ef])||hf(a,Ef,wf)),pf(a,p,!0)),vf&&"values"==i&&d&&"values"!==d.name&&(yf?lf(h,"name","values"):(l=!0,v=function(){return af(d,this)})),i)if(u={values:f("values"),keys:o?v:f("keys"),entries:f("entries")},s)for(c in u)(gf||l||!(c in h))&&hf(h,c,u[c]);else sf({target:e,proto:!0,forced:gf||l},u);return h[Ef]!==v&&hf(h,Ef,v,{name:i}),df[e]=v,u},_f=Tr,If=Gc,Af=Tu,Nf=ss,Of=ro.f,Rf=Tf,bf=Bn,Sf=Nf.set,Mf=Nf.getterFor("Array Iterator"),Cf=Rf(Array,"Array",(function(t,e){Sf(this,{type:"Array Iterator",target:_f(t),index:0,kind:e})}),(function(){var t=Mf(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),xf=Af.Arguments=Af.Array;if(If("keys"),If("values"),If("entries"),bf&&"values"!==xf.name)try{Of(xf,"name",{value:"values"})}catch(L){}var Pf=ku,kf=Ru?{}.toString:function(){return"[object "+Pf(this)+"]"};Ru||Is(Object.prototype,"toString",kf,{unsafe:!0});var Uf="process"==pr(jn.process),Df=Rr,Lf=ro,Ff=Bn,Vf=xi("species"),Gf=function(t){var e=Df(t),n=Lf.f;Ff&&e&&!e[Vf]&&n(e,Vf,{configurable:!0,get:function(){return this}})},jf=br,Hf=TypeError,Kf=function(t,e){if(jf(e,t))return t;throw Hf("Incorrect invocation")},Bf=ar,zf=Kn,Jf=_r,qf=ku,Yf=ko,Xf=function(){},Wf=[],$f=Rr("Reflect","construct"),Zf=/^\s*(?:class|function)\b/,Qf=Bf(Zf.exec),tp=!Zf.exec(Xf),ep=function(t){if(!Jf(t))return!1;try{return $f(Xf,Wf,t),!0}catch(t){return!1}},np=function(t){if(!Jf(t))return!1;switch(qf(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return tp||!!Qf(Zf,Yf(t))}catch(t){return!0}};np.sham=!0;var rp,ip,op,sp,ap=!$f||zf((function(){var t;return ep(ep.call)||!ep(Object)||!ep((function(){t=!0}))||t}))?np:ep,up=ap,cp=qr,fp=TypeError,pp=uo,lp=xi("species"),hp=function(t,e){var n,r=pp(t).constructor;return void 0===r||null==(n=pp(r)[lp])?e:function(t){if(up(t))return t;throw fp(cp(t)+" is not a constructor")}(n)},dp=zn,vp=Function.prototype,yp=vp.apply,mp=vp.call,gp="object"==typeof Reflect&&Reflect.apply||(dp?mp.bind(yp):function(){return mp.apply(yp,arguments)}),Ep=ar([].slice),wp=TypeError,Tp=/(?:ipad|iphone|ipod).*applewebkit/i.test(Sr),_p=jn,Ip=gp,Ap=wu,Np=_r,Op=yi,Rp=Kn,bp=$a,Sp=Ep,Mp=zi,Cp=Tp,xp=Uf,Pp=_p.setImmediate,kp=_p.clearImmediate,Up=_p.process,Dp=_p.Dispatch,Lp=_p.Function,Fp=_p.MessageChannel,Vp=_p.String,Gp=0,jp={};try{rp=_p.location}catch(L){}var Hp=function(t){if(Op(jp,t)){var e=jp[t];delete jp[t],e()}},Kp=function(t){return function(){Hp(t)}},Bp=function(t){Hp(t.data)},zp=function(t){_p.postMessage(Vp(t),rp.protocol+"//"+rp.host)};Pp&&kp||(Pp=function(t){!function(t,e){if(t<e)throw wp("Not enough arguments")}(arguments.length,1);var e=Np(t)?t:Lp(t),n=Sp(arguments,1);return jp[++Gp]=function(){Ip(e,void 0,n)},ip(Gp),Gp},kp=function(t){delete jp[t]},xp?ip=function(t){Up.nextTick(Kp(t))}:Dp&&Dp.now?ip=function(t){Dp.now(Kp(t))}:Fp&&!Cp?(sp=(op=new Fp).port2,op.port1.onmessage=Bp,ip=Ap(sp.postMessage,sp)):_p.addEventListener&&Np(_p.postMessage)&&!_p.importScripts&&rp&&"file:"!==rp.protocol&&!Rp(zp)?(ip=zp,_p.addEventListener("message",Bp,!1)):ip="onreadystatechange"in Mp("script")?function(t){bp.appendChild(Mp("script")).onreadystatechange=function(){bp.removeChild(this),Hp(t)}}:function(t){setTimeout(Kp(t),0)});var Jp,qp,Yp,Xp,Wp,$p,Zp,Qp,tl={set:Pp,clear:kp},el=jn,nl=/ipad|iphone|ipod/i.test(Sr)&&void 0!==el.Pebble,rl=/web0s(?!.*chrome)/i.test(Sr),il=jn,ol=wu,sl=Hn.f,al=tl.set,ul=Tp,cl=nl,fl=rl,pl=Uf,ll=il.MutationObserver||il.WebKitMutationObserver,hl=il.document,dl=il.process,vl=il.Promise,yl=sl(il,"queueMicrotask"),ml=yl&&yl.value;ml||(Jp=function(){var t,e;for(pl&&(t=dl.domain)&&t.exit();qp;){e=qp.fn,qp=qp.next;try{e()}catch(t){throw qp?Xp():Yp=void 0,t}}Yp=void 0,t&&t.enter()},ul||pl||fl||!ll||!hl?!cl&&vl&&vl.resolve?((Zp=vl.resolve(void 0)).constructor=vl,Qp=ol(Zp.then,Zp),Xp=function(){Qp(Jp)}):pl?Xp=function(){dl.nextTick(Jp)}:(al=ol(al,il),Xp=function(){al(Jp)}):(Wp=!0,$p=hl.createTextNode(""),new ll(Jp).observe($p,{characterData:!0}),Xp=function(){$p.data=Wp=!Wp}));var gl=ml||function(t){var e={fn:t,next:void 0};Yp&&(Yp.next=e),qp||(qp=e,Xp()),Yp=e},El=jn,wl=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Tl=function(){this.head=null,this.tail=null};Tl.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var _l=Tl,Il=jn.Promise,Al="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Nl=!Al&&!Uf&&"object"==typeof window&&"object"==typeof document,Ol=jn,Rl=Il,bl=_r,Sl=ya,Ml=ko,Cl=xi,xl=Nl,Pl=Al,kl=Dr;Rl&&Rl.prototype;var Ul=Cl("species"),Dl=!1,Ll=bl(Ol.PromiseRejectionEvent),Fl=Sl("Promise",(function(){var t=Ml(Rl),e=t!==String(Rl);if(!e&&66===kl)return!0;if(!kl||kl<51||!/native code/.test(t)){var n=new Rl((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[Ul]=r,!(Dl=n.then((function(){}))instanceof r))return!0}return!e&&(xl||Pl)&&!Ll})),Vl={CONSTRUCTOR:Fl,REJECTION_EVENT:Ll,SUBCLASSING:Dl},Gl={},jl=$r,Hl=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=jl(e),this.reject=jl(n)};Gl.f=function(t){return new Hl(t)};var Kl,Bl,zl,Jl=Aa,ql=Uf,Yl=jn,Xl=Yn,Wl=Is,$l=Va,Zl=Zc,Ql=Gf,th=$r,eh=_r,nh=Ar,rh=Kf,ih=hp,oh=tl.set,sh=gl,ah=wl,uh=_l,ch=ss,fh=Il,ph=Gl,lh=Vl.CONSTRUCTOR,hh=Vl.REJECTION_EVENT,dh=Vl.SUBCLASSING,vh=ch.getterFor("Promise"),yh=ch.set,mh=fh&&fh.prototype,gh=fh,Eh=mh,wh=Yl.TypeError,Th=Yl.document,_h=Yl.process,Ih=ph.f,Ah=Ih,Nh=!!(Th&&Th.createEvent&&Yl.dispatchEvent),Oh=function(t){var e;return!(!nh(t)||!eh(e=t.then))&&e},Rh=function(t,e){var n,r,i,o=e.value,s=1==e.state,a=s?t.ok:t.fail,u=t.resolve,c=t.reject,f=t.domain;try{a?(s||(2===e.rejection&&xh(e),e.rejection=1),!0===a?n=o:(f&&f.enter(),n=a(o),f&&(f.exit(),i=!0)),n===t.promise?c(wh("Promise-chain cycle")):(r=Oh(n))?Xl(r,n,u,c):u(n)):c(o)}catch(t){f&&!i&&f.exit(),c(t)}},bh=function(t,e){t.notified||(t.notified=!0,sh((function(){for(var n,r=t.reactions;n=r.get();)Rh(n,t);t.notified=!1,e&&!t.rejection&&Mh(t)})))},Sh=function(t,e,n){var r,i;Nh?((r=Th.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),Yl.dispatchEvent(r)):r={promise:e,reason:n},!hh&&(i=Yl["on"+t])?i(r):"unhandledrejection"===t&&function(t,e){var n=El.console;n&&n.error&&(1==arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)},Mh=function(t){Xl(oh,Yl,(function(){var e,n=t.facade,r=t.value;if(Ch(t)&&(e=ah((function(){ql?_h.emit("unhandledRejection",r,n):Sh("unhandledrejection",n,r)})),t.rejection=ql||Ch(t)?2:1,e.error))throw e.value}))},Ch=function(t){return 1!==t.rejection&&!t.parent},xh=function(t){Xl(oh,Yl,(function(){var e=t.facade;ql?_h.emit("rejectionHandled",e):Sh("rejectionhandled",e,t.value)}))},Ph=function(t,e,n){return function(r){t(e,r,n)}},kh=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,bh(t,!0))},Uh=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw wh("Promise can't be resolved itself");var r=Oh(e);r?sh((function(){var n={done:!1};try{Xl(r,e,Ph(Uh,n,t),Ph(kh,n,t))}catch(e){kh(n,e,t)}})):(t.value=e,t.state=1,bh(t,!1))}catch(e){kh({done:!1},e,t)}}};if(lh&&(Eh=(gh=function(t){rh(this,Eh),th(t),Xl(Kl,this);var e=vh(this);try{t(Ph(Uh,e),Ph(kh,e))}catch(t){kh(e,t)}}).prototype,(Kl=function(t){yh(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new uh,rejection:!1,state:0,value:void 0})}).prototype=Wl(Eh,"then",(function(t,e){var n=vh(this),r=Ih(ih(this,gh));return n.parent=!0,r.ok=!eh(t)||t,r.fail=eh(e)&&e,r.domain=ql?_h.domain:void 0,0==n.state?n.reactions.add(r):sh((function(){Rh(r,n)})),r.promise})),Bl=function(){var t=new Kl,e=vh(t);this.promise=t,this.resolve=Ph(Uh,e),this.reject=Ph(kh,e)},ph.f=Ih=function(t){return t===gh||void 0===t?new Bl(t):Ah(t)},eh(fh)&&mh!==Object.prototype)){zl=mh.then,dh||Wl(mh,"then",(function(t,e){var n=this;return new gh((function(t,e){Xl(zl,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete mh.constructor}catch(L){}$l&&$l(mh,Eh)}Jl({global:!0,constructor:!0,wrap:!0,forced:lh},{Promise:gh}),Zl(gh,"Promise",!1),Ql("Promise");var Dh=xi("iterator"),Lh=!1;try{var Fh=0,Vh={next:function(){return{done:!!Fh++}},return:function(){Lh=!0}};Vh[Dh]=function(){return this},Array.from(Vh,(function(){throw 2}))}catch(L){}var Gh=function(t,e){if(!e&&!Lh)return!1;var n=!1;try{var r={};r[Dh]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},jh=Il,Hh=Vl.CONSTRUCTOR||!Gh((function(t){jh.all(t).then(void 0,(function(){}))})),Kh=Yn,Bh=$r,zh=Gl,Jh=wl,qh=fc;Aa({target:"Promise",stat:!0,forced:Hh},{all:function(t){var e=this,n=zh.f(e),r=n.resolve,i=n.reject,o=Jh((function(){var n=Bh(e.resolve),o=[],s=0,a=1;qh(t,(function(t){var u=s++,c=!1;a++,Kh(n,e,t).then((function(t){c||(c=!0,o[u]=t,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise}});var Yh=Aa,Xh=Vl.CONSTRUCTOR,Wh=Il,$h=Rr,Zh=_r,Qh=Is,td=Wh&&Wh.prototype;if(Yh({target:"Promise",proto:!0,forced:Xh,real:!0},{catch:function(t){return this.then(void 0,t)}}),Zh(Wh)){var ed=$h("Promise").prototype.catch;td.catch!==ed&&Qh(td,"catch",ed,{unsafe:!0})}var nd=Yn,rd=$r,id=Gl,od=wl,sd=fc;Aa({target:"Promise",stat:!0,forced:Hh},{race:function(t){var e=this,n=id.f(e),r=n.reject,i=od((function(){var i=rd(e.resolve);sd(t,(function(t){nd(i,e,t).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var ad=Yn,ud=Gl;Aa({target:"Promise",stat:!0,forced:Vl.CONSTRUCTOR},{reject:function(t){var e=ud.f(this);return ad(e.reject,void 0,t),e.promise}});var cd=uo,fd=Ar,pd=Gl,ld=function(t,e){if(cd(t),fd(e)&&e.constructor===t)return e;var n=pd.f(t);return(0,n.resolve)(e),n.promise},hd=Aa,dd=Vl.CONSTRUCTOR,vd=ld;Rr("Promise"),hd({target:"Promise",stat:!0,forced:dd},{resolve:function(t){return vd(this,t)}});var yd=Yn,md=$r,gd=Gl,Ed=wl,wd=fc;Aa({target:"Promise",stat:!0},{allSettled:function(t){var e=this,n=gd.f(e),r=n.resolve,i=n.reject,o=Ed((function(){var n=md(e.resolve),i=[],o=0,s=1;wd(t,(function(t){var a=o++,u=!1;s++,yd(n,e,t).then((function(t){u||(u=!0,i[a]={status:"fulfilled",value:t},--s||r(i))}),(function(t){u||(u=!0,i[a]={status:"rejected",reason:t},--s||r(i))}))})),--s||r(i)}));return o.error&&i(o.value),n.promise}});var Td=Yn,_d=$r,Id=Rr,Ad=Gl,Nd=wl,Od=fc;Aa({target:"Promise",stat:!0},{any:function(t){var e=this,n=Id("AggregateError"),r=Ad.f(e),i=r.resolve,o=r.reject,s=Nd((function(){var r=_d(e.resolve),s=[],a=0,u=1,c=!1;Od(t,(function(t){var f=a++,p=!1;u++,Td(r,e,t).then((function(t){p||c||(c=!0,i(t))}),(function(t){p||c||(p=!0,s[f]=t,--u||o(new n(s,"No one promise resolved")))}))})),--u||o(new n(s,"No one promise resolved"))}));return s.error&&o(s.value),r.promise}});var Rd=Aa,bd=Il,Sd=Kn,Md=Rr,Cd=_r,xd=hp,Pd=ld,kd=Is,Ud=bd&&bd.prototype;if(Rd({target:"Promise",proto:!0,real:!0,forced:!!bd&&Sd((function(){Ud.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=xd(this,Md("Promise")),n=Cd(t);return this.then(n?function(n){return Pd(e,t()).then((function(){return n}))}:t,n?function(n){return Pd(e,t()).then((function(){throw n}))}:t)}}),Cd(bd)){var Dd=Md("Promise").prototype.finally;Ud.finally!==Dd&&kd(Ud,"finally",Dd,{unsafe:!0})}var Ld=ar,Fd=bs,Vd=hc,Gd=gr,jd=Ld("".charAt),Hd=Ld("".charCodeAt),Kd=Ld("".slice),Bd=function(t){return function(e,n){var r,i,o=Vd(Gd(e)),s=Fd(n),a=o.length;return s<0||s>=a?t?"":void 0:(r=Hd(o,s))<55296||r>56319||s+1===a||(i=Hd(o,s+1))<56320||i>57343?t?jd(o,s):r:t?Kd(o,s,s+2):i-56320+(r-55296<<10)+65536}},zd=(Bd(!1),Bd(!0)),Jd=hc,qd=ss,Yd=Tf,Xd=qd.set,Wd=qd.getterFor("String Iterator");Yd(String,"String",(function(t){Xd(this,{type:"String Iterator",string:Jd(t),index:0})}),(function(){var t,e=Wd(this),n=e.string,r=e.index;return r>=n.length?{value:void 0,done:!0}:(t=zd(n,r),e.index+=t.length,{value:t,done:!1})}));var $d=jn,Zd=($d.Promise,zi("span").classList),Qd=Zd&&Zd.constructor&&Zd.constructor.prototype,tv=Qd===Object.prototype?void 0:Qd,ev=jn,nv={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},rv=tv,iv=Cf,ov=wo,sv=xi,av=sv("iterator"),uv=sv("toStringTag"),cv=iv.values,fv=function(t,e){if(t){if(t[av]!==cv)try{ov(t,av,cv)}catch(e){t[av]=cv}if(t[uv]||ov(t,uv,e),nv[e])for(var n in iv)if(t[n]!==iv[n])try{ov(t,n,iv[n])}catch(e){t[n]=iv[n]}}};for(var pv in nv)fv(ev[pv]&&ev[pv].prototype,pv);fv(rv,"DOMTokenList");var lv=Gl,hv=wl;Aa({target:"Promise",stat:!0,forced:!0},{try:function(t){var e=lv.f(this),n=hv(t);return(n.error?e.reject:e.resolve)(n.value),e.promise}});var dv=uo,vv=Wu,yv=ji,mv=ro,gv=er,Ev=function(t,e,n){var r=yv(e);r in t?mv.f(t,r,gv(0,n)):t[r]=n},wv=wu,Tv=Yn,_v=hi,Iv=function(t,e,n,r){try{return r?e(dv(n)[0],n[1]):e(n)}catch(e){vv(t,"throw",e)}},Av=Nu,Nv=ap,Ov=Us,Rv=Ev,bv=Ju,Sv=Vu,Mv=Array;Aa({target:"Array",stat:!0,forced:!Gh((function(t){Array.from(t)}))},{from:function(t){var e=_v(t),n=Nv(this),r=arguments.length,i=r>1?arguments[1]:void 0,o=void 0!==i;o&&(i=wv(i,r>2?arguments[2]:void 0));var s,a,u,c,f,p,l=Sv(e),h=0;if(!l||this===Mv&&Av(l))for(s=Ov(e),a=n?new this(s):Mv(s);s>h;h++)p=o?i(e[h],h):e[h],Rv(a,h,p);else for(f=(c=bv(e,l)).next,a=n?new this:[];!(u=Tv(f,c)).done;h++)p=o?Iv(c,i,[u.value,h],!0):u.value,Rv(a,h,p);return a.length=h,a}});var Cv=pr,xv=Array.isArray||function(t){return"Array"==Cv(t)};Aa({target:"Array",stat:!0},{isArray:xv});var Pv=ap,kv=Ev,Uv=Array;Aa({target:"Array",stat:!0,forced:Kn((function(){function t(){}return!(Uv.of.call(t)instanceof t)}))},{of:function(){for(var t=0,e=arguments.length,n=new(Pv(this)?this:Uv)(e);e>t;)kv(n,t,arguments[t++]);return n.length=e,n}});var Dv=hi,Lv=Us,Fv=bs,Vv=Gc;Aa({target:"Array",proto:!0},{at:function(t){var e=Dv(this),n=Lv(e),r=Fv(t),i=r>=0?r:n+r;return i<0||i>=n?void 0:e[i]}}),Vv("at");var Gv=TypeError,jv=function(t){if(t>9007199254740991)throw Gv("Maximum allowed index exceeded");return t},Hv=xv,Kv=ap,Bv=Ar,zv=xi("species"),Jv=Array,qv=function(t,e){return new(function(t){var e;return Hv(t)&&(e=t.constructor,(Kv(e)&&(e===Jv||Hv(e.prototype))||Bv(e)&&null===(e=e[zv]))&&(e=void 0)),void 0===e?Jv:e}(t))(0===e?0:e)},Yv=Kn,Xv=Dr,Wv=xi("species"),$v=function(t){return Xv>=51||!Yv((function(){var e=[];return(e.constructor={})[Wv]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Zv=Aa,Qv=Kn,ty=xv,ey=Ar,ny=hi,ry=Us,iy=jv,oy=Ev,sy=qv,ay=$v,uy=Dr,cy=xi("isConcatSpreadable"),fy=uy>=51||!Qv((function(){var t=[];return t[cy]=!1,t.concat()[0]!==t})),py=ay("concat"),ly=function(t){if(!ey(t))return!1;var e=t[cy];return void 0!==e?!!e:ty(t)};Zv({target:"Array",proto:!0,arity:1,forced:!fy||!py},{concat:function(t){var e,n,r,i,o,s=ny(this),a=sy(s,0),u=0;for(e=-1,r=arguments.length;e<r;e++)if(ly(o=-1===e?s:arguments[e]))for(i=ry(o),iy(u+i),n=0;n<i;n++,u++)n in o&&oy(a,u,o[n]);else iy(u+1),oy(a,u++,o);return a.length=u,a}});var hy=qr,dy=TypeError,vy=function(t,e){if(!delete t[e])throw dy("Cannot delete property "+hy(e)+" of "+hy(t))},yy=hi,my=xs,gy=Us,Ey=vy,wy=Math.min,Ty=[].copyWithin||function(t,e){var n=yy(this),r=gy(n),i=my(t,r),o=my(e,r),s=arguments.length>2?arguments[2]:void 0,a=wy((void 0===s?r:my(s,r))-o,r-i),u=1;for(o<i&&i<o+a&&(u=-1,o+=a-1,i+=a-1);a-- >0;)o in n?n[i]=n[o]:Ey(n,i),i+=u,o+=u;return n},_y=Gc;Aa({target:"Array",proto:!0},{copyWithin:Ty}),_y("copyWithin");var Iy=wu,Ay=yr,Ny=hi,Oy=Us,Ry=qv,by=ar([].push),Sy=function(t){var e=1==t,n=2==t,r=3==t,i=4==t,o=6==t,s=7==t,a=5==t||o;return function(u,c,f,p){for(var l,h,d=Ny(u),v=Ay(d),y=Iy(c,f),m=Oy(v),g=0,E=p||Ry,w=e?E(u,m):n||s?E(u,0):void 0;m>g;g++)if((a||g in v)&&(h=y(l=v[g],g,d),t))if(e)w[g]=h;else if(h)switch(t){case 3:return!0;case 5:return l;case 6:return g;case 2:by(w,l)}else switch(t){case 4:return!1;case 7:by(w,l)}return o?-1:r||i?i:w}},My={forEach:Sy(0),map:Sy(1),filter:Sy(2),some:Sy(3),every:Sy(4),find:Sy(5),findIndex:Sy(6),filterReject:Sy(7)},Cy=Kn,xy=function(t,e){var n=[][t];return!!n&&Cy((function(){n.call(null,e||function(){return 1},1)}))},Py=My.every;Aa({target:"Array",proto:!0,forced:!xy("every")},{every:function(t){return Py(this,t,arguments.length>1?arguments[1]:void 0)}});var ky=hi,Uy=xs,Dy=Us,Ly=Gc;Aa({target:"Array",proto:!0},{fill:function(t){for(var e=ky(this),n=Dy(e),r=arguments.length,i=Uy(r>1?arguments[1]:void 0,n),o=r>2?arguments[2]:void 0,s=void 0===o?n:Uy(o,n);s>i;)e[i++]=t;return e}}),Ly("fill");var Fy=My.filter;Aa({target:"Array",proto:!0,forced:!$v("filter")},{filter:function(t){return Fy(this,t,arguments.length>1?arguments[1]:void 0)}});var Vy=Aa,Gy=My.find,jy=Gc,Hy=!0;"find"in[]&&Array(1).find((function(){Hy=!1})),Vy({target:"Array",proto:!0,forced:Hy},{find:function(t){return Gy(this,t,arguments.length>1?arguments[1]:void 0)}}),jy("find");var Ky=Aa,By=My.findIndex,zy=Gc,Jy=!0;"findIndex"in[]&&Array(1).findIndex((function(){Jy=!1})),Ky({target:"Array",proto:!0,forced:Jy},{findIndex:function(t){return By(this,t,arguments.length>1?arguments[1]:void 0)}}),zy("findIndex");var qy=wu,Yy=yr,Xy=hi,Wy=Us,$y=function(t){var e=1==t;return function(n,r,i){for(var o,s=Xy(n),a=Yy(s),u=qy(r,i),c=Wy(a);c-- >0;)if(u(o=a[c],c,s))switch(t){case 0:return o;case 1:return c}return e?-1:void 0}},Zy={findLast:$y(0),findLastIndex:$y(1)},Qy=Zy.findLast,tm=Gc;Aa({target:"Array",proto:!0},{findLast:function(t){return Qy(this,t,arguments.length>1?arguments[1]:void 0)}}),tm("findLast");var em=Zy.findLastIndex,nm=Gc;Aa({target:"Array",proto:!0},{findLastIndex:function(t){return em(this,t,arguments.length>1?arguments[1]:void 0)}}),nm("findLastIndex");var rm=xv,im=Us,om=jv,sm=wu,am=function(t,e,n,r,i,o,s,a){for(var u,c,f=i,p=0,l=!!s&&sm(s,a);p<r;)p in n&&(u=l?l(n[p],p,e):n[p],o>0&&rm(u)?(c=im(u),f=am(t,e,u,c,f,o-1)-1):(om(f+1),t[f]=u),f++),p++;return f},um=am,cm=um,fm=hi,pm=Us,lm=bs,hm=qv;Aa({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=fm(this),n=pm(e),r=hm(e,0);return r.length=cm(r,e,e,n,0,void 0===t?1:lm(t)),r}});var dm=um,vm=$r,ym=hi,mm=Us,gm=qv;Aa({target:"Array",proto:!0},{flatMap:function(t){var e,n=ym(this),r=mm(n);return vm(t),(e=gm(n,0)).length=dm(e,n,n,r,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var Em=My.forEach,wm=xy("forEach")?[].forEach:function(t){return Em(this,t,arguments.length>1?arguments[1]:void 0)};Aa({target:"Array",proto:!0,forced:[].forEach!=wm},{forEach:wm});var Tm=Gs.includes,_m=Gc;Aa({target:"Array",proto:!0,forced:Kn((function(){return!Array(1).includes()}))},{includes:function(t){return Tm(this,t,arguments.length>1?arguments[1]:void 0)}}),_m("includes");var Im=Aa,Am=Gs.indexOf,Nm=xy,Om=ar([].indexOf),Rm=!!Om&&1/Om([1],1,-0)<0,bm=Nm("indexOf");Im({target:"Array",proto:!0,forced:Rm||!bm},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return Rm?Om(this,t,e)||0:Am(this,t,e)}});var Sm=Aa,Mm=yr,Cm=Tr,xm=xy,Pm=ar([].join),km=Mm!=Object,Um=xm("join",",");Sm({target:"Array",proto:!0,forced:km||!Um},{join:function(t){return Pm(Cm(this),void 0===t?",":t)}});var Dm=gp,Lm=Tr,Fm=bs,Vm=Us,Gm=xy,jm=Math.min,Hm=[].lastIndexOf,Km=!!Hm&&1/[1].lastIndexOf(1,-0)<0,Bm=Gm("lastIndexOf"),zm=Km||!Bm?function(t){if(Km)return Dm(Hm,this,arguments)||0;var e=Lm(this),n=Vm(e),r=n-1;for(arguments.length>1&&(r=jm(r,Fm(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}:Hm;Aa({target:"Array",proto:!0,forced:zm!==[].lastIndexOf},{lastIndexOf:zm});var Jm=My.map;Aa({target:"Array",proto:!0,forced:!$v("map")},{map:function(t){return Jm(this,t,arguments.length>1?arguments[1]:void 0)}});var qm=Aa,Ym=hi,Xm=Us,Wm=jv,$m=Kn((function(){return 4294967297!==[].push.call({length:4294967296},1)})),Zm=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();qm({target:"Array",proto:!0,arity:1,forced:$m||Zm},{push:function(t){var e=Ym(this),n=Xm(e),r=arguments.length;Wm(n+r);for(var i=0;i<r;i++)e[n]=arguments[i],n++;return e.length=n,n}});var Qm=$r,tg=hi,eg=yr,ng=Us,rg=TypeError,ig=function(t){return function(e,n,r,i){Qm(n);var o=tg(e),s=eg(o),a=ng(o),u=t?a-1:0,c=t?-1:1;if(r<2)for(;;){if(u in s){i=s[u],u+=c;break}if(u+=c,t?u<0:a<=u)throw rg("Reduce of empty array with no initial value")}for(;t?u>=0:a>u;u+=c)u in s&&(i=n(i,s[u],u,o));return i}},og={left:ig(!1),right:ig(!0)},sg=og.left,ag=Dr,ug=Uf;Aa({target:"Array",proto:!0,forced:!xy("reduce")||!ug&&ag>79&&ag<83},{reduce:function(t){var e=arguments.length;return sg(this,t,e,e>1?arguments[1]:void 0)}});var cg=og.right,fg=Dr,pg=Uf;Aa({target:"Array",proto:!0,forced:!xy("reduceRight")||!pg&&fg>79&&fg<83},{reduceRight:function(t){return cg(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var lg=Aa,hg=xv,dg=ar([].reverse),vg=[1,2];lg({target:"Array",proto:!0,forced:String(vg)===String(vg.reverse())},{reverse:function(){return hg(this)&&(this.length=this.length),dg(this)}});var yg=Aa,mg=xv,gg=ap,Eg=Ar,wg=xs,Tg=Us,_g=Tr,Ig=Ev,Ag=xi,Ng=Ep,Og=$v("slice"),Rg=Ag("species"),bg=Array,Sg=Math.max;yg({target:"Array",proto:!0,forced:!Og},{slice:function(t,e){var n,r,i,o=_g(this),s=Tg(o),a=wg(t,s),u=wg(void 0===e?s:e,s);if(mg(o)&&(n=o.constructor,(gg(n)&&(n===bg||mg(n.prototype))||Eg(n)&&null===(n=n[Rg]))&&(n=void 0),n===bg||void 0===n))return Ng(o,a,u);for(r=new(void 0===n?bg:n)(Sg(u-a,0)),i=0;a<u;a++,i++)a in o&&Ig(r,i,o[a]);return r.length=i,r}});var Mg=My.some;Aa({target:"Array",proto:!0,forced:!xy("some")},{some:function(t){return Mg(this,t,arguments.length>1?arguments[1]:void 0)}});var Cg=xs,xg=Us,Pg=Ev,kg=Array,Ug=Math.max,Dg=function(t,e,n){for(var r=xg(t),i=Cg(e,r),o=Cg(void 0===n?r:n,r),s=kg(Ug(o-i,0)),a=0;i<o;i++,a++)Pg(s,a,t[i]);return s.length=a,s},Lg=Dg,Fg=Math.floor,Vg=function(t,e){var n=t.length,r=Fg(n/2);return n<8?Gg(t,e):jg(t,Vg(Lg(t,0,r),e),Vg(Lg(t,r),e),e)},Gg=function(t,e){for(var n,r,i=t.length,o=1;o<i;){for(r=o,n=t[o];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==o++&&(t[r]=n)}return t},jg=function(t,e,n,r){for(var i=e.length,o=n.length,s=0,a=0;s<i||a<o;)t[s+a]=s<i&&a<o?r(e[s],n[a])<=0?e[s++]:n[a++]:s<i?e[s++]:n[a++];return t},Hg=Vg,Kg=Sr.match(/firefox\/(\d+)/i),Bg=!!Kg&&+Kg[1],zg=/MSIE|Trident/.test(Sr),Jg=Sr.match(/AppleWebKit\/(\d+)\./),qg=!!Jg&&+Jg[1],Yg=Aa,Xg=ar,Wg=$r,$g=hi,Zg=Us,Qg=vy,tE=hc,eE=Kn,nE=Hg,rE=xy,iE=Bg,oE=zg,sE=Dr,aE=qg,uE=[],cE=Xg(uE.sort),fE=Xg(uE.push),pE=eE((function(){uE.sort(void 0)})),lE=eE((function(){uE.sort(null)})),hE=rE("sort"),dE=!eE((function(){if(sE)return sE<70;if(!(iE&&iE>3)){if(oE)return!0;if(aE)return aE<603;var t,e,n,r,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)uE.push({k:e+r,v:n})}for(uE.sort((function(t,e){return e.v-t.v})),r=0;r<uE.length;r++)e=uE[r].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));Yg({target:"Array",proto:!0,forced:pE||!lE||!hE||!dE},{sort:function(t){void 0!==t&&Wg(t);var e=$g(this);if(dE)return void 0===t?cE(e):cE(e,t);var n,r,i=[],o=Zg(e);for(r=0;r<o;r++)r in e&&fE(i,e[r]);for(nE(i,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:tE(e)>tE(n)?1:-1}}(t)),n=i.length,r=0;r<n;)e[r]=i[r++];for(;r<o;)Qg(e,r++);return e}}),Gf("Array");var vE=Aa,yE=hi,mE=xs,gE=bs,EE=Us,wE=jv,TE=qv,_E=Ev,IE=vy,AE=$v("splice"),NE=Math.max,OE=Math.min;vE({target:"Array",proto:!0,forced:!AE},{splice:function(t,e){var n,r,i,o,s,a,u=yE(this),c=EE(u),f=mE(t,c),p=arguments.length;for(0===p?n=r=0:1===p?(n=0,r=c-f):(n=p-2,r=OE(NE(gE(e),0),c-f)),wE(c+n-r),i=TE(u,r),o=0;o<r;o++)(s=f+o)in u&&_E(i,o,u[s]);if(i.length=r,n<r){for(o=f;o<c-r;o++)a=o+n,(s=o+r)in u?u[a]=u[s]:IE(u,a);for(o=c;o>c-r+n;o--)IE(u,o-1)}else if(n>r)for(o=c-r;o>f;o--)a=o+n-1,(s=o+r-1)in u?u[a]=u[s]:IE(u,a);for(o=0;o<n;o++)u[o+f]=arguments[o+2];return u.length=c-r+n,i}}),Gc("flat"),Gc("flatMap");var RE=Aa,bE=hi,SE=Us,ME=vy,CE=jv,xE=1!==[].unshift(0),PE=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();RE({target:"Array",proto:!0,arity:1,forced:xE||PE},{unshift:function(t){var e=bE(this),n=SE(e),r=arguments.length;if(r){CE(n+r);for(var i=n;i--;){var o=i+r;i in e?e[o]=e[i]:ME(e,o)}for(var s=0;s<r;s++)e[s]=arguments[s]}return e.length=n+r}}),$d.Array;var kE={exports:{}},UE={},DE=pr,LE=Tr,FE=As.f,VE=Dg,GE="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];UE.f=function(t){return GE&&"Window"==DE(t)?function(t){try{return FE(t)}catch(t){return VE(GE)}}(t):FE(LE(t))};var jE=Kn((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),HE=Kn,KE=Ar,BE=pr,zE=jE,JE=Object.isExtensible,qE=HE((function(){JE(1)}))||zE?function(t){return!!KE(t)&&(!zE||"ArrayBuffer"!=BE(t))&&(!JE||JE(t))}:JE,YE=!Kn((function(){return Object.isExtensible(Object.preventExtensions({}))})),XE=Aa,WE=ar,$E=Ko,ZE=Ar,QE=yi,tw=ro.f,ew=As,nw=UE,rw=qE,iw=YE,ow=!1,sw=Ti("meta"),aw=0,uw=function(t){tw(t,sw,{value:{objectID:"O"+aw++,weakData:{}}})},cw=kE.exports={enable:function(){cw.enable=function(){},ow=!0;var t=ew.f,e=WE([].splice),n={};n[sw]=1,t(n).length&&(ew.f=function(n){for(var r=t(n),i=0,o=r.length;i<o;i++)if(r[i]===sw){e(r,i,1);break}return r},XE({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:nw.f}))},fastKey:function(t,e){if(!ZE(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!QE(t,sw)){if(!rw(t))return"F";if(!e)return"E";uw(t)}return t[sw].objectID},getWeakData:function(t,e){if(!QE(t,sw)){if(!rw(t))return!0;if(!e)return!1;uw(t)}return t[sw].weakData},onFreeze:function(t){return iw&&ow&&rw(t)&&!QE(t,sw)&&uw(t),t}};$E[sw]=!0;var fw=_r,pw=Ar,lw=Va,hw=Aa,dw=jn,vw=ar,yw=ya,mw=Is,gw=kE.exports,Ew=fc,ww=Kf,Tw=_r,_w=Ar,Iw=Kn,Aw=Gh,Nw=Zc,Ow=Is,Rw=function(t,e,n){for(var r in e)Ow(t,r,e[r],n);return t},bw=ro.f,Sw=cu,Mw=Rw,Cw=wu,xw=Kf,Pw=fc,kw=Tf,Uw=Gf,Dw=Bn,Lw=kE.exports.fastKey,Fw=ss.set,Vw=ss.getterFor,Gw={getConstructor:function(t,e,n,r){var i=t((function(t,i){xw(t,o),Fw(t,{type:e,index:Sw(null),first:void 0,last:void 0,size:0}),Dw||(t.size=0),null!=i&&Pw(i,t[r],{that:t,AS_ENTRIES:n})})),o=i.prototype,s=Vw(e),a=function(t,e,n){var r,i,o=s(t),a=u(t,e);return a?a.value=n:(o.last=a={index:i=Lw(e,!0),key:e,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),Dw?o.size++:t.size++,"F"!==i&&(o.index[i]=a)),t},u=function(t,e){var n,r=s(t),i=Lw(e);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==e)return n};return Mw(o,{clear:function(){for(var t=s(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,Dw?t.size=0:this.size=0},delete:function(t){var e=this,n=s(e),r=u(e,t);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),Dw?n.size--:e.size--}return!!r},forEach:function(t){for(var e,n=s(this),r=Cw(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!u(this,t)}}),Mw(o,n?{get:function(t){var e=u(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),Dw&&bw(o,"size",{get:function(){return s(this).size}}),i},setStrong:function(t,e,n){var r=e+" Iterator",i=Vw(e),o=Vw(r);kw(t,e,(function(t,e){Fw(this,{type:r,target:t,state:i(t),kind:e,last:void 0})}),(function(){for(var t=o(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),Uw(e)}};!function(t,e,n){var r=-1!==t.indexOf("Map"),i=-1!==t.indexOf("Weak"),o=r?"set":"add",s=dw[t],a=s&&s.prototype,u=s,c={},f=function(t){var e=vw(a[t]);mw(a,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(i&&!_w(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return i&&!_w(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(i&&!_w(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})};if(yw(t,!Tw(s)||!(i||a.forEach&&!Iw((function(){(new s).entries().next()})))))u=n.getConstructor(e,t,r,o),gw.enable();else if(yw(t,!0)){var p=new u,l=p[o](i?{}:-0,1)!=p,h=Iw((function(){p.has(1)})),d=Aw((function(t){new s(t)})),v=!i&&Iw((function(){for(var t=new s,e=5;e--;)t[o](e,e);return!t.has(-0)}));d||((u=e((function(t,e){ww(t,a);var n=function(t,e,n){var r,i;return lw&&fw(r=e.constructor)&&r!==n&&pw(i=r.prototype)&&i!==n.prototype&&lw(t,i),t}(new s,t,u);return null!=e&&Ew(e,n[o],{that:n,AS_ENTRIES:r}),n}))).prototype=a,a.constructor=u),(h||v)&&(f("delete"),f("has"),r&&f("get")),(v||l)&&f(o),i&&a.clear&&delete a.clear}c[t]=u,hw({global:!0,constructor:!0,forced:u!=s},c),Nw(u,t),i||n.setStrong(u,t,r)}("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),Gw);var jw=Us,Hw=function(t,e){for(var n=0,r=jw(e),i=new t(r);r>n;)i[n]=e[n++];return i},Kw=wu,Bw=yr,zw=hi,Jw=ji,qw=Us,Yw=cu,Xw=Hw,Ww=Array,$w=ar([].push),Zw=function(t,e,n,r){for(var i,o,s,a=zw(t),u=Bw(a),c=Kw(e,n),f=Yw(null),p=qw(u),l=0;p>l;l++)s=u[l],(o=Jw(c(s,l,a)))in f?$w(f[o],s):f[o]=[s];if(r&&(i=r(a))!==Ww)for(o in f)f[o]=Xw(i,f[o]);return f},Qw=Zw,tT=Gc;Aa({target:"Array",proto:!0},{group:function(t){return Qw(this,t,arguments.length>1?arguments[1]:void 0)}}),tT("group");var eT=Zw,nT=Gc;Aa({target:"Array",proto:!0,forced:!xy("groupBy")},{groupBy:function(t){return eT(this,t,arguments.length>1?arguments[1]:void 0)}}),nT("groupBy");var rT=wu,iT=ar,oT=yr,sT=hi,aT=Us,uT=Rr("Map"),cT=uT.prototype,fT=iT(cT.get),pT=iT(cT.has),lT=iT(cT.set),hT=iT([].push),dT=function(t){for(var e,n,r=sT(this),i=oT(r),o=rT(t,arguments.length>1?arguments[1]:void 0),s=new uT,a=aT(i),u=0;a>u;u++)e=o(n=i[u],u,r),pT(s,e)?hT(fT(s,e),n):lT(s,e,[n]);return s},vT=Gc,yT=dT;Aa({target:"Array",proto:!0,name:"groupToMap",forced:!xy("groupByToMap")},{groupByToMap:yT}),vT("groupByToMap");var mT=Gc;Aa({target:"Array",proto:!0},{groupToMap:dT}),mT("groupToMap");var gT=Us,ET=Tr,wT=Gc,TT=Array;Aa({target:"Array",proto:!0},{toReversed:function(){return function(t,e){for(var n=gT(t),r=new e(n),i=0;i<n;i++)r[i]=t[n-i-1];return r}(ET(this),TT)}}),wT("toReversed");var _T=jn,IT=function(t){return _T[t].prototype},AT=Aa,NT=$r,OT=Tr,RT=Hw,bT=Gc,ST=Array,MT=ar(IT("Array").sort);AT({target:"Array",proto:!0},{toSorted:function(t){void 0!==t&&NT(t);var e=OT(this),n=RT(ST,e);return MT(n,t)}}),bT("toSorted");var CT=Aa,xT=Gc,PT=jv,kT=Us,UT=xs,DT=Tr,LT=bs,FT=Array,VT=Math.max,GT=Math.min;CT({target:"Array",proto:!0},{toSpliced:function(t,e){var n,r,i,o,s=DT(this),a=kT(s),u=UT(t,a),c=arguments.length,f=0;for(0===c?n=r=0:1===c?(n=0,r=a-u):(n=c-2,r=GT(VT(LT(e),0),a-u)),i=PT(a+n-r),o=FT(i);f<u;f++)o[f]=s[f];for(;f<u+n;f++)o[f]=arguments[f-u+2];for(;f<i;f++)o[f]=s[f+r-n];return o}}),xT("toSpliced");var jT=Us,HT=bs,KT=RangeError,BT=Tr,zT=Array;Aa({target:"Array",proto:!0},{with:function(t,e){return function(t,e,n,r){var i=jT(t),o=HT(n),s=o<0?i+o:o;if(s>=i||s<0)throw KT("Incorrect index");for(var a=new e(i),u=0;u<i;u++)a[u]=u===s?r:t[u];return a}(BT(this),zT,t,e)}});var JT,qT,YT=jn,XT=ci,WT=_r,$T=Pa,ZT=Is,QT=xi("asyncIterator"),t_=YT.AsyncIterator,e_=XT.AsyncIteratorPrototype;if(e_)JT=e_;else if(WT(t_))JT=t_.prototype;else if(XT.USE_FUNCTION_CONSTRUCTOR||YT.USE_FUNCTION_CONSTRUCTOR)try{qT=$T($T($T(Function("return async function*(){}()")()))),$T(qT)===Object.prototype&&(JT=qT)}catch(L){}JT||(JT={}),WT(JT[QT])||ZT(JT,QT,(function(){return this}));var n_=Yn,r_=uo,i_=cu,o_=Qr,s_=Rw,a_=ss,u_=JT,c_=Rr("Promise"),f_=a_.set,p_=a_.getterFor("AsyncFromSyncIterator"),l_=function(t,e,n){var r=t.done;c_.resolve(t.value).then((function(t){e({done:r,value:t})}),n)},h_=function(t){f_(this,{type:"AsyncFromSyncIterator",iterator:r_(t),next:t.next})};h_.prototype=s_(i_(u_),{next:function(){var t=p_(this);return new c_((function(e,n){var r=r_(n_(t.next,t.iterator));l_(r,e,n)}))},return:function(){var t=p_(this).iterator;return new c_((function(e,n){var r=o_(t,"return");if(void 0===r)return e({done:!0,value:void 0});var i=r_(n_(r,t));l_(i,e,n)}))}});var d_=h_,v_=Yn,y_=d_,m_=uo,g_=Ju,E_=Qr,w_=xi("asyncIterator"),T_=$r,__=uo,I_=Yn,A_=Rr,N_=Qr,O_=Yn,R_=$r,b_=uo,S_=jv,M_=Rr,C_=function(t,e,n,r){try{var i=N_(t,"return");if(i)return A_("Promise").resolve(I_(i,t)).then((function(){e(n)}),(function(t){r(t)}))}catch(t){return r(t)}e(n)},x_=function(t){var e=0==t,n=1==t,r=2==t,i=3==t;return function(t,o,s){var a=function(t){return{iterator:t,next:T_(__(t).next)}}(t),u=M_("Promise"),c=a.iterator,f=a.next,p=0,l=void 0!==o;return!l&&e||R_(o),new u((function(t,a){var h=function(t){C_(c,a,t,a)},d=function(){try{if(e&&l)try{S_(p)}catch(t){h(t)}u.resolve(b_(O_(f,c))).then((function(f){try{if(b_(f).done)e?(s.length=p,t(s)):t(!i&&(r||void 0));else{var v=f.value;try{l?u.resolve(e?o(v,p):o(v)).then((function(o){if(n)d();else if(r)o?d():C_(c,t,!1,a);else if(e)try{s[p++]=o,d()}catch(t){h(t)}else o?C_(c,t,i||v,a):d()}),h):(s[p++]=v,d())}catch(t){h(t)}}}catch(t){a(t)}}),a)}catch(t){a(t)}};d()}))}},P_={toArray:x_(0),forEach:x_(1),every:x_(2),some:x_(3),find:x_(4)},k_=wu,U_=hi,D_=ap,L_=Ju,F_=Vu,V_=Qr,G_=IT,j_=Rr,H_=d_,K_=P_.toArray,B_=xi("asyncIterator"),z_=G_("Array").values;Aa({target:"Array",stat:!0,forced:!0},{fromAsync:function(t){var e=this,n=arguments.length,r=n>1?arguments[1]:void 0,i=n>2?arguments[2]:void 0;return new(j_("Promise"))((function(n){var o=U_(t);void 0!==r&&(r=k_(r,i));var s=V_(o,B_),a=s?void 0:F_(o)||z_,u=D_(e)?new e:[],c=s?function(t,e){var n=arguments.length<2?E_(t,w_):e;return n?m_(v_(n,t)):new y_(g_(t))}(o,s):new H_(L_(o,a));n(K_(c,r,u))}))}});var J_=My.filterReject,q_=Gc;Aa({target:"Array",proto:!0,forced:!0},{filterOut:function(t){return J_(this,t,arguments.length>1?arguments[1]:void 0)}}),q_("filterOut");var Y_=My.filterReject,X_=Gc;Aa({target:"Array",proto:!0,forced:!0},{filterReject:function(t){return Y_(this,t,arguments.length>1?arguments[1]:void 0)}}),X_("filterReject");var W_=Aa,$_=xv,Z_=Object.isFrozen,Q_=function(t,e){if(!Z_||!$_(t)||!Z_(t))return!1;for(var n,r=0,i=t.length;r<i;)if(!("string"==typeof(n=t[r++])||e&&void 0===n))return!1;return 0!==i};W_({target:"Array",stat:!0,sham:!0,forced:!0},{isTemplateObject:function(t){if(!Q_(t,!0))return!1;var e=t.raw;return e.length===t.length&&Q_(e,!1)}});var tI=To.exports,eI=ro,nI=function(t,e,n){return n.get&&tI(n.get,e,{getter:!0}),n.set&&tI(n.set,e,{setter:!0}),eI.f(t,e,n)},rI=Gc,iI=hi,oI=Us;Bn&&(nI(Array.prototype,"lastItem",{configurable:!0,get:function(){var t=iI(this),e=oI(t);return 0==e?void 0:t[e-1]},set:function(t){var e=iI(this),n=oI(e);return e[0==n?0:n-1]=t}}),rI("lastItem"));var sI=Gc,aI=hi,uI=Us;Bn&&(nI(Array.prototype,"lastIndex",{configurable:!0,get:function(){var t=aI(this),e=uI(t);return 0==e?0:e-1}}),sI("lastIndex"));var cI=ar,fI=$r,pI=Us,lI=hi,hI=qv,dI=Rr("Map"),vI=dI.prototype,yI=cI(vI.forEach),mI=cI(vI.has),gI=cI(vI.set),EI=cI([].push),wI=Gc;Aa({target:"Array",proto:!0,forced:!0},{uniqueBy:function(t){var e,n,r,i=lI(this),o=pI(i),s=hI(i,0),a=new dI,u=null!=t?fI(t):function(t){return t};for(e=0;e<o;e++)r=u(n=i[e]),mI(a,r)||gI(a,r,n);return yI(a,(function(t){EI(s,t)})),s}}),wI("uniqueBy");var TI,_I=function(){function t(t){var e=t.timeout,n=t.callback;this.timeout=Math.max(e,0),this.callback=n}return t.prototype.start=function(){this.timeoutId=setTimeout(this.callback,this.timeout)},t.prototype.refresh=function(){this.stop(),this.start()},t.prototype.stop=function(){this.timeoutId&&clearTimeout(this.timeoutId)},t}(),II=function(){function t(t,e,n){this.buffer=[],this.sink=t,this.maxQueueSize=e,this.timer=new _I({callback:this.flush.bind(this),timeout:n}),this.started=!1}return t.prototype.start=function(){this.started=!0},t.prototype.stop=function(){this.started=!1;var t=this.sink(this.buffer,!0);return this.buffer=[],this.timer.stop(),t},t.prototype.enqueue=function(t){this.started&&(0===this.buffer.length&&this.timer.refresh(),this.buffer.push(t),this.buffer.length>=this.maxQueueSize&&this.flush())},t.prototype.flush=function(){this.sink(this.buffer),this.buffer=[],this.timer.stop()},t.prototype.close=function(){this.stop()},t}(),AI=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.eventDispatcher=e,o.flushInterval=r,o.queue=new II(o.drainQueue.bind(o),n,r),o.repository=i,o}return V(e,t),e.prototype.isClientError=function(t){return!!(t&&t.statusCode>=400&&t.statusCode<500)},e.prototype.drainRepository=function(t){var e=this;return new Promise((function(n){return j(e,void 0,void 0,(function(){var e,r,i=this;return H(this,(function(o){switch(o.label){case 0:return[4,null===(r=this.repository)||void 0===r?void 0:r.read()];case 1:return(e=o.sent())&&0!==e.length?(t?this.eventDispatcher.dispatchXhrOrBeacon(e,(function(){var t;n(null===(t=i.repository)||void 0===t?void 0:t.delete(e))}),(function(t){var r;i.isClientError(t)?n(null===(r=i.repository)||void 0===r?void 0:r.delete(e)):n()})):this.eventDispatcher.dispatch(e,(function(){var t;n(null===(t=i.repository)||void 0===t?void 0:t.delete(e))}),(function(t){var r;i.isClientError(t)?n(null===(r=i.repository)||void 0===r?void 0:r.delete(e)):n()})),[2]):(n(),[2])}}))}))}))},e.prototype.drainQueue=function(t,e){var n=this,r=t.map((function(t){return t.toDto()})),i=new Promise((function(i){return j(n,void 0,void 0,(function(){var n,o=this;return H(this,(function(s){return 0===t.length?(i(),[2]):(e?(null===(n=this.repository)||void 0===n||n.add(r),this.eventDispatcher.dispatchXhrOrBeacon(t,(function(){var t;i(null===(t=o.repository)||void 0===t?void 0:t.delete(r))}),(function(t){var e;o.isClientError(t)?i(null===(e=o.repository)||void 0===e?void 0:e.delete(r)):i()}))):this.eventDispatcher.dispatch(t,(function(){i()}),(function(t){var e;o.isClientError(t)?i():i(null===(e=o.repository)||void 0===e?void 0:e.add(r))})),[2])}))}))}));return i},e.prototype.process=function(t){this.queue.enqueue(t),this.emit("event",t)},e.prototype.start=function(){return j(this,void 0,void 0,(function(){return H(this,(function(t){return this.queue.start(),[2]}))}))},e.prototype.stop=function(){try{this.queue.close()}catch(t){}return Promise.resolve()},e.prototype.flush=function(){this.queue.flush()},e.prototype.close=function(){this.stop()},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e}(function(){function t(){this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]=(this.listeners[t]||[]).concat(e)},t.prototype.off=function(t,e){this.listeners[t]=(this.listeners[t]||[]).filter((function(t){return t!==e}))},t.prototype.emit=function(t,e){(this.listeners[t]||[]).forEach((function(t){t(e)}))},t}())),NI=function(){function t(t,e){this.hackleUserResolver=t,this.core=e}return t.isSessionEvent=function(e){return!!dn.isTrack(e)&&(e.event.key===t.SESSION_START_EVENT_NAME||e.event.key===t.SESSION_END_EVENT_NAME)},t.prototype.onSessionStarted=function(e,n,r){this.track(t.SESSION_START_EVENT_NAME,e,n,r)},t.prototype.onSessionEnded=function(e,n,r){this.track(t.SESSION_END_EVENT_NAME,e,n,r)},t.prototype.track=function(t,e,n,r){var i={key:t,properties:{sessionId:e}},o=this.hackleUserResolver.resolve(n),s=this.decorateSession(o,e);this.core.track(i,s,r)},t.prototype.decorateSession=function(t,e){var n=(new It).add(_t.SESSION,e).addIdentifiers(t.identifiers).build();return G(G({},t),{identifiers:n})},t.SESSION_START_EVENT_NAME="$session_start",t.SESSION_END_EVENT_NAME="$session_end",t}(),OI=function(t){function e(e,n,r,i,o,s,a){void 0===i&&(i=null);var u=t.call(this,e,n,r,i)||this;return u.exposureEventDedupDeterminer=o,u.sessionManager=s,u.userManager=a,u}return V(e,t),e.prototype.process=function(e){if(NI.isSessionEvent(e)||this.sessionManager.startNewSessionIfNeeded(this.userManager.currentUser,e.timestamp),!this.exposureEventDedupDeterminer.isDedupTarget(e)){var n=function(t,e){var n;return null===e.currentSessionId||t.user.identifiers[_t.SESSION]?t:t.copyWithUser(G(G({},t.user),{identifiers:G(G({},t.user.identifiers),(n={},n[_t.SESSION]=e.sessionId,n))}))}(e,this.sessionManager);t.prototype.process.call(this,n)}},e}(AI),RI=function(){function t(t){this.cache=new Map,this.exposureEventDedupIntervalMillis=t}return t.prototype.isDedupTarget=function(t){var e;if(-1===this.exposureEventDedupIntervalMillis)return!1;if(!dn.isExposure(t))return!1;et.isEquals(t.user.identifiers,null===(e=this.currentUser)||void 0===e?void 0:e.identifiers)||(this.currentUser=t.user,this.cache=new Map);var n=[t.experiment.id,t.variationId,t.variationKey,t.decisionReason].join("-"),r=(new Date).getTime(),i=this.cache.get(n);return void 0!==i&&r-i<=this.exposureEventDedupIntervalMillis||(this.cache.set(n,r),!1)},t}(),bI=function(){function t(){}return t.toEvent=function(e){var n;return{key:t.EVENT_KEY,properties:{level:t.LEVEL_ERROR,type:e.name,message:null!==(n=e.message)&&void 0!==n?n:"",$stacktrace:t._stacktrace(e)}}},t._stacktrace=function(e){return B.isNullOrUndefined(e.stack)?"":e.stack.split("\n").slice(0,t.STACK_TRACK_LIMIT).join("\n")},t.EVENT_KEY="$trace",t.LEVEL_ERROR="error",t.STACK_TRACK_LIMIT=30,t}(),SI=function(){function t(){}return t.prototype.evaluate=function(t,e){if(!this.supports(t))throw new Error("Unsupported EvaluatorRequest ".concat(t.toString()));if(e.contains(t)){var n=e.stack.map((function(t){return t.toString()})).join(" - ");throw new Error("Circular evaluation has occurred [".concat(n," - ").concat(t.toString(),"]"))}e.addRequest(t);try{return this.evaluateInternal(t,e)}finally{e.removeRequest(t)}},t}(),MI=function(){function t(t,e,n,r,i,o){this.reason=t,this.targetEvaluations=e,this.experiment=n,this.variationId=r,this.variationKey=i,this.config=o}return t.prototype.with=function(e){return new t(e,this.targetEvaluations,this.experiment,this.variationId,this.variationKey,this.config)},t.of=function(e,n,r,i){var o=this.config(e.workspace,r);return new t(i,n.targetEvaluations,e.experiment,r.id,r.key,o)},t.ofDefault=function(e,n,r){var i=e.experiment._getVariationByKeyOrNull(e.defaultVariationKey);return B.isNotNullOrUndefined(i)?this.of(e,n,i,r):new t(r,n.targetEvaluations,e.experiment,void 0,e.defaultVariationKey,void 0)},t.config=function(t,e){if(!B.isNullOrUndefined(e.parameterConfigurationId))return B.requiredNotNullOrUndefined(t.getParameterConfigurationOrNull(e.parameterConfigurationId),(function(){return"ParameterConfiguration[".concat(e.parameterConfigurationId,"]")}))},t}(),CI=function(t){function e(e){var n=t.call(this)||this;return n.evaluationFlowFactory=e,n}return V(e,t),e.prototype.supports=function(t){return void 0!==t.experiment},e.prototype.evaluateInternal=function(t,e){var n;return null!==(n=this.evaluationFlowFactory.getExperimentFlow(t.experiment.type).evaluate(t,e))&&void 0!==n?n:MI.ofDefault(t,e,yt.TRAFFIC_NOT_ALLOCATED)},e}(SI),xI=function(){function t(t,e,n,r,i,o){this.reason=t,this.targetEvaluations=e,this.parameter=n,this.valueId=r,this.value=i,this.properties=o}return t.of=function(e,n,r,i,o,s){return s.returnValue=i,new t(o,n.targetEvaluations,e.parameter,r,i,s)},t.ofDefault=function(t,e,n,r){return this.of(t,e,void 0,t.defaultValue,n,r)},t}(),PI=function(t){function e(e){var n=t.call(this)||this;return n.targetRuleDeterminer=e,n}return V(e,t),e.prototype.supports=function(t){return void 0!==t.parameter},e.prototype.evaluateInternal=function(t,e){var n={};if(n.requestValueType=t.requiredType,n.requestDefaultValue=t.defaultValue,B.isNullOrUndefined(t.user.identifiers[t.parameter.identifierType]))return xI.ofDefault(t,e,yt.IDENTIFIER_NOT_FOUND,n);var r=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);return B.isNotNullOrUndefined(r)?(n.targetRuleKey=r.key,n.targetRuleName=r.name,this.evaluation(t,e,r.value,yt.TARGET_RULE_MATCH,n)):this.evaluation(t,e,t.parameter.defaultValue,yt.DEFAULT_RULE,n)},e.prototype.evaluation=function(t,e,n,r,i){return"UNKNOWN"===t.requiredType||"NULL"!==t.requiredType&&typeof t.defaultValue!=typeof n.rawValue?xI.ofDefault(t,e,yt.TYPE_MISMATCH,i):xI.of(t,e,n.id,n.rawValue,r,i)},e}(SI),kI=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isEquals=function(t){return this.type===t.type&&this.id===t.id},t}(),UI=function(){function t(){this._stack=[],this._targetEvaluations=[]}return t.create=function(){return new t},Object.defineProperty(t.prototype,"stack",{get:function(){return Array.from(this._stack)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetEvaluations",{get:function(){return Array.from(this._targetEvaluations)},enumerable:!1,configurable:!0}),t.prototype.contains=function(t){return this._stack.some((function(e){return e.key.isEquals(t.key)}))},t.prototype.addRequest=function(t){this._stack.push(t)},t.prototype.removeRequest=function(t){var e=this._stack.indexOf(t,0);e>-1&&this._stack.splice(e,1)},t.prototype.get=function(t){return this._targetEvaluations.find((function(e){return e instanceof MI&&e.experiment.id===t.id}))},t.prototype.addEvaluation=function(t){this._targetEvaluations.push(t)},t}(),DI=function(){function t(t,e,n,r){this.key=new kI("EXPERIMENT",n.id),this.workspace=t,this.user=e,this.experiment=n,this.defaultVariationKey=r}return t.of=function(e,n,r,i){return new t(e,n,r,i)},t.by=function(e,n){return new t(e.workspace,e.user,n,"A")},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.experiment.type,", key=").concat(this.experiment.key,")")},t}(),LI=function(){function t(t,e,n,r,i){this.key=new kI("REMOTE_CONFIG",n.id),this.workspace=t,this.user=e,this.parameter=n,this.requiredType=r,this.defaultValue=i}return t.of=function(e,n,r,i,o){return new t(e,n,r,i,o)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.parameter.key,")")},t}(),FI=function(){function t(){}return t.asString=function(t){switch(typeof t){case"string":return t;case"number":return t.toString();default:return}},t.asNumber=function(t){switch(typeof t){case"number":return this.asActualNumber(t);case"string":return this.asActualNumber(Number(t));default:return}},t.asActualNumber=function(t){return!isNaN(t)&&isFinite(t)?t:void 0},t}(),VI=function(){function t(t){this.storages=t}return t.prototype.getVariation=function(t,e){if(0!==this.storages.length)for(var n=0,r=this.storages;n<r.length;n++){var i=r[n].getVariation(t,e);if(void 0!==i)return i}},t}(),GI=function(){function t(t){this.listStorage=t}return t.prototype.getVariation=function(t,e){var n=this.get(t);if(n)return t._getVariationByIdOrNull(n)},t.prototype.get=function(t){var e=this.listStorage.getItem(t.id.toString());return FI.asNumber(e)},t.prototype.getAll=function(){var t=new Map;return this.listStorage.entries().forEach((function(e){var n=e[0],r=e[1],i=FI.asNumber(n),o=FI.asNumber(r);B.isNullOrUndefined(i)||i<0||B.isNullOrUndefined(o)||i<0||t.set(i,o)})),t},t.prototype.set=function(t,e){this.listStorage.setItem(t.id.toString(),e.toString())},t.prototype.remove=function(t){this.listStorage.removeItem(t.id.toString())},t.prototype.clear=function(){this.listStorage.clear()},t}(),jI=function(){function t(){this.evaluators=new Array}return t.prototype.add=function(t){this.evaluators.push(t)},t.prototype.evaluate=function(t,e){var n=this.evaluators.find((function(e){return e.supports(t)}));if(B.isNullOrUndefined(n))throw new Error("Unsupported EvaluatorRequest [".concat(t.toString(),"]"));return n.evaluate(t,e)},t}(),HI=function(){function t(t){this.conditionMatcherFactory=t}return t.prototype.matches=function(t,e,n){var r=this;return n.conditions.every((function(n){return r._matches(t,e,n)}))},t.prototype.anyMatches=function(t,e,n){var r=this;return!n.length||n.some((function(n){return r.matches(t,e,n)}))},t.prototype._matches=function(t,e,n){return this.conditionMatcherFactory.getMatcher(n.key.type).matches(t,e,n)},t}(),KI=function(){function t(t,e){this.valueMatcherFactory=t,this.operatorMatcherFactory=e}return t.prototype.matches=function(t,e){var n=this.valueMatcherFactory.getMatcher(e.valueType),r=this.operatorMatcherFactory.getMatcher(e.operator),i=this.userValueMatches(t,e,n,r);return this.typeMatches(e.type,i)},t.prototype.userValueMatches=function(t,e,n,r){return Array.isArray(t)?this.arrayMatches(t,e,n,r):this.singleMatches(t,e,n,r)},t.prototype.singleMatches=function(t,e,n,r){return e.values.some((function(e){return n.matches(r,t,e)}))},t.prototype.arrayMatches=function(t,e,n,r){var i=this;return t.some((function(t){return i.singleMatches(t,e,n,r)}))},t.prototype.typeMatches=function(t,e){switch(t){case"MATCH":return e;case"NOT_MATCH":return!e}},t}(),BI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return t===e},t.prototype.numberMatches=function(t,e){return t===e},t.prototype.stringMatches=function(t,e){return t===e},t.prototype.versionMatches=function(t,e){return t.isEqualTo(e)},t}(),zI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.includes(e)},t.prototype.versionMatches=function(t,e){return!1},t}(),JI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.startsWith(e)},t.prototype.versionMatches=function(t,e){return!1},t}(),qI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.endsWith(e)},t.prototype.versionMatches=function(t,e){return!1},t}(),YI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t>e},t.prototype.stringMatches=function(t,e){return t>e},t.prototype.versionMatches=function(t,e){return t.isGreaterThan(e)},t}(),XI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t>=e},t.prototype.stringMatches=function(t,e){return t>=e},t.prototype.versionMatches=function(t,e){return t.isGreaterThanOrEqualTo(e)},t}(),WI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t<e},t.prototype.stringMatches=function(t,e){return t<e},t.prototype.versionMatches=function(t,e){return t.isLessThan(e)},t}(),$I=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t<=e},t.prototype.stringMatches=function(t,e){return t<=e},t.prototype.versionMatches=function(t,e){return t.isLessThanOrEqualTo(e)},t}(),ZI=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"IN":return t.IN_MATCHER;case"CONTAINS":return t.CONTAINS_MATCHER;case"STARTS_WITH":return t.STARTS_WITH_MATCHER;case"ENDS_WITH":return t.ENDS_WITH_MATCHER;case"GT":return t.GT_MATCHER;case"GTE":return t.GTE_MATCHER;case"LT":return t.LT_MATCHER;case"LTE":return t.LTE_MATCHER}},t.IN_MATCHER=new BI,t.CONTAINS_MATCHER=new zI,t.STARTS_WITH_MATCHER=new JI,t.ENDS_WITH_MATCHER=new qI,t.GT_MATCHER=new YI,t.GTE_MATCHER=new XI,t.LT_MATCHER=new WI,t.LTE_MATCHER=new $I,t}(),QI=function(){function t(){}return t.prototype.matches=function(t,e,n){var r=FI.asString(e),i=FI.asString(n);return!B.isNullOrUndefined(r)&&!B.isNullOrUndefined(i)&&t.stringMatches(r,i)},t}(),tA=function(){function t(){}return t.prototype.matches=function(t,e,n){var r=FI.asNumber(e),i=FI.asNumber(n);return!B.isNullOrUndefined(r)&&!B.isNullOrUndefined(i)&&t.numberMatches(r,i)},t}(),eA=function(){function t(){}return t.prototype.matches=function(t,e,n){return"boolean"==typeof e&&"boolean"==typeof n&&t.booleanMatches(e,n)},t}(),nA=function(){function t(){}return t.prototype.matches=function(t,e,n){var r=Vt.tryParse(e),i=Vt.tryParse(n);return!(!r||!i)&&t.versionMatches(r,i)},t}(),rA=function(){function t(){}return t.prototype.matches=function(t,e,n){return!1},t}(),iA=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"STRING":case"JSON":return t.STRING_MATCHER;case"NUMBER":return t.NUMBER_MATCHER;case"BOOLEAN":return t.BOOLEAN_MATCHER;case"VERSION":return t.VERSION_MATCHER;case"NULL":case"UNKNOWN":return t.NULL_MATCHER}},t.STRING_MATCHER=new QI,t.NUMBER_MATCHER=new tA,t.BOOLEAN_MATCHER=new eA,t.VERSION_MATCHER=new nA,t.NULL_MATCHER=new rA,t}(),oA=function(){function t(t,e){this.userValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,n){var r=this.userValueResolver.resolveOrNull(t.user,n.key);return!B.isNullOrUndefined(r)&&this.valueOperatorMatcher.matches(r,n.match)},t}(),sA=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){switch(e.type){case"USER_ID":return t.identifiers[e.name];case"USER_PROPERTY":return t.properties[e.name];case"HACKLE_PROPERTY":return t.hackleProperties[e.name];case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":case"EVENT_PROPERTY":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t}(),aA=function(){function t(t){this.segmentMatcher=t}return t.prototype.matches=function(t,e,n){var r=this;if("SEGMENT"!=n.key.type)throw new Error("Unsupported TargetKeyType [".concat(n.key.type,"]"));var i=n.match.values.some((function(n){return r._matches(t,e,n)}));switch(n.match.type){case"MATCH":return i;case"NOT_MATCH":return!i}},t.prototype._matches=function(t,e,n){if("string"!=typeof n)throw new Error("SegmentKey[".concat(n,"]"));var r=t.workspace.getSegmentOrNull(n);if(!r)throw new Error("Segment[".concat(n,"]"));return this.segmentMatcher.matches(t,e,r)},t}(),uA=function(){function t(t){this.userConditionMatcher=t}return t.prototype.matches=function(t,e,n){var r=this;return n.targets.some((function(n){return r._matches(t,e,n)}))},t.prototype._matches=function(t,e,n){var r=this;return n.conditions.every((function(n){return r.userConditionMatcher.matches(t,e,n)}))},t}(),cA=function(){function t(t,e){this.abTestMatcher=t,this.featureFlagMatcher=e}return t.prototype.matches=function(t,e,n){switch(n.key.type){case"AB_TEST":return this.abTestMatcher.matches(t,e,n);case"FEATURE_FLAG":return this.featureFlagMatcher.matches(t,e,n);case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"EVENT_PROPERTY":case"SEGMENT":throw new Error("Unsupported TargetKeyType [".concat(n.key.type,"]"))}},t}(),fA=function(){function t(t,e){this.evaluator=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,n){var r,i=B.requiredNotNullOrUndefined(FI.asNumber(n.key.name),(function(){return"Invalid key [".concat(n.key.type,", ").concat(n.key.name,"]")})),o=this.experiment(t,i);if(B.isNullOrUndefined(o))return!1;var s=null!==(r=e.get(o))&&void 0!==r?r:this.evaluate(t,e,o);return this.evaluationMatches(s,n)},t.prototype.evaluate=function(t,e,n){var r=DI.by(t,n),i=this.evaluator.evaluate(r,e),o=this.resolve(t,i);return e.addEvaluation(o),o},t}(),pA=function(t){function e(e,n){return t.call(this,e,n)||this}return V(e,t),e.prototype.experiment=function(t,e){return t.workspace.getExperimentOrNull(e)},e.prototype.resolve=function(t,e){return t instanceof DI&&e.reason===yt.TRAFFIC_ALLOCATED?e.with(yt.TRAFFIC_ALLOCATED_BY_TARGETING):e},e.prototype.evaluationMatches=function(t,n){return!!e.AB_TEST_MATCHED_REASONS.includes(t.reason)&&this.valueOperatorMatcher.matches(t.variationKey,n.match)},e.AB_TEST_MATCHED_REASONS=[yt.OVERRIDDEN,yt.TRAFFIC_ALLOCATED,yt.EXPERIMENT_COMPLETED,yt.TRAFFIC_ALLOCATED_BY_TARGETING],e}(fA),lA=function(t){function e(e,n){return t.call(this,e,n)||this}return V(e,t),e.prototype.experiment=function(t,e){return t.workspace.getFeatureFlagOrNull(e)},e.prototype.resolve=function(t,e){return e},e.prototype.evaluationMatches=function(t,e){var n="A"!==t.variationKey;return this.valueOperatorMatcher.matches(n,e.match)},e}(fA),hA=function(){function t(t,e){this.eventValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,n){if(!this.isEventEvaluatorRequest(t))return!1;var r=this.eventValueResolver.resolveOrNull(t.event,n.key);return!B.isNullOrUndefined(r)&&this.valueOperatorMatcher.matches(r,n.match)},t.prototype.isEventEvaluatorRequest=function(t){return void 0!==t.event},t}(),dA=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){var n;switch(e.type){case"EVENT_PROPERTY":return null===(n=this.properties(t))||void 0===n?void 0:n[e.name];case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t.prototype.properties=function(t){return dn.isTrack(t)?t.event.properties:dn.isExposure(t)||dn.isRemoteConfig(t)?t.properties:void 0},t}(),vA=function(){function t(t){var e=new KI(new iA,new ZI);this.userConditionMatcher=new oA(new sA,e),this.eventConditionMatcher=new hA(new dA,e),this.segmentConditionMatcher=new aA(new uA(this.userConditionMatcher)),this.experimentConditionMatcher=new cA(new pA(t,e),new lA(t,e))}return t.prototype.getMatcher=function(t){switch(t){case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":return this.userConditionMatcher;case"EVENT_PROPERTY":return this.eventConditionMatcher;case"SEGMENT":return this.segmentConditionMatcher;case"AB_TEST":case"FEATURE_FLAG":return this.experimentConditionMatcher}},t}(),yA=function(){function t(t){this.bucketer=t}return t.prototype.resolveOrNull=function(t,e,n){switch(n.type){case"VARIATION":return this.resolveVariation(t,n);case"BUCKET":return this.resolveBucket(t,n)}},t.prototype.resolveVariation=function(t,e){return t.experiment._getVariationByIdOrNull(e.variationId)},t.prototype.resolveBucket=function(t,e){var n=t.workspace.getBucketOrNull(e.bucketId),r=t.user.identifiers[t.experiment.identifierType];if(r){var i=this.bucketer.bucketing(n,r);if(i)return t.experiment._getVariationByIdOrNull(i.variationId)}},t}(),mA={murmurhash3_x86_32:function(t,e,n,r){void 0===r&&(r=t.length);for(var i,o=3432918353,s=461845907,a=-4&r,u=e,c=0;c<a;c+=4)i=255&t.charCodeAt(c)|(255&t.charCodeAt(c+1))<<8|(255&t.charCodeAt(c+2))<<16|(255&t.charCodeAt(c+3))<<24,i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,u=5*(u=(524287&(u^=i=this.mul32(i,s)))<<13|u>>>19)+3864292196|0;switch(i=0,r%4){case 3:i=(255&t.charCodeAt(a+2))<<16;case 2:i|=(255&t.charCodeAt(a+1))<<8;case 1:i|=255&t.charCodeAt(a),i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,u^=i=this.mul32(i,s)}return u^=r,u^=u>>>16,u=this.mul32(u,2246822507),u^=u>>>13,(u=this.mul32(u,3266489909))^u>>>16},mul32:function(t,e){var n=65535&e;return((e-n)*t|0)+(n*t|0)|0}},gA=function(){function t(){}return t.prototype.bucketing=function(t,e){var n=this.calculateSlotNumber(t.seed,t.slotSize,e);return t.slots.find((function(t){return t.contains(n)}))},t.prototype.calculateSlotNumber=function(t,e,n){var r=mA.murmurhash3_x86_32(n,t);return Math.abs(r)%Math.abs(e)},t}(),EA=function(){function t(t,e){this.flowEvaluator=t,this.nextFlow=e}return t.prototype.evaluate=function(t,e){return this.flowEvaluator&&this.nextFlow?this.flowEvaluator.evaluate(t,e,this.nextFlow):void 0},t.end=function(){return new t(void 0,void 0)},t.decision=function(e,n){return new t(e,n)},t.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this.end(),r=0,i=t.reverse();r<i.length;r++){var o=i[r];n=this.decision(o,n)}return n},t}(),wA=function(){function t(t){this.overrideResolver=t}return t.prototype.evaluate=function(t,e,n){var r=this.overrideResolver.resolveOrNull(t,e);if(!r)return n.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return MI.of(t,e,r,yt.OVERRIDDEN);case"FEATURE_FLAG":return MI.of(t,e,r,yt.INDIVIDUAL_TARGET_MATCH)}},t}(),TA=function(){function t(){}return t.prototype.evaluate=function(t,e,n){return"DRAFT"===t.experiment.status?MI.ofDefault(t,e,yt.EXPERIMENT_DRAFT):n.evaluate(t,e)},t}(),_A=function(){function t(){}return t.prototype.evaluate=function(t,e,n){if("PAUSED"!==t.experiment.status)return n.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return MI.ofDefault(t,e,yt.EXPERIMENT_PAUSED);case"FEATURE_FLAG":return MI.ofDefault(t,e,yt.FEATURE_FLAG_INACTIVE)}},t}(),IA=function(){function t(){}return t.prototype.evaluate=function(t,e,n){if("COMPLETED"===t.experiment.status){var r=t.experiment._winnerVariationOrNull();if(!r)throw new Error("winner variation [".concat(t.experiment.id,"]"));return MI.of(t,e,r,yt.EXPERIMENT_COMPLETED)}return n.evaluate(t,e)},t}(),AA=function(){function t(t){this.experimentTargetDeterminer=t}return t.prototype.evaluate=function(t,e,n){if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));return this.experimentTargetDeterminer.isUserInExperimentTarget(t,e)?n.evaluate(t,e):MI.ofDefault(t,e,yt.NOT_IN_EXPERIMENT_TARGET)},t}(),NA=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,n){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));var r=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);return r?r.isDropped?MI.ofDefault(t,e,yt.VARIATION_DROPPED):MI.of(t,e,r,yt.TRAFFIC_ALLOCATED):MI.ofDefault(t,e,yt.TRAFFIC_NOT_ALLOCATED)},t}(),OA=function(){function t(t,e){this.targetRuleDeterminer=t,this.actionResolver=e}return t.prototype.evaluate=function(t,e,n){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return n.evaluate(t,e);var r=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);if(!r)return n.evaluate(t,e);var i=this.actionResolver.resolveOrNull(t,e,r.action);if(!i)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return MI.of(t,e,i,yt.TARGET_RULE_MATCH)},t}(),RA=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,n){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return MI.ofDefault(t,e,yt.DEFAULT_RULE);var r=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);if(!r)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return MI.of(t,e,r,yt.DEFAULT_RULE)},t}(),bA=function(){function t(t){this.containerResolver=t}return t.prototype.evaluate=function(t,e,n){var r=t.experiment.containerId;if(!r)return n.evaluate(t,e);var i=t.workspace.getContainerOrNull(r);if(!i)throw new Error("container[".concat(r,"]"));return this.containerResolver.isUserInContainerGroup(t,e,i)?n.evaluate(t,e):MI.ofDefault(t,e,yt.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT)},t}(),SA=function(){function t(){}return t.prototype.evaluate=function(t,e,n){return t.user.identifiers[t.experiment.identifierType]?n.evaluate(t,e):MI.ofDefault(t,e,yt.IDENTIFIER_NOT_FOUND)},t}(),MA=function(){function t(t){this.targetMatcher=t}return t.prototype.isUserInExperimentTarget=function(t,e){var n=this;return 0===t.experiment.targetAudiences.length||t.experiment.targetAudiences.some((function(r){return n.targetMatcher.matches(t,e,r)}))},t}(),CA=function(){function t(t){this.targetMatcher=t}return t.prototype.determineTargetRuleOrNull=function(t,e){var n=this;return t.experiment.targetRules.find((function(r){return n.targetMatcher.matches(t,e,r.target)}))},t}(),xA=function(){function t(t,e,n){this.manualOverrideStorage=t,this.targetMatcher=e,this.actionResolver=n}return t.prototype.resolveOrNull=function(t,e){var n,r;return null!==(r=null!==(n=this.resolveManualOverride(t))&&void 0!==n?n:this._resolveUserOverride(t))&&void 0!==r?r:this._resolveSegmentOverride(t,e)},t.prototype.resolveManualOverride=function(t){return this.manualOverrideStorage.getVariation(t.experiment,t.user)},t.prototype._resolveUserOverride=function(t){var e=t.experiment,n=t.user.identifiers[e.identifierType];if(n){var r=e.userOverrides.get(n);if(r)return e._getVariationByIdOrNull(r)}},t.prototype._resolveSegmentOverride=function(t,e){var n=this,r=t.experiment.segmentOverrides.find((function(r){return n.targetMatcher.matches(t,e,r.target)}));if(r)return this.actionResolver.resolveOrNull(t,e,r.action)},t}(),PA=function(){function t(t){this.bucketer=t}return t.prototype.isUserInContainerGroup=function(t,e,n){var r=t.user.identifiers[t.experiment.identifierType];if(B.isNullOrUndefined(r))return!1;var i=t.workspace.getBucketOrNull(n.bucketId);if(B.isNullOrUndefined(i))throw new Error("Bucket[".concat(n.bucketId,"]"));var o=this.bucketer.bucketing(i,r);if(B.isNullOrUndefined(o))return!1;var s=n.getGroupOrNull(o.variationId);if(B.isNullOrUndefined(s))throw new Error("ContainerGroup[".concat(o.variationId,"]"));return s.experiments.includes(t.experiment.id)},t}(),kA=function(){function t(t,e,n,r){this.reason=t,this.targetEvaluations=e,this.inAppMessage=n,this.message=r}return t.of=function(e,n,r,i){return new t(r,n.targetEvaluations,e.inAppMessage,i)},t}(),UA=function(){function t(){}return t.prototype.evaluate=function(t,e,n){return t.inAppMessage.supports("WEB")?n.evaluate(t,e):kA.of(t,e,yt.UNSUPPORTED_PLATFORM)},t}(),DA=function(){function t(t,e){this.userOverrideMatcher=t,this.inAppMessageResolver=e}return t.prototype.evaluate=function(t,e,n){if(this.userOverrideMatcher.matches(t,e)){var r=this.inAppMessageResolver.resolve(t,e);return kA.of(t,e,yt.OVERRIDDEN,r)}return n.evaluate(t,e)},t}(),LA=function(){function t(){}return t.prototype.evaluate=function(t,e,n){return"DRAFT"===t.inAppMessage.status?kA.of(t,e,yt.IN_APP_MESSAGE_DRAFT):n.evaluate(t,e)},t}(),FA=function(){function t(){}return t.prototype.evaluate=function(t,e,n){return"PAUSE"===t.inAppMessage.status?kA.of(t,e,yt.IN_APP_MESSAGE_PAUSED):n.evaluate(t,e)},t}(),VA=function(){function t(){}return t.prototype.evaluate=function(t,e,n){return t.inAppMessage.period.within(t.timestamp)?n.evaluate(t,e):kA.of(t,e,yt.NOT_IN_IN_APP_MESSAGE_PERIOD)},t}(),GA=function(){function t(t){this.hiddenMatcher=t}return t.prototype.evaluate=function(t,e,n){return this.hiddenMatcher.matches(t,e)?kA.of(t,e,yt.IN_APP_MESSAGE_HIDDEN):n.evaluate(t,e)},t}(),jA=function(){function t(t,e){this.targetMatcher=t,this.inAppMessageResolver=e}return t.prototype.evaluate=function(t,e,n){if(this.targetMatcher.matches(t,e)){var r=this.inAppMessageResolver.resolve(t,e);return kA.of(t,e,yt.IN_APP_MESSAGE_TARGET,r)}return kA.of(t,e,yt.NOT_IN_IN_APP_MESSAGE_TARGET)},t}(),HA=function(){function t(){}return t.prototype.resolve=function(t,e){var n=t.inAppMessage,r=n.messageContext.defaultLang,i=n.messageContext.messages.find((function(t){return t.lang===r}));if(B.isNullOrUndefined(i))throw new Error("InAppMessage must be decided [".concat(n.id,"]"));return i},t}(),KA=function(){function t(){}return t.prototype.matches=function(t,e){var n=this;return t.inAppMessage.targetContext.overrides.some((function(e){return n.isUserOverridden(t,e)}))},t.prototype.isUserOverridden=function(t,e){var n=t.user.identifiers[e.identifierType];return!B.isNullOrUndefined(n)&&e.identifiers.includes(n)},t}(),BA=function(){function t(t){this.targetMatcher=t}return t.prototype.matches=function(t,e){var n=this,r=t.inAppMessage.targetContext.targets;return 0===r.length||r.some((function(r){return n.targetMatcher.matches(t,e,r)}))},t}(),zA=function(){function t(t){this.storage=t}return t.prototype.matches=function(t,e){return this.storage.exist(t.inAppMessage,t.timestamp)},t}(),JA=function(){function t(t,e){this.targetMatcher=t,this.bucketer=e}return t.prototype.determineTargetRuleOrNull=function(t,e){var n=this;return t.parameter.targetRules.find((function(r){return n.matches(t,e,r)}))},t.prototype.matches=function(t,e,n){if(!this.targetMatcher.matches(t,e,n.target))return!1;var r=t.user.identifiers[t.parameter.identifierType];if(B.isNullOrUndefined(r))return!1;var i=t.workspace.getBucketOrNull(n.bucketId);if(B.isNullOrUndefined(i))throw new Error("bucket[".concat(n.bucketId,"]"));return B.isNotNullOrUndefined(this.bucketer.bucketing(i,r))},t}(),qA=function(){function t(){}return t.get=function(t){return B.requiredNotNullOrUndefined(this.getOrNull(t),(function(){return"Instance not registered [".concat(t,"]")}))},t.getOrNull=function(e){return t.instances.get(e)},t.register=function(e,n){return t.instances.set(e,n),n},t.instances=new Map,t}(),YA=function(){function t(t,e,n){var r=new gA,i=qA.register("targetMatcher",new HI(new vA(t))),o=new yA(r),s=new xA(e,i,o),a=new PA(r);this.abTestFlow=EA.of(new wA(s),new SA,new bA(a),new AA(new MA(i)),new TA,new _A,new IA,new NA(o)),this.featureFlagFlow=EA.of(new TA,new _A,new IA,new wA(s),new SA,new OA(new CA(i),o),new RA(o));var u=new HA;this.inAppMessageFlow=EA.of(new UA,new DA(new KA,u),new LA,new FA,new VA,new GA(new zA(n)),new jA(new BA(i),u)),this.remoteConfigParameterTargetRuleDeterminer=new JA(i,r)}return t.prototype.getExperimentFlow=function(t){switch(t){case"AB_TEST":return this.abTestFlow;case"FEATURE_FLAG":return this.featureFlagFlow}},t.prototype.getInAppMessageFlow=function(){return this.inAppMessageFlow},t}(),XA=function(){function t(t){this.clock=t}return t.prototype.create=function(e,n){var r=this,i=this.clock.currentMillis(),o=new Array,s=this.createEvent(e,n,i,{});return o.push(s),n.targetEvaluations.forEach((function(n){var s,a=((s={})[t.ROOT_TYPE]=e.key.type,s[t.ROOT_ID]=e.key.id,s),u=r.createEvent(e,n,i,a);o.push(u)})),o},t.prototype.createEvent=function(e,n,r,i){var o;if(n instanceof MI)return i[t.CONFIG_ID_PROPERTY_KEY]=null===(o=n.config)||void 0===o?void 0:o.id,i[t.EXPERIMENT_VERSION_KEY]=n.experiment.version,i[t.EXECUTION_VERSION_KEY]=n.experiment.executionVersion,dn.exposure(e.user,n,i,r);if(n instanceof xI)return dn.remoteConfig(e.user,n,G(G({},i),n.properties),r);throw new Error("Unsupported Evaluation [".concat(typeof n,"]"))},t.ROOT_TYPE="$targetingRootType",t.ROOT_ID="$targetingRootId",t.CONFIG_ID_PROPERTY_KEY="$parameterConfigurationId",t.EXPERIMENT_VERSION_KEY="$experiment_version",t.EXECUTION_VERSION_KEY="$execution_version",t}(),WA=function(t){function e(e){var n=t.call(this)||this;return n.evaluationFlowFactory=e,n}return V(e,t),e.prototype.supports=function(t){return void 0!==t.inAppMessage},e.prototype.evaluateInternal=function(t,e){var n;return null!==(n=this.evaluationFlowFactory.getInAppMessageFlow().evaluate(t,e))&&void 0!==n?n:kA.of(t,e,yt.NOT_IN_IN_APP_MESSAGE_TARGET)},e}(SI),$A=function(){function t(t,e,n,r){this.key=new kI("IN_APP_MESSAGE",n.key),this.workspace=t,this.user=e,this.inAppMessage=n,this.timestamp=r}return t.of=function(e,n,r,i){return new t(e,n,r,i)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.inAppMessage.key,")")},t}(),ZA=q.log,QA=function(){function t(t,e,n,r,i,o,s,a){this.experimentEvaluator=t,this.remoteConfigEvaluator=e,this.inAppMessageEvaluator=n,this.workspaceFetcher=r,this.eventFactory=i,this.eventProcessor=o,this.errorDedupDeterminer=s,this.clock=a,this.workspaceFetcher.start(),this.eventProcessor.start(),this.readyPromise=this.workspaceFetcher.onReady().then((function(){return{success:!0}}),(function(t){return{success:!1,error:t}}))}return t.create=function(e,n,r,i){var o=new jI,s=new VI(r),a=new YA(o,s,i),u=new CI(a),c=new PI(a.remoteConfigParameterTargetRuleDeterminer),f=new WA(a);return o.add(u),o.add(c),new t(u,c,f,e,new XA(st.instance),n,new tN,st.instance)},t.prototype.experiment=function(t,e,n){var r=this;if(!t)return ZA.error("experimentKey must not be empty"),lt.of(n,yt.INVALID_INPUT);var i=this.workspaceFetcher.get();if(!i)return ZA.warn("SDK not ready."),lt.of(n,yt.SDK_NOT_READY);var o=i.getExperimentOrNull(t);if(!o)return ZA.warn("Experiment does not exist."),lt.of(n,yt.EXPERIMENT_NOT_FOUND);var s=DI.of(i,e,o,n),a=this.experimentInternal(s),u=a[0],c=a[1];return this.eventFactory.create(s,u).forEach((function(t){return r.eventProcessor.process(t)})),c},t.prototype.experiments=function(t){var e=this,n=new xe((function(t,e){return t.id===e.id})),r=this.workspaceFetcher.get();return r?(r.getExperiments().forEach((function(i){var o=DI.of(r,t,i,"A"),s=e.experimentInternal(o);s[0];var a=s[1];n.add(i,a)})),n):n},t.prototype.experimentInternal=function(t){var e,n=this.experimentEvaluator.evaluate(t,UI.create()),r=null!==(e=n.config)&&void 0!==e?e:new vt;return[n,lt.of(n.variationKey,n.reason,r)]},t.prototype.featureFlag=function(t,e){var n=this;if(!t)return ZA.error("featureKey must not be empty"),ht.off(yt.INVALID_INPUT);var r=this.workspaceFetcher.get();if(!r)return ZA.warn("SDK not ready."),ht.off(yt.SDK_NOT_READY);var i=r.getFeatureFlagOrNull(t);if(!i)return ZA.warn("FeatureFlag does not exist."),ht.off(yt.FEATURE_FLAG_NOT_FOUND);var o=DI.of(r,e,i,"A"),s=this.featureFlagInternal(o),a=s[0],u=s[1];return this.eventFactory.create(o,a).forEach((function(t){return n.eventProcessor.process(t)})),u},t.prototype.featureFlags=function(t){var e=this,n=new xe((function(t,e){return t.id===e.id})),r=this.workspaceFetcher.get();return r?(r.getFeatureFlags().forEach((function(i){var o=DI.of(r,t,i,"A"),s=e.featureFlagInternal(o);s[0];var a=s[1];n.add(i,a)})),n):n},t.prototype.featureFlagInternal=function(t){var e,n=this.experimentEvaluator.evaluate(t,UI.create()),r=null!==(e=n.config)&&void 0!==e?e:new vt;return[n,"A"===n.variationKey?ht.off(n.reason,r):ht.on(n.reason,r)]},t.prototype.inAppMessage=function(t,e){var n=this.workspaceFetcher.get();if(!n)return ZA.warn("SDK not ready."),pt.of(yt.SDK_NOT_READY);var r=n.getInAppMessageOrNull(t);if(!r)return ZA.warn("In app message does not exist."),pt.of(yt.IN_APP_MESSAGE_NOT_FOUND);var i=$A.of(n,e,r,this.clock.currentMillis()),o=this.inAppMessageEvaluator.evaluate(i,UI.create());return pt.of(o.reason,o.inAppMessage,o.message)},t.prototype.tryInAppMessage=function(t,e){var n,r=Ne.start();try{n=this.inAppMessage(t,e)}catch(e){ZA.error("Unexpected error while deciding in app message [".concat(t,"]: ").concat(e)),n=pt.of(yt.EXCEPTION)}return ze.inAppMessage(r,t,n),n},t.prototype.track=function(t,e,n){var r;if(void 0===n&&(n=(new Date).getTime()),t)if("object"==typeof t)if("object"!=typeof t||t.key&&"string"==typeof t.key){var i=(null===(r=this.workspaceFetcher.get())||void 0===r?void 0:r.getEventTypeOrNull(t.key))||new Tt(0,t.key);this.eventProcessor.process(dn.track(i,t,e,n))}else ZA.warn("Event key must be not null. or event key must be string type.");else ZA.warn("Event must be event type.");else ZA.warn("event must not be null.")},t.prototype.trackException=function(t,e){if(!this.errorDedupDeterminer.isDedupTarget(t)){var n=bI.toEvent(t);this.flush(),this.track(n,e),this.flush()}},t.prototype.flush=function(){this.eventProcessor.flush()},t.prototype.remoteConfig=function(t,e,n,r){var i=this,o=this.workspaceFetcher.get();if(B.isNullOrUndefined(o))return ZA.warn("SDK not ready."),ft.of(r,yt.SDK_NOT_READY);var s=o.getRemoteConfigParameterOrNull(t);if(B.isNullOrUndefined(s))return ZA.warn("Remote config parameter does not exist."),ft.of(r,yt.REMOTE_CONFIG_PARAMETER_NOT_FOUND);var a=LI.of(o,e,s,n,r),u=this.remoteConfigEvaluator.evaluate(a,UI.create());return this.eventFactory.create(a,u).forEach((function(t){return i.eventProcessor.process(t)})),ft.of(u.value,u.reason)},t.prototype.onReady=function(t,e){void 0===e&&(e=3e3),this.onInitialized({timeout:e}).then((function(){return t()}))},t.prototype.onInitialized=function(t){var e,n=t.timeout,r=void 0===n?3e3:n;ZA.debug("Start HackleClient initializing");var i=new Promise((function(t){e=t})),o=setTimeout((function(){e({success:!1})}),r);return this.readyPromise.then((function(){clearTimeout(o),e({success:!0})}),(function(t){clearTimeout(o),e({success:!1,error:t})})),Promise.race([this.readyPromise,i]).then((function(t){return t.success?ZA.debug("HackleClient onInitialized Success"):t.error instanceof Error?ZA.error("HackleClient onInitialized Failed. ".concat(t.error.message)):ZA.error("HackleClient onInitialized Failed. ".concat(t.error)),Promise.resolve({success:t.success})}))},t.prototype.close=function(){this.workspaceFetcher.close(),this.eventProcessor.close()},t}(),tN=function(){function t(){}return t.prototype.isDedupTarget=function(t){return!!this._isSameError(t,this.previous)||(this.previous=t,!1)},t.prototype._isSameError=function(t,e){return!B.isNullOrUndefined(e)&&t.name===e.name&&t.message===e.message&&t.stack===e.stack},t}(),eN=function(){function t(){this._installed=[],this._installations={onerror:rN,onunhandledrejection:iN}}return t.prototype.install=function(t,e){this._install("onerror",t,e),this._install("onunhandledrejection",t,e)},t.prototype._install=function(t,e,n){t in this._installed||((0,this._installations[t])(e,n),this._installed.push(t))},t}(),nN=null;function rN(t,e){nN=window.onerror,window.onerror=function(n,r,i,o,s){B.isNotNullOrUndefined(s)&&t.trackException(s,e.resolveCurrentUser()),nN&&nN.apply(this,arguments)}}function iN(t,e){TI=window.onunhandledrejection,window.onunhandledrejection=function(n){var r;try{"reason"in n?r=n.reason:"detail"in n&&"reason"in n.detail&&(r=n.detail.reason)}catch(t){}r instanceof Error&&t.trackException(r,e.resolveCurrentUser()),TI&&TI.apply(this,arguments)}}var oN=function(){function t(t,e,n){this.storage=t,this.storageKey=e,this.maxSize=n}return t.prototype.read=function(){var t=this;return new Promise((function(e){var n=t.storage.getItem(t.storageKey);n&&e(JSON.parse(n)),e([])}))},t.prototype.save=function(t){var e=this;return 0===t.length?this.clear():new Promise((function(n){var r=JSON.stringify(t.slice(-e.maxSize));e.storage.setItem(e.storageKey,r),n()}))},t.prototype.add=function(t){var e=this;return this.read().then((function(n){return e.save(n.concat(t).slice(-e.maxSize))}))},t.prototype.delete=function(t){var e=this;return this.read().then((function(n){var r=n.filter((function(e){return t.findIndex((function(t){return t.insertId===e.insertId}))<0}));return e.save(r)}))},t.prototype.clear=function(){var t=this;return new Promise((function(e){t.storage.removeItem(t.storageKey),e()}))},t}(),sN=function(t,e){return null!==t&&t.userId===e.userId&&t.deviceId===e.deviceId},aN=function(){function t(t,e,n,r){var i;void 0===n&&(n=null),void 0===r&&(r=null),this.storage=t,this.hackleDeviceId=e,this.userListeners=[],this.defaultUser={deviceId:this.hackleDeviceId},this._currentUser=null!==(i=null!=r?r:n)&&void 0!==i?i:this.defaultUser,this.storage.saveUser(this._currentUser)}return t.prototype.addListener=function(t){this.userListeners.push(t)},Object.defineProperty(t.prototype,"currentUser",{get:function(){return this._currentUser},enumerable:!1,configurable:!0}),t.prototype.resolveCurrentOrNull=function(t){if(void 0===t)return this.currentUser;if("string"==typeof t)return this.setUser({id:t});var e=At(t);return e?this.setUser(e):null},t.prototype.setUser=function(t){return this.updateUser(t)},t.prototype.setUserId=function(t){var e=G(G({},this._currentUser),{userId:t});return this.setUser(e)},t.prototype.setDeviceId=function(t){var e=G(G({},this._currentUser),{deviceId:t});return this.setUser(e)},t.prototype.updateUserProperties=function(t){return this.operateProperties(t)},t.prototype.resetUser=function(){return this.setUser(this.defaultUser)},t.prototype.changeUser=function(t,e,n){this.userListeners.forEach((function(r){r.onUserUpdated(t,e,n)}))},t.prototype.saveUser=function(t){this.storage.saveUser(t)},t.prototype.update=function(t){var e=this._currentUser,n=t(e);return this._currentUser=n,sN(e,n)||(this.changeUser(e,n,(new Date).getTime()),this.saveUser(n)),n},t.prototype.updateUser=function(t){return this.update((function(e){return sN(n=e,r=t)?G(G({},r),{properties:G(G({},n.properties),r.properties)}):r;var n,r}))},t.prototype.operateProperties=function(t){return this.update((function(e){var n,r=null!==(n=null==e?void 0:e.properties)&&void 0!==n?n:{},i=t.operate(new Map(Object.entries(r)));return G(G({},e),{properties:B.fromMap(i)})}))},t}(),uN=function(){function t(t){this.storage=t}return t.prototype.getUser=function(){var t=this.deviceId||void 0,e=this.userId||void 0;return void 0!==t||void 0!==e?{deviceId:t,userId:e}:null},t.prototype.saveUser=function(t){this.setDeviceId(t.deviceId||null),this.setUserId(t.userId||null)},Object.defineProperty(t.prototype,"deviceId",{get:function(){return this.storage.getItem("_hackle_did")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this.storage.getItem("_hackle_uid")},enumerable:!1,configurable:!0}),t.prototype.setDeviceId=function(t){this.setId("_hackle_did",t)},t.prototype.setUserId=function(t){this.setId("_hackle_uid",t)},t.prototype.setId=function(t,e){B.isNotNullOrUndefined(e)?this.storage.setItem(t,e):this.storage.removeItem(t)},t}(),cN=function(){function t(t,e){this.sessionTimeoutMillis=t,this.storage=e,this.sessionListeners=[],this._currentSessionId=null,this._lastEventTime=null,this.loadSession(),this.loadLastEventTime()}return Object.defineProperty(t.prototype,"currentSessionId",{get:function(){return this._currentSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){var e;return null!==(e=this._currentSessionId)&&void 0!==e?e:t.EMPTY_SESSION_ID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},enumerable:!1,configurable:!0}),t.prototype.addListener=function(t){this.sessionListeners.push(t)},t.prototype.startNewSession=function(t,e,n){return t&&this.endSession(t),this.newSession(e,n)},t.prototype.startNewSessionIfNeeded=function(t,e){var n=this._lastEventTime;return null===n?this.startNewSession(t,t,e):null!==this._currentSessionId&&e-n<this.sessionTimeoutMillis?(this.updateLastEventTime(e),this._currentSessionId):this.startNewSession(t,t,e)},t.prototype.updateLastEventTime=function(t){this._lastEventTime=t,this.storage.setItem("_hackle_last_event_ts","".concat(t))},t.prototype.endSession=function(t){var e=this._currentSessionId,n=this._lastEventTime;null!==e&&null!==n&&this.sessionListeners.forEach((function(r){return r.onSessionEnded(e,t,n)}))},t.prototype.newSession=function(t,e){var n=function(t){return"".concat(t,".").concat(L.v4().slice(0,8))}(e);return this.saveSession(n),this.updateLastEventTime(e),this.sessionListeners.forEach((function(r){r.onSessionStarted(n,t,e)})),n},t.prototype.saveSession=function(t){this._currentSessionId=t,this.storage.setItem("_hackle_session_id",t)},t.prototype.loadSession=function(){this._currentSessionId=this.storage.getItem("_hackle_session_id")},t.prototype.loadLastEventTime=function(){var t=this.storage.getItem("_hackle_last_event_ts");if(null!==t){var e=Number.parseFloat(t);e>0&&(this._lastEventTime=e)}},t.prototype.onUserUpdated=function(t,e,n){this.endSession(t),this.newSession(e,n)},t.EMPTY_SESSION_ID="0.ffffffff",t}(),fN=function(){function t(){this.storage=window.localStorage}return t.prototype.getItem=function(t){var e,n;return null!==(n=null===(e=this.storage)||void 0===e?void 0:e.getItem(t))&&void 0!==n?n:null},t.prototype.removeItem=function(t){var e;null===(e=this.storage)||void 0===e||e.removeItem(t)},t.prototype.setItem=function(t,e){var n;null===(n=this.storage)||void 0===n||n.setItem(t,e)},t.prototype.clear=function(){var t;null===(t=this.storage)||void 0===t||t.clear()},t}(),pN=function(){function t(t,e){this.delegate=t,this.transform=e}return t.postfix=function(e,n){return new t(e,(function(t){return"".concat(t).concat(n)}))},t.prefix=function(e,n){return new t(e,(function(t){return"".concat(n).concat(t)}))},t.prototype.getItem=function(t){return this.delegate.getItem(this.transform(t))},t.prototype.removeItem=function(t){this.delegate.removeItem(this.transform(t))},t.prototype.setItem=function(t,e){this.delegate.setItem(this.transform(t),e)},t}(),lN=function(){function t(t,e,n){void 0===n&&(n=4096);var r=this;this.delegate=t,this.listKey=e,this.encodedListCharLen=6,this.resolveMaxLength=function(t){var e=t-r.encodedListCharLen;return e<0?0:e},this.maxLength=this.resolveMaxLength(n)}return t.prototype.isEqualItem=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.prototype.getRemainListSize=function(){try{return this.maxLength-JSON.stringify(this.getList()).length}catch(t){return 0}},t.prototype.isAddableItem=function(t){try{return this.getRemainListSize()>JSON.stringify(t).length}catch(t){return!1}},t.prototype.getVictimIndex=function(t){var e=this.getRemainListSize();try{var n=JSON.stringify(t),r=this.getList(),i=0;return r.findIndex((function(t){return(i+=JSON.stringify(t).length)+e>=n.length}))}catch(t){return-1}},t.prototype.getList=function(){try{var t=this.delegate.getItem(this.listKey);if(!t)return[];var e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(t){return[]}},t.prototype.entries=function(){return this.getList().flatMap(Object.entries)},t.prototype.setItem=function(t,e){var n;try{this.removeItem(t);var r=this.getList(),i=((n={})[t]=e,n);if(!this.isAddableItem(i)){var o=this.getVictimIndex(i);if(o<0)return;r=r.slice(o+1)}var s=JSON.stringify(r.concat(i));this.delegate.setItem(this.listKey,s)}catch(t){}},t.prototype.getItem=function(t){var e=this,n=this.getList().find((function(n){return e.isEqualItem(n,t)}));if(n&&n[t])return n[t]},t.prototype.removeItem=function(t){var e=this,n=this.getList();try{var r=n.filter((function(n){return!e.isEqualItem(n,t)})),i=JSON.stringify(r);this.delegate.setItem(this.listKey,i)}catch(t){}},t.prototype.clear=function(){this.delegate.removeItem(this.listKey)},t}(),hN=function(){function t(t,e,n,r,i){this.core=t,this.userManager=e,this.userResolver=n,this.abOverrideStorage=r,this.ffOverrideStorage=i}return t.prototype.currentUser=function(){var t=this.userManager.currentUser;return this.userResolver.resolve(t)},t.prototype.getAbTestDecisions=function(){return this.core.experiments(this.currentUser()).entries()},t.prototype.getAbTestOverrides=function(){return this.abOverrideStorage.getAll()},t.prototype.setAbTestOverride=function(t,e){this.abOverrideStorage.set(t,e),this.increment("AB_TEST","set")},t.prototype.resetAbTestOverride=function(t){this.abOverrideStorage.remove(t),this.increment("AB_TEST","reset")},t.prototype.resetAllAbTestOverride=function(){this.abOverrideStorage.clear(),this.increment("AB_TEST","reset.all")},t.prototype.getFeatureFlagDecisions=function(){return this.core.featureFlags(this.currentUser()).entries()},t.prototype.getFeatureFlagOverrides=function(){return this.ffOverrideStorage.getAll()},t.prototype.setFeatureFlagOverride=function(t,e){this.ffOverrideStorage.set(t,e),this.increment("FEATURE_FLAG","set")},t.prototype.resetFeatureFlagOverride=function(t){this.ffOverrideStorage.remove(t),this.increment("FEATURE_FLAG","reset")},t.prototype.resetAllFeatureFlagOverride=function(){this.ffOverrideStorage.clear(),this.increment("FEATURE_FLAG","reset.all")},t.prototype.increment=function(t,e){Ke.counter("experiment.manual.override",{"experiment.type":t,operation:e}).increment()},t}(),dN=function(){function t(){}return t.serverFetch=function(t){return"".concat(t,"/api/v2/workspaces")},t.clientFetch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/w")},t.serverDispatch=function(t){return"".concat(t,"/api/v2/events")},t.clientDispatch=function(t){return"".concat(t,"/api/v2/w/events")},t.beaconDispatch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/events")},t.inAppMessageRenderer=function(t,e){return"".concat(t,"/sdk/iam-renderer/").concat(e,"/iam-renderer.js")},t}(),vN=function(){function t(t){this.storage=t}return t.prototype.exist=function(t,e){var n=this.key(t),r=this.storage.getItem(n);if(B.isNullOrUndefined(r))return!1;var i=Number.parseInt(r,10);return Number.isNaN(i)?(this.storage.removeItem(n),!1):e<=i||(this.storage.removeItem(n),!1)},t.prototype.put=function(t,e){this.storage.setItem(this.key(t),"".concat(e))},t.prototype.key=function(t){return"".concat(t.key)},t}(),yN=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find((function(e){return e.supports(t)}))},t}(),mN=function(){function t(){}return t.prototype.handle=function(t,e){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),gN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){q.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"WEB_LINK"===t.type},t}(),EN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){q.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_AND_CLOSE"===t.type},t}(),wN=function(){function t(t,e){this.storage=t,this.clock=e}return t.prototype.handle=function(e,n){var r=this.clock.currentMillis()+t.HIDE_EXPIRATION;this.storage.put(e.context.inAppMessage,r),e.close()},t.prototype.supports=function(t){return"HIDDEN"===t.type},t.HIDE_EXPIRATION=864e5,t}(),TN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){q.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_WINDOW"===t.type},t}(),_N=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){q.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_WINDOW_AND_CLOSE"===t.type},t}(),IN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){q.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_TAB"===t.type},t}(),AN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){q.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_TAB_AND_CLOSE"===t.type},t}(),NN=function(){function t(t){this.core=t}return t.prototype.track=function(t,e,n){var r=this.createTrackEvent(e,t);this.core.track(r,t.user,n)},t.prototype.createTrackEvent=function(t,e){var n,r,i,o;switch(t.type){case"IMPRESSION":return{key:"$in_app_impression",properties:G({in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key,title_text:null===(r=null===(n=e.message.text)||void 0===n?void 0:n.title)||void 0===r?void 0:r.text,body_text:null===(o=null===(i=e.message.text)||void 0===i?void 0:i.body)||void 0===o?void 0:o.text,button_text:e.message.buttons.map((function(t){return t.text})),image_url:e.message.images.map((function(t){return t.imagePath}))},e.properties)};case"CLOSE":return{key:"$in_app_close",properties:{in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key}};case"ACTION":var s=t;return{key:"$in_app_action",properties:{in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key,action_type:s.action.type,action_area:s.area,action_value:s.action.value,button_text:s.text}}}},t}(),ON=function(){function t(t,e,n){this.messageViewFactory=t,this.eventHandler=e,this.interactionHandlerFactory=n,this.currentMessageView=null,this.opening=!1}return t.prototype.present=function(t){return j(this,void 0,void 0,(function(){var e;return H(this,(function(n){switch(n.label){case 0:if(this.currentMessageView)return[2];if(this.opening)return[2];this.opening=!0,e=null,n.label=1;case 1:return n.trys.push([1,3,4,5]),e=this.messageViewFactory.create(t,this),this.currentMessageView=e,[4,e.open()];case 2:return n.sent(),[3,5];case 3:return n.sent(),null==e||e.close(),[3,5];case 4:return this.opening=!1,[7];case 5:return[2]}}))}))},t}(),RN=function(){function t(t,e,n){var r=this;this.userEventEmitter=t,this.determiner=e,this.presenter=n,this.onEvent=function(t){var e=r.determiner.determineOrNull(t);e&&r.presenter.present(e)},this.initialize()}return t.prototype.initialize=function(){this.userEventEmitter.on("event",this.onEvent)},t.prototype.destroy=function(){this.userEventEmitter.off("event",this.onEvent)},t}(),bN=function(t,e,n,r){this.inAppMessage=t,this.message=e,this.user=n,this.properties=r},SN=function(){function t(t,e,n){this.workspaceFetcher=t,this.eventMatcher=e,this.core=n}return t.prototype.determineOrNull=function(t){var e=this.workspaceFetcher.get();if(e)for(var n=0,r=e.getInAppMessages();n<r.length;n++){var i=r[n];if(this.eventMatcher.matches(e,i,t)){var o=this.context(i,t);if(!o)continue;return o}}},t.prototype.context=function(t,e){var n=this.core.tryInAppMessage(t.key,e.user);if(n.inAppMessage&&n.message)return new bN(n.inAppMessage,n.message,e.user,rt.sanitize({decision_reason:n.reason}))},t}(),MN=function(){function t(e,n,r){var i=this;this.scriptLoader=e,this.context=n,this.ui=r,this.container=null,this.renderer=null,this.handleInAppMessageInteraction=function(e){if(e instanceof CustomEvent&&e.type===t.HACKLE_IAM_INTERACTION_EVENT_TYPE){var n=e.detail;i.handleInteraction(n)}}}return t.prototype.open=function(){return j(this,void 0,void 0,(function(){var e,n;return H(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),window.addEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),[4,this.scriptLoader.load()];case 1:return r.sent(),(e=this.addContainer()).style.display="none",e.classList.add("".concat(t.CONTAINER_CLASS_NAME,"--loading")),n=window.HackleInAppMessageRenderer,this.renderer=new n.HackleInAppMessageRenderer(e),[4,this.renderer.render({messageId:this.context.inAppMessage.id,message:this.context.message.toJson()})];case 2:return r.sent(),e.classList.remove("".concat(t.CONTAINER_CLASS_NAME,"--loading")),e.style.display="block",this.handleEvent({type:"IMPRESSION"}),[3,4];case 3:return r.sent(),this.close(),[3,4];case 4:return[2]}}))}))},t.prototype.close=function(){var e;this.handleEvent({type:"CLOSE"}),window.removeEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),null===(e=this.renderer)||void 0===e||e.destroy(),this.renderer=null,this.removeContainer(),this.ui.currentMessageView=null},t.prototype.addContainer=function(){if(!this.container){var e=document.createElement("div");e.classList.add(t.CONTAINER_CLASS_NAME),this.container=e}return this.container.parentNode||document.body.appendChild(this.container),this.container},t.prototype.removeContainer=function(){var t;this.container&&(null===(t=this.container.parentNode)||void 0===t||t.removeChild(this.container),this.container=null)},t.prototype.handleInteraction=function(t){var e=this.ui.interactionHandlerFactory.get(t);e&&e.handle(this,t)},t.prototype.handleEvent=function(t){this.ui.eventHandler.handle(this,t)},t.HACKLE_IAM_INTERACTION_EVENT_TYPE="hackle-iam-interaction",t.CONTAINER_CLASS_NAME="hackle-iam",t}(),CN=function(){function t(t){this.scriptLoader=t}return t.prototype.create=function(t,e){return new MN(this.scriptLoader,t,e)},t}(),xN=function(){function t(t){this.scriptUrl=t}return t.prototype.load=function(){return j(this,void 0,void 0,(function(){var t;return H(this,(function(e){switch(e.label){case 0:return window.HackleInAppMessageRenderer?[2]:(t=this.createScript(),document.head.appendChild(t),[4,this.waitForLoad(t)]);case 1:return[2,e.sent()]}}))}))},t.prototype.createScript=function(){var t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.src=this.scriptUrl,t},t.prototype.waitForLoad=function(t){return new Promise((function(e,n){var r=function(){o(),e(t)},i=function(t){o(),n(t.message)},o=function(){t.removeEventListener("error",i),t.removeEventListener("load",r)};t.addEventListener("load",r),t.addEventListener("error",i)}))},t}(),PN=function(){function t(t){this.targetMatcher=t}return t.prototype.isTriggerTarget=function(t,e,n){var r=this;return e.eventTrigger.rules.some((function(i){return r.ruleMatches(t,n,e,i)}))},t.prototype.ruleMatches=function(t,e,n,r){if(e.event.key!==r.eventKey)return!1;var i=kN.of(t,e,n);return this.targetMatcher.anyMatches(i,UI.create(),r.targets)},t}(),kN=function(){function t(t,e,n,r){this.key=t,this.workspace=e,this.user=n,this.event=r}return t.of=function(e,n,r){return new t(new kI("IN_APP_MESSAGE",r.key),e,n.user,n)},t}(),UN=function(){function t(t){this.storage=t}return t.prototype.isTriggerTarget=function(t,e,n){if(!e.eventTrigger.frequencyCap)return!0;var r=this.createMatchContexts(e.eventTrigger.frequencyCap);if(0===r.length)return!0;for(var i=0,o=this.storage.get(e);i<o.length;i++)for(var s=o[i],a=0,u=r;a<u.length;a++)if(u[a].matches(n,s))return!1;return!0},t.prototype.createMatchContexts=function(t){for(var e=[],n=0,r=t.identifierCaps;n<r.length;n++){var i=r[n];e.push(new DN(new LN(i)))}return t.durationCap&&e.push(new DN(new FN(t.durationCap))),e},t}(),DN=function(){function t(t){this.matchCount=0,this.predicate=t}return t.prototype.matches=function(t,e){return this.predicate.matches(t,e)&&(this.matchCount+=1),this.matchCount>=this.predicate.thresholdCount},t}(),LN=function(){function t(t){this.identifierCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.identifierCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,e){var n=t.user.identifiers[this.identifierCap.identifierType];if(B.isNullOrUndefined(n))return!1;var r=e.identifiers[this.identifierCap.identifierType];return!B.isNullOrUndefined(r)&&n===r},t}(),FN=function(){function t(t){this.durationCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.durationCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,e){return t.timestamp-e.timestamp<=this.durationCap.durationMillis},t}(),VN=function(){function t(t){this.storage=t}return t.prototype.get=function(t){var e=this.storage.getItem(t.id.toString());return B.isNullOrUndefined(e)?[]:JSON.parse(e)},t.prototype.set=function(t,e){this.storage.setItem(t.id.toString(),JSON.stringify(e))},t}(),GN=function(){function t(t){this.processors=t}return t.prototype.get=function(t){return this.processors.find((function(e){return e.supports(t)}))},t}(),jN=function(){function t(t){this.impressionStorage=t}return t.prototype.process=function(t,e,n){this.saveImpression(t.context.inAppMessage,t.context.user,n)},t.prototype.saveImpression=function(e,n,r){var i=this.impressionStorage.get(e),o={identifiers:n.identifiers,timestamp:r};i.push(o),i.length>t.IMPRESSION_MAX_SIZE&&i.splice(0,i.length-t.IMPRESSION_MAX_SIZE),this.impressionStorage.set(e,i)},t.prototype.supports=function(t){return"IMPRESSION"===t.type},t.IMPRESSION_MAX_SIZE=100,t}(),HN=function(){function t(){}return t.prototype.process=function(t,e,n){},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),KN=function(){function t(t){this.actionHandlerFactory=t}return t.prototype.process=function(t,e,n){var r=this.actionHandlerFactory.get(e.action);r&&r.handle(t,e.action)},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),BN=function(){function t(t,e,n){this.clock=t,this.eventTracker=e,this.eventProcessorFactory=n}return t.prototype.handle=function(t,e){var n=this.clock.currentMillis();this.eventTracker.track(t.context,e,n);var r=this.eventProcessorFactory.get(e);r&&r.process(t,e,n)},t}(),zN=function(){function t(t,e){this.ruleDeterminer=t,this.frequencyCapDeterminer=e}return t.prototype.matches=function(t,e,n){return!!dn.isTrack(n)&&!!this.ruleDeterminer.isTriggerTarget(t,e,n)&&this.frequencyCapDeterminer.isTriggerTarget(t,e,n)},t}(),JN=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find((function(e){return e.supports(t)}))},t}(),qN=function(){function t(){}return t.prototype.handle=function(t,e){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),YN=function(){function t(t){this.eventHandler=t}return t.prototype.handle=function(t,e){var n=Ie.fromJson(e.action);if(n){var r={type:"ACTION",action:n,area:e.area,text:e.text};this.eventHandler.handle(t,r)}},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),XN=function(){function t(){}return t.prototype.open=function(t){window.location.href=t.href},t}(),WN=function(){function t(){}return t.prototype.open=function(t){window.open(t.href,"Hackle","resizable:true")},t}(),$N=function(){function t(){}return t.prototype.open=function(t){window.open(t.href)},t}(),ZN={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,gclid:void 0,fbclid:void 0},QN={current:void 0,referrer:void 0},tO=function(t,e){return Object.keys(ZN).every((function(n){return t[n]===e[n]}))},eO=function(){function t(t,e,n,r,i){this.storage=t,this.parser=e,this.core=n,this.userManager=r,this.userResolver=i}return t.prototype.startNewCampaign=function(t,e,n){for(var r=G(G({},ZN),e),i=new fn,o=0,s=Object.entries(r);o<s.length;o++){var a=s[o],u=a[0],c=a[1];c?i.set(u,c):i.unset(u)}var f=i.build(),p=f.toEvent(),l=this.userResolver.resolve(t);this.core.track(p,l,n),this.userManager.updateUserProperties(f)},t.prototype.startNewCampaignIfNeeded=function(t,e){var n=this.storage.get(),r=this.parser.parse();(function(t,e,n){return null===t||(!tO(e,ZN)||n.current!==n.referrer)&&!tO(t,e)})(n,r,this.parser.parseDomain())&&(this.storage.set(r),this.startNewCampaign(t,r,e))},t.prototype.onSessionEnded=function(t,e,n){},t.prototype.onSessionStarted=function(t,e,n){this.startNewCampaignIfNeeded(e,n)},t}(),nO=function(){function t(t){this.storage=t}return t.prototype.get=function(){var t=this.storage.getItem("_hackle_mkt");return t?JSON.parse(t):null},t.prototype.set=function(t){this.storage.setItem("_hackle_mkt",JSON.stringify(t))},t}(),rO=function(){function t(t){this.search=t}return t.prototype.getQueryParam=function(t){return this.getQueryParams((function(){return!0}))[t]||""},t.prototype.getQueryParams=function(t){for(var e={},n=0,r=this.search.substring(1).split("&");n<r.length;n++){var i=r[n].split("="),o=i[0],s=i[1];t&&!t(o,s)||(e[o]=decodeURIComponent(s))}return e},t.getQueryParams=function(){return"undefined"==typeof window?{}:new t(window.location.search).getQueryParams()},t}(),iO=function(){function t(){}return t.extractDomain=function(t){var e=this.DOMAIN_MATCH_REGEX,n=t.split("."),r=n[n.length-1];(r.length>4||"com"===r||"org"===r)&&(e=this.SIMPLE_DOMAIN_MATCH_REGEX);var i=t.match(e);return i?i[0]:t},t.DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,t.SIMPLE_DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i,t}(),oO=function(){function t(){}return t.prototype.parse=function(){var t=rO.getQueryParams();return{utm_campaign:t[sO],utm_content:t[aO],utm_id:t[uO],utm_medium:t[cO],utm_source:t[fO],utm_term:t[pO],gclid:t[lO],fbclid:t[hO]}},t.prototype.parseDomain=function(){return"undefined"==typeof window?QN:{current:iO.extractDomain(window.document.location.hostname),referrer:function(){var t=window.document.referrer;if(t){var e=new URL(t).hostname;return iO.extractDomain(e)}}()}},t}(),sO="utm_campaign",aO="utm_content",uO="utm_id",cO="utm_medium",fO="utm_source",pO="utm_term",lO="gclid",hO="fbclid",dO=q.log,vO=null,yO={user:void 0,debug:!1,log_disabled:!1,auto_track_page_view:!0,pollingIntervalMillis:-1,exposureEventDedupIntervalMillis:-1,sessionTimeoutMillis:18e5,autoOpenDevTool:!1,sdkUrl:"https://client-sdk.hackle.io",eventUrl:"https://event.hackle.io",monitoringUrl:"https://monitoring.hackle.io",cdnUrl:"https://static.hackle.io",sameSiteCookie:"LAX",secureCookie:!1,SDK_NAME_HEADER:"javascript-sdk_browser",SDK_VERSION_HEADER:"11.21.0",IAM_RENDERER_VERSION_HEADER:"0.0.3"};function mO(t,e){var n,r,i,o,s,a=G(G({},yO),e),u=new fN;if(q.initCounter((function(t){return Ke.counter("log",{level:t})})),a.log_disabled?q.setLogLevel(J.DISABLE):a.debug&&q.setLogLevel(J.DEBUG),dO.debug("sdkKey : "+t),t||dO.error("SDK Key must not be null"),vO)return dO.debug("use already exists hackleClient"),vO;var c=!1;"undefined"!=typeof window&&(c=window&&window.navigator&&window.navigator.sendBeacon&&!0)&&dO.debug("support sendBeacon API");var f=-1;void 0!==a.pollingIntervalMillis&&"number"==typeof a.pollingIntervalMillis&&a.pollingIntervalMillis>0&&(f=Math.max(a.pollingIntervalMillis,3e4));var p=new Tn(t,Q,{fetchUrl:dN.clientFetch(a.sdkUrl,t),updateInterval:f,headers:(n={},n[X]=a.SDK_NAME_HEADER,n["X-HACKLE-SDK-VERSION"]=a.SDK_VERSION_HEADER,n)}),l=xn.getInstance({days:3650,isCrossSubdomain:!0,sameSite:a.sameSiteCookie,isSecure:a.secureCookie}),h=new uN(pN.postfix(l,"_".concat(t))),d=h.getUser(),v=a.user||null,y=new aN(h,Un(),d,v),m=new cN(a.sessionTimeoutMillis,pN.postfix(l,"_".concat(t.slice(8))));y.addListener(m);var g=new oN(u,"".concat("hackle-repository-storage","_").concat(t),100),E=new En(t,Q,{dispatchUrl:dN.clientDispatch(a.eventUrl),beaconDispatchUrl:dN.beaconDispatch(a.eventUrl,t),useBeacon:c,headers:(r={},r[X]=a.SDK_NAME_HEADER,r["X-HACKLE-SDK-VERSION"]=a.SDK_VERSION_HEADER,r)}),w=-1;void 0!==a.exposureEventDedupIntervalMillis&&"number"==typeof a.exposureEventDedupIntervalMillis&&-1!==a.exposureEventDedupIntervalMillis&&(a.exposureEventDedupIntervalMillis<1e3||a.exposureEventDedupIntervalMillis>36e5?(dO.warn("Exposure event dedup interval is outside allowed range[1_000ms..3_600_000ms]. Setting to default value[no dedup]."),w=-1):w=a.exposureEventDedupIntervalMillis);var T=new RI(w),_=new OI(E,100,500,g,T,m,y),I=new GI(new lN(l,"".concat("hackle-manual-override_ab","_").concat(t.slice(0,8)))),A=new GI(new lN(l,"".concat("hackle-manual-override_ff","_").concat(t.slice(0,8)))),N=new vN(pN.prefix(u,"".concat("hackle-iam-hide","_").concat(t.slice(0,8),"_"))),O=new VN(pN.prefix(u,"".concat("hackle-iam-impression","_").concat(t.slice(0,8),"_"))),R=QA.create(p,_,[I,A],N),b=new Pn(y),S=new eO(new nO(pN.postfix(l,"_".concat(t.slice(0,8)))),new oO,R,y,b),M=new NI(b,R);m.addListener(S),m.addListener(M);var C=new NN(R),x=new yN([new mN,new gN(new XN),new EN(new XN),new wN(N,st.instance),new TN(new WN),new _N(new WN),new IN(new $N),new AN(new $N)]),P=new GN([new jN(O),new KN(x),new HN]),k=new BN(st.instance,C,P),U=new JN([new qN,new YN(k)]),D=new xN(dN.inAppMessageRenderer(a.cdnUrl,a.IAM_RENDERER_VERSION_HEADER)),L=new ON(new CN(D),k,U),F=new zN(new PN(qA.get("targetMatcher")),new UN(O)),V=new SN(p,F,R);new RN(_,V,L);var j=new hN(R,y,b,I,A),H=(null===(o=a.devTool)||void 0===o?void 0:o.userExplorer)&&"function"==typeof(null===(s=a.devTool)||void 0===s?void 0:s.userExplorer),K=a.devTool&&H?{manager:a.devTool,userExplorer:j}:void 0,B=new hn(R,b,m,y,K);vO=B,a.autoOpenDevTool&&(a.devTool?B.showUserExplorer():dO.error("DevTool is not provided"));var z,Y,W,$=function(){_.drainRepository()},Z=new Be(a.monitoringUrl,6e4,Q,((i={})[X]=a.SDK_NAME_HEADER,i["X-HACKLE-SDK-VERSION"]=a.SDK_VERSION_HEADER,i["X-HACKLE-SDK-KEY"]=t,i),c);return document.addEventListener("visibilitychange",(function(){document.hidden||$()})),window.addEventListener("pageshow",$),window.addEventListener("onpagehide"in window?"pagehide":"unload",(function(){Ln(),m.updateLastEventTime((new Date).getTime()),B.close(),Ke.globalRegistry.close()})),Ke.addRegistry(Z),z=Date.now(),Y=y.currentUser,W=m.currentSessionId,(sN(d,Y)?m.startNewSessionIfNeeded(Y,z):m.startNewSession(d,Y,z))===W&&S.startNewCampaignIfNeeded(Y,z),B.onReady((function(){(new eN).install(R,b),function(t,e){if(e.auto_track_page_view){t.trackPageView();try{history.pushState=(n=history.pushState,function(){try{var t=n.apply(this,arguments);return window.dispatchEvent(r("locationchange")),t}catch(t){if(t instanceof Error)dO.error(t);else try{dO.error(t)}catch(t){}}}),history.replaceState=function(t){return function(){try{var e=t.apply(this,arguments);return window.dispatchEvent(r("locationchange")),e}catch(t){if(t instanceof Error)dO.error(t);else try{dO.error(t)}catch(t){}}}}(history.replaceState),window.addEventListener("popstate",(function(){try{window.dispatchEvent(r("locationchange"))}catch(t){if(t instanceof Error)dO.error(t);else try{dO.error(t)}catch(t){}}})),window.addEventListener("locationchange",(function(){try{t.trackPageView()}catch(t){if(t instanceof Error)dO.error(t);else try{dO.error(t)}catch(t){}}}))}catch(t){if(t instanceof Error)dO.error(t);else try{dO.error(t)}catch(t){}}var n}function r(t){if("function"==typeof window.Event)return new Event(t);var e=!1,n=!1,r=void 0,i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e,n,r),i}}(B,a)})),B}var gO={createInstance:mO,getUserId:Un,setUserId:Dn,removeUserId:Ln,Logger:q};a.Bucket=Et,a.Container=xt,a.ContainerGroup=Pt,a.CoreVersion=Gt,a.Decision=lt,a.DecisionReason=yt,a.EmptyHackleRemoteConfig=dt,a.EmptyParameterConfig=vt,a.EventType=Tt,a.Experiment=mt,a.FeatureFlagDecision=ht,a.IAM_ACTION_AREA=["BUTTON","IMAGE","X_BUTTON"],a.IAM_ACTION_TYPE=ne,a.IAM_BEHAVIOR=ee,a.IAM_DISPLAY_TYPE=Zt,a.IAM_LAYOUT_TYPE=Qt,a.IAM_ORIENTATION=te,a.IAM_PLATFORM_TYPE=Wt,a.IAM_STATUS=Xt,a.IAM_TIMEUNIT=$t,a.IdentifierType=_t,a.IdentifiersBuilder=It,a.InAppMessage=re,a.InAppMessageAction=Ie,a.InAppMessageBackground=_e,a.InAppMessageButton=we,a.InAppMessageButtonStyle=Te,a.InAppMessageContext=he,a.InAppMessageContextLayout=ve,a.InAppMessageContextMessage=de,a.InAppMessageDecision=pt,a.InAppMessageDurationCap=fe,a.InAppMessageEventFrequencyCap=ue,a.InAppMessageEventTrigger=se,a.InAppMessageEventTriggerRule=ae,a.InAppMessageIdentifierCap=ce,a.InAppMessageImage=ye,a.InAppMessagePeriodAlways=ie,a.InAppMessagePeriodCustom=oe,a.InAppMessageTargetContext=pe,a.InAppMessageText=me,a.InAppMessageTextAttribute=ge,a.InAppMessageTextStyle=Ee,a.InAppMessageUserOverride=le,k=a.Logger=q,a.MATCH_OPERATORS=Bt,a.MATCH_TYPES=Ht,a.MATCH_VALUE_TYPES=Kt,a.MetaVersion=jt,a.ParameterConfiguration=kt,a.PropertyOperations=pn,a.PropertyOperationsBuilder=fn,a.RemoteConfigDecision=ft,a.RemoteConfigParameter=Ut,a.RemoteConfigParameterValue=Lt,a.RemoteConfigTargetRule=Dt,a.SEGMENT_TYPES=qt,a.Segment=Ct,a.Slot=wt,a.TARGET_ACTION_TYPES=zt,a.TARGET_KEY_TYPES=Jt,a.Target=Nt,a.TargetAction=St,a.TargetCondition=Ot,a.TargetKey=Rt,a.TargetMatch=bt,a.TargetRule=Mt,a.TargetingType=Yt,a.Variation=gt,a.Version=Vt,a.createInstance=mO,a.default=gO,a.getUserId=Un,a.removeUserId=Ln,a.sanitizeUser=At,a.setUserId=Dn;var EO,wO=function(t,e){var n=(e||document).querySelector(t);if(!n)throw Error("HackleDevtools Failed when getting element.");return n},TO="hackle-devtools",_O="hackle-devtools__toggler",IO="hackle-devtools__shadowWrapper",AO="hackle-devtools__iframeWrapper",NO="hackle-devtools__iframe",OO="hackle-devtools__style",RO={iframeWrapper:'\n  <template id="'.concat(AO,'-template">\n    <div id="').concat(AO,'">\n      <iframe id="').concat(NO,'"></iframe>\n    </div>\n  </template>\n'),shadowWrapper:'\n  <template id="'.concat(IO,'-template">\n    <div id="').concat(IO,'" style="position:fixed; z-index:10000001; left:24px; bottom: 61px; height: 0;"></div>\n  </template>\n'),toggler:'\n  <template id="'.concat(_O,'-template">\n    <button id="').concat(_O,'" type="button">\n    </button>\n  </template>\n\n'),stylesheet:'\n  <template id="'.concat(OO,'-template">\n    <style id="').concat(OO,'">\n      #').concat(_O," {\n        width: 45px;\n        height: 45px;\n        display: block;\n        background-image: url(").concat("https://cdn.hackle.io/images/20230330/84a95e8b-339b-412e-9200-f3655b5eb91b.png",");\n        background-size: contain;\n        background-color: white;\n\n        border: 2px solid white;\n        border-radius: 50%;\n        cursor: pointer;\n        box-shadow: 0px 0px 10px 3px #CACACA;\n      }\n      #").concat(_O,".hide {\n        display: none;\n      }\n      #").concat(_O," > img {\n        width: 100%;\n        height: 100%;\n      }\n      #").concat(NO," {\n        width: 100%;\n        height: 100%;\n        border: none;\n        border-radius: 8px;\n      }\n      #").concat(AO," {\n        width:420px;\n        height:80%;\n        min-height:580px;\n        max-height:620px;\n        border-radius:18px;\n        position:fixed;\n        left:24px;\n        bottom:18px;\n        animation: fade 0.5s;\n        background-color: #F5F5F5;\n        overflow: hidden;\n        box-shadow: rgba(255, 255, 255, 0.12) 0px 0px 2px 0px inset, rgba(0, 0, 0, 0.05) 0px 0px 2px 1px, rgba(0, 0, 0, 0.3) 0px 12px 60px;\n      }\n\n      @media screen and (max-width: 768px) {\n        #").concat(AO," {\n          width: 100vw;\n          min-height: unset;\n          max-height: unset;\n          left: 0;\n        }\n      }\n      @keyframes fade {\n        from {\n            opacity: 0;\n        }\n        to {\n            opacity: 1;\n        }\n      }\n    </style>\n  </template>\n")};t.MessageEventType=void 0,(EO=t.MessageEventType||(t.MessageEventType={})).INIT="HACKLE-EVENT_INIT",EO.CLOSE="HACKLE-EVENT_CLOSE",EO.USER="HACKLE-EVENT_USER",EO.DECISION_AB_GET="HACKLE-EVENT_GET_AB_DECISION",EO.DECISION_FF_GET="HACKLE-EVENT_GET_FF_DECISION",EO.OVERRIDE_AB_GET="HACKLE-EVENT_GET_AB_OVERRIDE",EO.OVERRIDE_AB_SET="HACKLE-EVENT_SET_AB_OVERRIDE",EO.OVERRIDE_AB_RESET="HACKLE-EVENT_RESET_AB_OVERRIDE",EO.OVERRIDE_AB_RESET_ALL="HACKLE-EVENT_RESET_ALL_AB_OVERRIDE",EO.OVERRIDE_FF_GET="HACKLE-EVENT_GET_FF_OVERRIDE",EO.OVERRIDE_FF_SET="HACKLE-EVENT_SET_FF_OVERRIDE",EO.OVERRIDE_FF_RESET="HACKLE-EVENT_RESET_FF_OVERRIDE",EO.OVERRIDE_FF_RESET_ALL="HACKLE-EVENT_RESET_ALL_FF_OVERRIDE";var bO=function(e){return"string"==typeof e.type&&Object.values(t.MessageEventType).includes(e.type)},SO=function(e){return bO(e)&&e.type===t.MessageEventType.CLOSE},MO=function(e){return bO(e)&&e.type===t.MessageEventType.INIT},CO=function(e){return bO(e)&&e.type===t.MessageEventType.USER},xO=function(e){return bO(e)&&e.type===t.MessageEventType.DECISION_AB_GET},PO=function(e){return bO(e)&&e.type===t.MessageEventType.DECISION_FF_GET},kO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_AB_GET},UO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_FF_GET},DO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_AB_SET},LO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_FF_SET},FO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_AB_RESET},VO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_FF_RESET},GO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_AB_RESET_ALL},jO=function(e){return bO(e)&&e.type===t.MessageEventType.OVERRIDE_FF_RESET_ALL},HO=function(){function t(t,e){this.port=t,this.opposite=e,this.port.start()}return t.prototype.receive=function(t,e){this.port.addEventListener("message",(function(n){t(n.data)&&e(n.data.payload)}))},t.prototype.post=function(t){this.port.postMessage(t)},t.prototype.close=function(){this.port.close(),this.opposite.close()},t}(),KO=k.log,BO=function(){function i(t){this.transceiver=t}return i.connectTo=function(o,s){return e(this,void 0,void 0,(function(){var e,a,u,c,f,p;return n(this,(function(n){switch(n.label){case 0:return u=new Promise((function(t){a=t,e=setTimeout((function(){t({port1:void 0,port2:void 0})}),5e3)})),window.addEventListener("message",(function(n){if(MO(n.data)&&o.contentWindow){var i=new MessageChannel,u=i.port1,c=i.port2;o.contentWindow.postMessage({type:t.MessageEventType.INIT},"".concat(r,"/").concat(s),[c]),clearTimeout(e),null==a||a({port1:u,port2:c})}})),[4,u];case 1:return c=n.sent(),f=c.port1,p=c.port2,f&&p?[2,new i(new HO(f,p))]:(KO.error("Timeout occurred while loading devtools."),[2])}}))}))},i.prototype.addMessageListener=function(t,e){this.transceiver.receive(t,e)},i.prototype.applyChannel=function(t){t(this.transceiver)},i.prototype.close=function(){this.transceiver.close()},i}(),zO=k.log,JO=function(){function t(t,e){this.devtoolSubPath=t,this.channel=e,this.channelManager=null,this.shadowRoot=void 0,this.initialize()}return t.prototype.getShadowWrapper=function(t){return wO("#".concat(IO),t)},t.prototype.getIFrameWrapper=function(t){return wO("#".concat(AO),t)},t.prototype.getToggler=function(t){return wO("#".concat(_O),t)},t.prototype.getIFrame=function(t){return wO("#".concat(NO),t)},t.prototype.getTemplate=function(t){return wO("#".concat(t,"-template"))},t.prototype.createMessageChannel=function(){return e(this,void 0,void 0,(function(){var t,e;return n(this,(function(n){switch(n.label){case 0:return(t=this.getIFrame(this.shadowRoot)).src="".concat(r,"/").concat(this.devtoolSubPath),[4,BO.connectTo(t,this.devtoolSubPath)];case 1:return(e=n.sent())?(this.channelManager=e,e.addMessageListener(SO,this.hide.bind(this)),e.applyChannel(this.channel),[2]):(this.hide(),[2])}}))}))},t.prototype.initialize=function(){"undefined"!=typeof window?document.getElementById(TO)||this.createRoot():zO.error("HackleDevtools called before window loaded.")},t.prototype.show=function(){var t,e=this.getTemplate(AO);null===(t=this.shadowRoot)||void 0===t||t.appendChild(e.content.cloneNode(!0)),this.createMessageChannel()},t.prototype.createRoot=function(){var t=this,e=document.createElement("div");e.id="hackle-devtools",Object.values(RO).forEach((function(t){return e.insertAdjacentHTML("beforeend",t)})),document.body.appendChild(e);var n=this.getTemplate(IO);e.appendChild(n.content);var r,i,o,s,a,u=this.getShadowWrapper();i=!1,o=0,s=0,a=function(t){if(i){r.classList.add("dragged");var e=o-t.clientX,n=s-t.clientY;o=t.clientX,s=t.clientY,r.style.left=r.offsetLeft-e+"px",r.style.top=r.offsetTop-n+"px"}},(r=u).onmousedown=function(t){i||(o=t.clientX,s=t.clientY,i=!0,window.addEventListener("mousemove",a))},r.onmouseup=function(){i=!1,window.removeEventListener("mousemove",a)};var c=u.attachShadow({mode:"open"});this.shadowRoot=c;var f=this.getTemplate(_O),p=this.getTemplate(OO);c.appendChild(p.content),c.appendChild(f.content);var l=this.getToggler(c);l.addEventListener("click",(function(){u.classList.contains("dragged")?u.classList.remove("dragged"):(t.show(),l.classList.add("hide"))}),!0)},t.prototype.hide=function(){this.getToggler(this.shadowRoot).classList.remove("hide"),this.getIFrameWrapper(this.shadowRoot).remove()},t.prototype.close=function(){var t;try{null===(t=this.channelManager)||void 0===t||t.close(),wO("#".concat(TO)).remove()}catch(t){zO.error("Failed to close HackleDevtools.")}},t}(),qO=function(){function e(){}return e.userExplorer=function(n){try{e.devtoolInstance=new JO("/user-explorer",function(e){return function(n){n.receive(CO,(function(){var r={type:t.MessageEventType.USER,payload:e.currentUser()};n.post(r)})),n.receive(xO,(function(){var r={type:t.MessageEventType.DECISION_AB_GET,payload:e.getAbTestDecisions()};n.post(r)})),n.receive(kO,(function(){var r={type:t.MessageEventType.OVERRIDE_AB_GET,payload:e.getAbTestOverrides()};n.post(r)})),n.receive(DO,(function(t){t&&e.setAbTestOverride(t.experiment,t.variationId)})),n.receive(FO,(function(t){t&&e.resetAbTestOverride(t.experiment)})),n.receive(GO,(function(){e.resetAllAbTestOverride()})),n.receive(PO,(function(){var r={type:t.MessageEventType.DECISION_FF_GET,payload:e.getFeatureFlagDecisions()};n.post(r)})),n.receive(UO,(function(){var r={type:t.MessageEventType.OVERRIDE_FF_GET,payload:e.getFeatureFlagOverrides()};n.post(r)})),n.receive(LO,(function(t){t&&e.setFeatureFlagOverride(t.experiment,t.variationId)})),n.receive(VO,(function(t){t&&e.resetFeatureFlagOverride(t.experiment)})),n.receive(jO,(function(){e.resetAllFeatureFlagOverride()}))}}(n))}catch(t){zO.error("Failed to initialize HackleDevTools.")}},e.close=function(){e.devtoolInstance?e.devtoolInstance.close():zO.error("There is no active HackleDevtools.")},e.devtoolInstance=null,e}();t.default=qO,t.isCloseMessage=SO,t.isDevtoolsMessage=bO,t.isGetABDecisionMessage=xO,t.isGetABOverrideMessage=kO,t.isGetFFDecisionMessage=PO,t.isGetFFOverrideMessage=UO,t.isInitMessage=MO,t.isResetABOverrideMessage=FO,t.isResetAllABOverrideMessage=GO,t.isResetAllFFOverrideMessage=jO,t.isResetFFOverrideMessage=VO,t.isSetABOverrideMessage=DO,t.isSetFFOverrideMessage=LO,t.isUserMessage=CO,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.browser.umd.min.js.map
